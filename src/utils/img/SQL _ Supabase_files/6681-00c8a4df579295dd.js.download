"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6681],{47342:function(e,n,t){t.d(n,{z:function(){return j}});var a=t(52322),i=t(78232),r=t(45010),s=t(44446),o=t(3536),l=t(39097),c=t.n(l),d=t(5632),u=t(2784),m=t(56958),h=t(84247),p=t(44778),x=t(40119),f=t(26198),g=t(34503),v=t(32079),b=t(74138);let j=(0,u.forwardRef)((e,n)=>{let{disabled:t,onDeleteConnection:l,...j}=e,y=(0,d.useRouter)(),{type:_,connection:N}=j,{data:S}=(0,f.Sy)(),w=null==S?void 0:S.find(e=>e.ref===N.supabase_project_ref),C=(null==w?void 0:w.is_branch_enabled)===!0,[P,k]=(0,u.useState)(!1),[E,A]=(0,u.useState)(!1),[R,I]=(0,u.useState)(!1),L=(0,u.useCallback)(async()=>{try{A(!0),await l(N)}catch(e){}finally{A(!1),k(!1)}},[N,l]),V=(0,u.useCallback)(()=>{k(!1)},[]),{mutate:z,isLoading:O}=(0,x.h)({onSuccess:()=>{m.Am.success("Successfully synced environment variables"),I(!1)}}),T=(0,u.useCallback)(async()=>{z({connectionId:N.id})},[N,z]),U="/project/[ref]/settings/integrations";return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.jA,{showNode:!1,actions:t?(0,a.jsx)(p.u,{disabled:!0,iconRight:(0,a.jsx)(i.Z,{size:14}),type:"default",tooltip:{content:{side:"bottom",text:"You need additional permissions to manage this connection"}},children:"Manage"}):(0,a.jsxs)(g.h_,{open:R,onOpenChange:()=>I(!R),modal:!1,children:[(0,a.jsx)(g.$F,{asChild:!0,children:(0,a.jsx)(v.z,{iconRight:(0,a.jsx)(i.Z,{size:14}),type:"default",children:(0,a.jsx)("span",{children:"Manage"})})}),(0,a.jsxs)(g.AW,{side:"bottom",align:"end",children:[y.pathname!==U&&(0,a.jsx)(g.Xi,{asChild:!0,children:(0,a.jsx)(c(),{href:U.replace("[ref]",N.supabase_project_ref),children:"Configure connection"})}),"Vercel"===_&&(0,a.jsxs)(g.Xi,{className:"space-x-2",onSelect:e=>{e.preventDefault(),T()},disabled:O,children:[O?(0,a.jsx)(r.Z,{className:"animate-spin",size:14}):(0,a.jsx)(s.Z,{size:14}),(0,a.jsx)("p",{children:"Resync environment variables"})]}),("Vercel"===_||y.pathname!==U)&&(0,a.jsx)(g.VD,{}),(0,a.jsxs)(g.Xi,{className:"space-x-2",onSelect:()=>k(!0),children:[(0,a.jsx)(o.Z,{size:14}),(0,a.jsx)("p",{children:"Delete connection"})]})]})]}),...j}),(0,a.jsx)(b.Z,{variant:"destructive",size:"GitHub"===_&&C?"medium":"small",visible:P,title:"Confirm to delete ".concat(_," connection"),confirmLabel:"Delete connection",onCancel:V,onConfirm:L,loading:E,alert:"GitHub"===_&&C?{title:"Branching will be disabled for this project",description:" Deleting this GitHub connection will remove all preview branches on this project,\n                and also disable branching for ".concat(w.name)}:void 0,children:(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:["This action cannot be undone. Are you sure you want to delete this ",_," connection?"]})})]})});j.displayName="IntegrationConnectionItem"},96384:function(e,n,t){t.d(n,{g:function(){return a}});let a=Object.values({POSTGRES_URL:{key:"POSTGRES_URL",type:"encrypted"},POSTGRES_PRISMA_URL:{key:"POSTGRES_PRISMA_URL",type:"encrypted"},POSTGRES_URL_NON_POOLING:{key:"POSTGRES_URL_NON_POOLING",type:"encrypted"},POSTGRES_USER:{key:"POSTGRES_USER",type:"encrypted"},POSTGRES_HOST:{key:"POSTGRES_HOST",type:"encrypted"},POSTGRES_PASSWORD:{key:"POSTGRES_PASSWORD",type:"encrypted"},POSTGRES_DATABASE:{key:"POSTGRES_DATABASE",type:"encrypted"},SUPABASE_ANON_KEY:{key:"SUPABASE_ANON_KEY",type:"encrypted"},SUPABASE_URL:{key:"SUPABASE_URL",type:"encrypted"},SUPABASE_SERVICE_ROLE_KEY:{key:"SUPABASE_SERVICE_ROLE_KEY",type:"encrypted"},SUPABASE_JWT_SECRET:{key:"SUPABASE_JWT_SECRET",type:"encrypted"},NEXT_PUBLIC_SUPABASE_ANON_KEY:{key:"NEXT_PUBLIC_SUPABASE_ANON_KEY",type:"encrypted"},NEXT_PUBLIC_SUPABASE_URL:{key:"NEXT_PUBLIC_SUPABASE_URL",type:"encrypted"}}).map(e=>e.key)},78855:function(e,n,t){var a=t(52322),i=t(87622),r=t.n(i),s=t(2784),o=t(56958),l=t(99959),c=t(96384),d=t(95623),u=t(80435),m=t(9673),h=t(9915),p=t(15111),x=t(12459),f=t(26198),g=t(89823),v=t(99248),b=t(45077),j=t(26205),y=t(49251);let _=(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"white",viewBox:"0 0 512 512",className:"w-6",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M256,48,496,464H16Z"})});n.Z=()=>{let{ref:e}=(0,l.UO)(),n=(0,g.l)(),t=(0,j.x5)(),i=t.vercelConnectionsIntegrationId,{data:N}=(0,h.T)({orgSlug:null==n?void 0:n.slug}),S=null==N?void 0:N.filter(e=>"Vercel"===e.integration.name),w=null==S?void 0:S.find(e=>e.id===i),{data:C}=(0,f.Sy)({enabled:void 0!==i}),P=(0,s.useMemo)(()=>{var e;return null!==(e=null==C?void 0:C.filter(e=>e.organization_id===(null==n?void 0:n.id)).map(e=>({name:e.name,ref:e.ref})))&&void 0!==e?e:b.Z6},[null==n?void 0:n.id,C]),{data:k}=(0,x.t)({organization_integration_id:i},{enabled:void 0!==i}),E=(0,s.useMemo)(()=>null!=k?k:b.Z6,[k]),A=(0,s.useMemo)(()=>r()(E,"id"),[E]),R=(0,s.useCallback)(e=>{let n=A[e.id];return(null==n?void 0:n.framework)?(0,a.jsx)("img",{src:"".concat(v.GW,"/img/icons/frameworks/").concat(n.framework,".svg"),width:21,height:21,alt:"icon"}):m.B},[A]),{mutate:I,isLoading:L}=(0,p.K)({async onSuccess(e){let{env_sync_error:n}=e;n&&o.Am.error("Failed to sync environment variables: ".concat(n.message,". Please try re-syncing manually from settings.")),t.setVercelConnectionsOpen(!1)}}),V=(0,s.useCallback)(e=>{I({...e,connection:{...e.connection,metadata:{...e.connection.metadata,supabaseConfig:{projectEnvVars:{write:!0}}}}})},[I]);return(0,a.jsx)(y.ZP,{hideFooter:!0,size:"large",header:"Add new Vercel project connection",visible:t.vercelConnectionsOpen,onCancel:()=>t.setVercelConnectionsOpen(!1),children:(0,a.jsxs)("div",{className:"py-6 flex flex-col gap-6 bg-studio h-full",children:[(0,a.jsx)(y.ZP.Content,{children:(0,a.jsx)(u.U,{content:"\n### Choose repository to connect to\n\nCheck the details below before proceeding\n          "})}),(0,a.jsxs)(y.ZP.Content,{className:"flex flex-col gap-2",children:[(0,a.jsx)(d.Z,{defaultSupabaseProjectRef:e,organizationIntegrationId:null==w?void 0:w.id,foreignProjects:E,supabaseProjects:P,onCreateConnections:V,installedConnections:null==w?void 0:w.connections,isLoading:L,integrationIcon:_,getForeignProjectIcon:R,choosePrompt:"Choose Vercel Project",mode:"Vercel"}),(0,a.jsx)(u.U,{content:"\nThe following environment variables will be added:\n\n".concat(c.g.map(e=>"\n - `".concat(e,"`")),"\n")})]}),(0,a.jsx)(y.ZP.Content,{children:(0,a.jsx)("ul",{children:(0,a.jsx)("li",{className:"border px-10"})})})]})})}},37354:function(e,n,t){t.d(n,{B:function(){return ea},Z:function(){return ei}});var a=t(52322),i=t(39097),r=t.n(i),s=t(36660),o=t(78855),l=t(74178),c=t(26211),d=t(99248),u=t(95492),m=t(37970),h=t(59491),p=t(2784),x=t(56958),f=t(99959),g=t(47342),v=t(84247),b=t(80435),j=t(14782),y=t(16014),_=t(61660),N=t(87175),S=t(89823),w=t(75939),C=t(26205),P=t(88883),k=t(72583),E=t(78232),A=t(94175),R=t(76141),I=t(9105),L=t(63955),V=t(30195),z=t(34928),O=t(35281),T=t(36492),U=t(31696),D=t(90301);async function Z(e,n){let{connectionId:t}=e;if(!t)throw Error("connectionId is required");let{data:a,error:i}=await (0,U.U2)("/platform/integrations/github/branches/{connectionId}",{params:{path:{connectionId:t}},signal:n});return i&&(0,U.S3)(i),a}let B=function(e){let{connectionId:n}=e,{enabled:t=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,T.a)(D.F.githubBranchesList(n),e=>{let{signal:t}=e;return Z({connectionId:n},t)},{enabled:t&&void 0!==n,...a})};var F=t(85945),G=t(48228);async function X(e,n){let{connectionId:t,workdir:a,supabaseChangesOnly:i,branchLimit:r}=e,{data:s,error:o}=await (0,U.r$)("/platform/integrations/github/connections/{connection_id}",{params:{path:{connection_id:String(t)}},signal:n,body:{workdir:a,supabase_changes_only:i,branch_limit:r}});return o&&(0,U.S3)(o),s}let W=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,F.NL)();return(0,G.D)(e=>X(e),{async onSuccess(n,t,i){await Promise.all([a.invalidateQueries(D.F.githubConnectionsList(t.organizationId))]),await (null==e?void 0:e(n,t,i))},async onError(e,t,a){void 0===n?x.Am.error("Failed to update Github connection: ".concat(e.message)):n(e,t,a)},...t})};var H=t(6112),K=t(61786),Y=t(32079),M=t(54383),q=t(90504),J=t(22574),Q=t(42070),$=t(93705),ee=e=>{var n,t,i,r,s,o,l,d,f,g,v,b,j,y,_,w;let{disabled:C,connection:T}=e,U=(0,S.l)(),D=(0,c.V)(),[Z,F]=(0,p.useState)(!1),G=(0,p.useRef)(null),X=(null==D?void 0:D.is_branch_enabled)===!0||(null==D?void 0:D.parent_project_ref)!==void 0,ee=(0,N.Xo)(h.KA.UPDATE,"integrations.github_connections"),{data:en,isLoading:et}=B({connectionId:Number(T.id)},{enabled:X}),{mutate:ea,isLoading:ei}=W({onSuccess:()=>x.Am.success("Successfully updated connection settings")}),{mutate:er,isLoading:es}=(0,z.e)({onSuccess:e=>{x.Am.success("Successfully updated production branch to ".concat(e.git_branch)),F(!1)}}),{data:eo}=(0,O.V)({projectRef:null==D?void 0:D.parentRef},{enabled:void 0!==D}),el=null==eo?void 0:eo.find(e=>e.is_default),ec=V.Ry({supabaseDirectory:V.Z_().default(null!==(y=null===(t=T.metadata)||void 0===t?void 0:null===(n=t.supabaseConfig)||void 0===n?void 0:n.supabaseDirectory)&&void 0!==y?y:""),supabaseChangesOnly:V.O7().default(null!==(_=null===(r=T.metadata)||void 0===r?void 0:null===(i=r.supabaseConfig)||void 0===i?void 0:i.supabaseChangesOnly)&&void 0!==_&&_),branchLimit:V.Z_().default(String(null!==(w=null===(o=T.metadata)||void 0===o?void 0:null===(s=o.supabaseConfig)||void 0===s?void 0:s.branchLimit)&&void 0!==w?w:50))}),ed=(0,L.cI)({resolver:(0,P.F)(ec),defaultValues:{supabaseDirectory:null==T?void 0:null===(d=T.metadata)||void 0===d?void 0:null===(l=d.supabaseConfig)||void 0===l?void 0:l.supabaseDirectory,supabaseChangesOnly:null==T?void 0:null===(g=T.metadata)||void 0===g?void 0:null===(f=g.supabaseConfig)||void 0===f?void 0:f.supabaseChangesOnly,branchLimit:String(null==T?void 0:null===(b=T.metadata)||void 0===b?void 0:null===(v=b.supabaseConfig)||void 0===v?void 0:v.branchLimit)}});function eu(e){if((null==U?void 0:U.id)===void 0)return console.error("Org ID is required");ea({connectionId:T.id,organizationId:null==U?void 0:U.id,workdir:e.supabaseDirectory,supabaseChangesOnly:e.supabaseChangesOnly,branchLimit:Number(e.branchLimit)})}return(0,a.jsxs)("div",{className:"flex flex-col gap-6 px-6 py-4",children:[X?(0,a.jsxs)("div",{children:[(0,a.jsx)(H._,{className:"text-foreground",children:"Production branch"}),(0,a.jsx)("p",{className:"text-xs text-foreground-light mb-3",children:"All other branches will be treated as Preview branches"}),(0,a.jsxs)(u.bZ,{children:[(0,a.jsx)(u.Cd,{className:"text-sm",children:"Changing Git branch for Production Branch coming soon"}),(0,a.jsx)(u.X,{className:"text-xs",children:"If you wish to change the Git branch that is used for the Production Branch you will need to disable Branching and opt back in."})]}),(0,a.jsxs)(K.J2,{open:Z,onOpenChange:F,modal:!1,children:[(0,a.jsx)(K.xo,{asChild:!0,name:"branch-selector",children:(0,a.jsx)(Y.z,{disabled:!0,type:"default",size:"medium",ref:G,className:(0,M.cn)("justify-start w-80 mt-4",(null==el?void 0:el.git_branch)===void 0?"text-foreground-light":"text"),icon:(null==el?void 0:el.git_branch)&&(0,a.jsx)(k.Z,{className:"w-4 h-4 text-warning",strokeWidth:1}),loading:es||et,iconRight:(0,a.jsx)("span",{className:"grow flex justify-end",children:(0,a.jsx)(E.Z,{size:14})}),children:(null==el?void 0:el.git_branch)||"Select a branch"})}),(0,a.jsx)(K.yk,{className:"p-0",side:"bottom",align:"start",style:{width:null===(j=G.current)||void 0===j?void 0:j.offsetWidth},children:(0,a.jsxs)(q.mY,{children:[(0,a.jsx)(q.sZ,{placeholder:"Find branch..."}),(0,a.jsxs)(q.e8,{children:[(0,a.jsx)(q.rb,{children:"No branches found"}),(0,a.jsx)(q.fu,{children:null==en?void 0:en.map(e=>{let n=e.name===(null==el?void 0:el.git_branch);return(0,a.jsxs)(q.di,{value:e.name.replaceAll('"',""),className:"cursor-pointer w-full flex items-center justify-between",onSelect:()=>{var n;F(!1),n=e.name,(null==D?void 0:D.parentRef)&&el&&er({id:el.id,projectRef:D.parentRef,branchName:n,gitBranch:n})},children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[n?(0,a.jsx)(k.Z,{className:"w-4 h-4 text-warning",strokeWidth:1}):(0,a.jsx)(A.Z,{className:"w-4 h-4",strokeWidth:1}),e.name]}),e.name===(null==el?void 0:el.git_branch)&&(0,a.jsx)(R.Z,{})]},e.name)})})]})]})})]})]}):(0,a.jsxs)(u.bZ,{className:"w-full mb-0",variant:"warning",children:[(0,a.jsx)(m.aN,{}),(0,a.jsxs)("div",{children:[(0,a.jsx)(u.Cd,{className:"text-sm",children:"Branching is not enabled"}),(0,a.jsxs)(u.X,{className:"text-xs",children:["This integration has no effect without Branching feature being active.",(0,a.jsx)("br",{}),'Make sure to enable it using "Enable branching" button at the top of the page first.']})]})]}),(0,a.jsx)(J.l0,{...ed,children:(0,a.jsxs)("form",{onSubmit:ed.handleSubmit(eu),className:"flex flex-col gap-6",children:[(0,a.jsx)(J.Wi,{control:ed.control,name:"branchLimit",render:e=>{var n,t,i,r,s,o;let{field:l}=e;return(0,a.jsxs)(J.xJ,{className:"flex flex-col",children:[(0,a.jsx)(J.lX,{className:"!text",children:"Branch limit"}),(0,a.jsx)(J.pf,{className:"text-xs text-foreground-lighter !mt-0 !mb-1",children:"Total number of branches that can be automatically created for this connection."}),(0,a.jsx)(J.NI,{className:"flex gap-3 items-center",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(Q.I,{...l,className:"w-80",disabled:!ee,onKeyPress:e=>{"Escape"===e.key&&ed.reset()},type:"number"}),(0,a.jsx)(I.Z,{className:(0,M.cn)("text-foreground-lighter transition hover:text cursor-pointer","w-4 h-4 absolute right-3 top-3","duration-150",l.value!==String(null===(t=T.metadata)||void 0===t?void 0:null===(n=t.supabaseConfig)||void 0===n?void 0:n.branchLimit)?"opacity-100 transition":"opacity-0"),onClick:()=>ed.reset()}),(0,a.jsx)(Y.z,{loading:ei,className:(0,M.cn)("duration-150 transition",l.value!==String(null===(r=T.metadata)||void 0===r?void 0:null===(i=r.supabaseConfig)||void 0===i?void 0:i.branchLimit)?"opacity-100":"opacity-0"),htmlType:"submit",disabled:l.value===String(null===(o=T.metadata)||void 0===o?void 0:null===(s=o.supabaseConfig)||void 0===s?void 0:s.branchLimit),children:"Update"})]})})]})}}),(0,a.jsx)(J.Wi,{control:ed.control,name:"supabaseDirectory",render:e=>{var n,t,i,r,s,o;let{field:l}=e;return(0,a.jsxs)(J.xJ,{className:"flex flex-col",children:[(0,a.jsx)(J.lX,{className:"!text",children:"Supabase directory"}),(0,a.jsxs)(J.pf,{className:"text-xs text-foreground-lighter !mt-0 !mb-1",children:["Path in your repository where ",(0,a.jsx)("code",{children:"supabase"})," directory for this connection lives."]}),(0,a.jsx)(J.NI,{className:"flex gap-3 items-center",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(Q.I,{...l,disabled:!ee,className:"w-80",onKeyPress:e=>{"Escape"===e.key&&ed.reset()}}),(0,a.jsx)(I.Z,{className:(0,M.cn)("text-foreground-lighter transition hover:text cursor-pointer","w-4 h-4 absolute right-3 top-3","duration-150",l.value!==(null===(t=T.metadata)||void 0===t?void 0:null===(n=t.supabaseConfig)||void 0===n?void 0:n.supabaseDirectory)?"opacity-100 transition":"opacity-0"),onClick:()=>ed.reset()}),(0,a.jsx)(Y.z,{loading:ei,className:(0,M.cn)("duration-150 transition",l.value!==(null===(r=T.metadata)||void 0===r?void 0:null===(i=r.supabaseConfig)||void 0===i?void 0:i.supabaseDirectory)?"opacity-100":"opacity-0"),htmlType:"submit",disabled:""===l.value||l.value===(null===(o=T.metadata)||void 0===o?void 0:null===(s=o.supabaseConfig)||void 0===s?void 0:s.supabaseDirectory),children:"Update"})]})})]})}}),(0,a.jsx)(J.Wi,{control:ed.control,name:"supabaseChangesOnly",render:e=>{let{field:n}=e;return(0,a.jsxs)(J.xJ,{className:"space-y-0 flex gap-x-4",children:[(0,a.jsx)(J.NI,{children:(0,a.jsx)($.r,{className:"mt-1",disabled:!ee,checked:n.value,onCheckedChange:e=>{n.onChange(e),ed.handleSubmit(eu)()}})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(J.lX,{className:"!text",children:"Supabase changes only"}),(0,a.jsxs)(J.pf,{className:"text-xs text-foreground-lighter",children:["Trigger branch creation only when there were changes to ",(0,a.jsx)("code",{children:"supabase"})," ","directory."]})]})]})}})]})})]})},en=()=>{var e;let{ref:n}=(0,f.UO)(),t=(0,c.V)(),i=(0,S.l)(),r=(0,C.x5)(),s=(0,N.Xo)(h.KA.READ,"integrations.github_connections"),o=(0,N.Xo)(h.KA.CREATE,"integrations.github_connections"),d=(0,N.Xo)(h.KA.UPDATE,"integrations.github_connections"),{data:u}=(0,_.q)({organizationId:null==i?void 0:i.id}),{mutateAsync:m}=(0,y.n)({onSuccess:()=>{x.Am.success("Successfully deleted Github connection")}}),P=(0,w.P)("branchManagement"),k=(null==t?void 0:t.parent_project_ref)!==void 0,E=null!==(e=null==u?void 0:u.filter(e=>k?e.project.ref===t.parent_project_ref:e.project.ref===n))&&void 0!==e?e:[],A=(0,p.useCallback)(()=>{r.setGithubConnectionsOpen(!0)},[r]),R=(0,p.useCallback)(async e=>{if(!(null==i?void 0:i.id)){x.Am.error("Organization not found");return}await m({connectionId:e.id,organizationId:i.id})},[m,null==i?void 0:i.id]);return(0,a.jsx)(l._S,{children:(0,a.jsxs)(l.jX,{children:[(0,a.jsxs)(l.g$,{title:"GitHub Connections",children:[(0,a.jsx)(b.U,{content:"\nConnect any of your GitHub repositories to a project.\n"}),(0,a.jsx)(ea,{title:"github"})]}),(0,a.jsx)(l.Lc,{children:s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b.U,{content:"\n\n### How will GitHub connections work?\n\nYou will be able to connect a GitHub repository to a Supabase project.\nThe GitHub app will watch for changes in your repository such as file changes, branch changes as well as pull request activity.\n"}),E.length>0?(0,a.jsx)("ul",{className:"flex flex-col",children:E.map(e=>{var n,t,i,r,s,o,l,c,u,m;return(0,a.jsxs)("div",{className:"relative flex flex-col -gap-[1px] [&>li]:pb-0",children:[(0,a.jsx)(g.z,{showNode:!1,disabled:k||!d,connection:{id:String(e.id),added_by:{id:String(null===(n=e.user)||void 0===n?void 0:n.id),primary_email:null!==(l=null===(t=e.user)||void 0===t?void 0:t.primary_email)&&void 0!==l?l:"",username:null!==(c=null===(i=e.user)||void 0===i?void 0:i.username)&&void 0!==c?c:""},foreign_project_id:String(e.repository.id),supabase_project_ref:e.project.ref,organization_integration_id:"unused",inserted_at:e.inserted_at,updated_at:e.updated_at,metadata:{name:e.repository.name}},type:"GitHub",onDeleteConnection:R,className:"!rounded-b-none !mb-0"},e.id),(0,a.jsx)("div",{className:"border-b border-l border-r rounded-b-lg",children:(0,a.jsx)(ee,{disabled:!d,connection:{id:String(e.id),added_by:{id:String(null===(r=e.user)||void 0===r?void 0:r.id),primary_email:null!==(u=null===(s=e.user)||void 0===s?void 0:s.primary_email)&&void 0!==u?u:"",username:null!==(m=null===(o=e.user)||void 0===o?void 0:o.username)&&void 0!==m?m:""},foreign_project_id:String(e.repository.id),supabase_project_ref:e.project.ref,organization_integration_id:"unused",inserted_at:e.inserted_at,updated_at:e.updated_at,metadata:{name:e.repository.name,supabaseConfig:{supabaseDirectory:e.workdir,supabaseChangesOnly:e.supabase_changes_only,branchLimit:e.branch_limit}}}})})]},e.id)})}):P?(0,a.jsx)(v.FP,{onClick:A,orgSlug:null==i?void 0:i.slug,showNode:!1,disabled:!o,children:"Add new project connection"}):(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:["Access to"," ",(0,a.jsx)("a",{href:"https://supabase.com/docs/guides/platform/branching",target:"_blank",rel:"noreferrer",className:"text-foreground",children:"branching"})," ","is required to add GitHub connections."]})]}):(0,a.jsx)(j.Z,{resourceText:"view this organization's GitHub connections"})})]})})},et=t(55579);let ea=e=>{let{title:n}=e;return(0,a.jsx)("img",{className:"border rounded-lg shadow w-48 mt-6 border-body",src:"".concat(d.GW,"/img/integrations/covers/").concat(n,"-cover.png"),alt:"".concat(n," cover")})};var ei=()=>{let e=(0,c.V)(),n=(0,c.N)(null==e?void 0:e.parent_project_ref),t=(null==e?void 0:e.parent_project_ref)!==void 0;return(0,a.jsxs)(a.Fragment,{children:[t&&(0,a.jsx)(l._S,{children:(0,a.jsxs)(u.bZ,{variant:"default",className:"mt-6",children:[(0,a.jsx)(m.aN,{}),(0,a.jsx)(u.Cd,{children:"You are currently on a preview branch of your project"}),(0,a.jsxs)(u.X,{children:["To adjust your project's integration settings, you may return to your"," ",(0,a.jsx)(r(),{href:"/project/".concat(null==n?void 0:n.ref,"/settings/general"),className:"text-brand",children:"main branch"}),"."]})]})}),(0,a.jsx)(en,{}),(0,a.jsx)(l.I7,{}),(0,a.jsx)(et.Z,{isProjectScoped:!0}),(0,a.jsx)(o.Z,{}),(0,a.jsx)(s.Z,{})]})}},55579:function(e,n,t){t.d(n,{Z:function(){return W}});var a=t(52322),i=t(17172),r=t(39097),s=t.n(r),o=t(2784),l=t(56958),c=t(59491),d=t(47342),u=t(84247),m=t(80435),h=t(74178),p=t(14782),x=t(9915),f=t(85945),g=t(48228),v=t(88354),b=t(99248),j=t(90301);async function y(e,n){let{organization_integration_id:t,id:a}=e;if(!t)throw Error("organization_integration_id is required");let i=await (0,v.$v)("".concat(b.T5,"/integrations/vercel/connections/").concat(a),{organization_integration_id:t},{signal:n});if(!(0,v.d8)(i))throw i.error;return i}let _=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,f.NL)();return(0,g.D)(e=>y(e),{async onSuccess(n,t,i){await Promise.all([a.invalidateQueries(j.F.integrationsList()),a.invalidateQueries(j.F.integrationsListWithOrg(t.orgSlug)),a.invalidateQueries(j.F.vercelProjectList(t.organization_integration_id)),a.invalidateQueries(j.F.vercelConnectionsList(t.organization_integration_id))]),await (null==e?void 0:e(n,t,i))},async onError(e,t,a){void 0===n?l.Am.error("Failed to delete Vercel connection: ".concat(e.message)):n(e,t,a)},...t})};var N=t(12459),S=t(87175),w=t(89823),C=t(26211),P=t(82955),k=t(92516),E=t(26205),A=t(54383),R=t(32079),I=t(37354),L=t(88883),V=t(63955),z=t(30195),O=t(6554),T=t(31696);async function U(e){let{id:n,envSyncTargets:t,publicEnvVarPrefix:a}=e,{data:i,error:r}=await (0,T.r$)("/platform/integrations/vercel/connections/{connection_id}",{params:{path:{connection_id:n}},body:{env_sync_targets:t,public_env_var_prefix:a}});return r&&(0,T.S3)(r),i}let D=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,f.NL)();return(0,g.D)(e=>U(e),{async onSuccess(n,t,i){await a.invalidateQueries(j.F.vercelConnectionsList(t.organizationIntegrationId)),await (null==e?void 0:e(n,t,i))},async onError(e,t,a){void 0===n?l.Am.error("Failed to update Vercel connection: ".concat(e.message)):n(e,t,a)},...t})};var Z=t(22574),B=t(93705),F=t(42070);let G="vercel-connection-form";var X=e=>{var n;let{disabled:t,connection:i,integration:r}=e,s=null!==(n=i.env_sync_targets)&&void 0!==n?n:[],o=z.Ry({environmentVariablesProduction:z.O7().default(s.includes("production")),environmentVariablesPreview:z.O7().default(s.includes("preview")),environmentVariablesDevelopment:z.O7().default(s.includes("development")),publicEnvVarPrefix:z.Z_().optional()}),c=(0,V.cI)({resolver:(0,L.F)(o),defaultValues:{environmentVariablesProduction:s.includes("production"),environmentVariablesPreview:s.includes("preview"),environmentVariablesDevelopment:s.includes("development"),publicEnvVarPrefix:i.public_env_var_prefix}}),{mutate:d,isLoading:u}=D({onSuccess:()=>{c.reset(c.getValues()),l.Am.success("Updated Vercel connection")}});return(0,a.jsx)(Z.l0,{...c,children:(0,a.jsx)("form",{id:G,onSubmit:c.handleSubmit(function(e){var n;let{environmentVariablesProduction:t,environmentVariablesPreview:a,environmentVariablesDevelopment:s}=e,o=[];t&&o.push("production"),a&&o.push("preview"),s&&o.push("development"),d({id:i.id,envSyncTargets:o,publicEnvVarPrefix:null===(n=e.publicEnvVarPrefix)||void 0===n?void 0:n.trim(),organizationIntegrationId:r.id})}),className:"w-full space-y-6",children:(0,a.jsxs)("div",{className:"px-6 py-4 flex flex-col gap-y-4",children:[(0,a.jsx)("h5",{className:"text-foreground text-sm",children:"Sync environment variables for selected target environments"}),(0,a.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,a.jsx)(Z.Wi,{control:c.control,name:"environmentVariablesProduction",render:e=>{let{field:n}=e;return(0,a.jsxs)(Z.xJ,{className:"space-y-0 flex gap-x-4",children:[(0,a.jsx)(Z.NI,{children:(0,a.jsx)(B.r,{disabled:t,className:"mt-1",checked:n.value,onCheckedChange:n.onChange})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(Z.lX,{className:"!text",children:"Production"}),(0,a.jsxs)(Z.pf,{className:"text-xs text-foreground-lighter",children:["Sync environment variables for ",(0,a.jsx)("code",{children:"production"})," environment."]})]})]})}}),(0,a.jsx)(Z.Wi,{control:c.control,name:"environmentVariablesPreview",render:e=>{let{field:n}=e;return(0,a.jsxs)(Z.xJ,{className:"space-y-0 flex gap-x-4",children:[(0,a.jsx)(Z.NI,{children:(0,a.jsx)(B.r,{disabled:t,className:"mt-1",checked:n.value,onCheckedChange:n.onChange})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(Z.lX,{className:"!text",children:"Preview"}),(0,a.jsxs)(Z.pf,{className:"text-xs text-foreground-lighter",children:["Sync environment variables for ",(0,a.jsx)("code",{children:"preview"})," environment."]})]})]})}}),(0,a.jsx)(Z.Wi,{control:c.control,name:"environmentVariablesDevelopment",render:e=>{let{field:n}=e;return(0,a.jsxs)(Z.xJ,{className:"space-y-0 flex gap-x-4",children:[(0,a.jsx)(Z.NI,{children:(0,a.jsx)(B.r,{disabled:t,className:"mt-1",checked:n.value,onCheckedChange:n.onChange})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(Z.lX,{className:"!text",children:"Development"}),(0,a.jsxs)(Z.pf,{className:"text-xs text-foreground-lighter",children:["Sync environment variables for ",(0,a.jsx)("code",{children:"development"})," environment."]})]})]})}})]}),(0,a.jsx)("h5",{className:"mt-2 text-foreground text-sm",children:"Customize public environment variable prefix"}),(0,a.jsx)("div",{className:"flex flex-col gap-4",children:(0,a.jsx)(Z.Wi,{control:c.control,name:"publicEnvVarPrefix",render:e=>{let{field:n}=e;return(0,a.jsxs)(Z.xJ,{className:"grid gap-2 md:grid md:grid-cols-12 space-y-0",children:[(0,a.jsx)(Z.lX,{className:"flex flex-col space-y-2 col-span-4 text-sm justify-center text-foreground-light",children:"Prefix"}),(0,a.jsx)(Z.NI,{className:"col-span-8",children:(0,a.jsx)(F.I,{...n,className:"w-full",placeholder:"An empty prefix will result in no public env vars"})}),(0,a.jsxs)(Z.pf,{className:"col-start-5 col-span-8 text-xs",children:["e.g."," ",(0,a.jsx)("code",{className:"cursor-pointer",role:"button",onClick:()=>{n.onChange("NEXT_PUBLIC_")},children:"NEXT_PUBLIC_"}),","," ",(0,a.jsx)("code",{className:"cursor-pointer",role:"button",onClick:()=>{n.onChange("VITE_PUBLIC_")},children:"VITE_PUBLIC_"}),","," ",(0,a.jsx)("code",{className:"cursor-pointer",role:"button",onClick:()=>{n.onChange("PUBLIC_")},children:"PUBLIC_"}),", etc."]}),(0,a.jsx)(Z.zG,{className:"col-start-5 col-span-8"})]})}})}),c.formState.isDirty?(0,a.jsxs)("p",{className:"mt-2 text-sm text-warning-600",children:["Note: Changing these settings will ",(0,a.jsx)("strong",{children:"not"})," trigger a resync of environment variables."]}):(0,a.jsx)("div",{className:"mt-2 h-5 w-full"}),(0,a.jsx)(O.i,{form:G,hasChanges:c.formState.isDirty,isSubmitting:u,handleReset:()=>c.reset()})]})})})},W=e=>{var n;let{isProjectScoped:t}=e,r=(0,C.V)(),f=(0,w.l)(),{data:g}=(0,x.T)({orgSlug:null==f?void 0:f.slug}),v=(0,E.x5)(),b=(0,S.Xo)(c.KA.READ,"integrations.vercel_connections"),j=(0,S.Xo)(c.KA.CREATE,"integrations.vercel_connections"),y=(0,S.Xo)(c.KA.UPDATE,"integrations.vercel_connections"),L=(null==r?void 0:r.parent_project_ref)!==void 0,{mutate:V}=_({onSuccess:()=>{l.Am.success("Successfully deleted Vercel connection")}}),z=(0,o.useMemo)(()=>null==g?void 0:g.filter(e=>"Vercel"===e.integration.name).map(e=>{if(e.metadata&&"Vercel"===e.integration.name){let n=e.metadata.account.avatar||"Team"!==e.metadata.account.type?"https://vercel.com/api/www/avatar/".concat(e.metadata.account.avatar,"?s=48"):"https://vercel.com/api/www/avatar?teamId=".concat(e.metadata.account.team_id,"&s=48");e.metadata.account.avatar=n}return e}),[g]),O=null==z?void 0:z[0],{data:T}=(0,N.t)({organization_integration_id:null==O?void 0:O.id},{enabled:(null==O?void 0:O.id)!==void 0}),U=null!==(n=null==T?void 0:T.length)&&void 0!==n?n:0,D=(0,o.useCallback)(e=>{v.setVercelConnectionsIntegrationId(e),v.setVercelConnectionsOpen(!0)},[v]),Z=(0,o.useCallback)(async e=>{V({id:e.id,organization_integration_id:e.organization_integration_id,orgSlug:null==f?void 0:f.slug})},[V,null==f?void 0:f.slug]),B=U>0&&void 0!==O?"\nYour Vercel connection has access to ".concat(U," Vercel Projects.\nYou can change the scope of the access for Supabase by configuring\n[here](").concat((0,k.H)(O),").\n"):"",F=(t?null==O?void 0:O.connections.filter(e=>e.supabase_project_ref===(null==r?void 0:r.ref)):null==O?void 0:O.connections)||[],G="".concat(F.length," project ").concat((0,P._6)(F.length,"connection")," ");return(0,a.jsx)(h._S,{children:(0,a.jsxs)(h.jX,{children:[(0,a.jsxs)(h.g$,{title:"Vercel Integration",children:[(0,a.jsx)(m.U,{content:"\n\nConnect your Vercel teams to your Supabase organization.\n"}),(0,a.jsx)(I.B,{title:"vercel"})]}),(0,a.jsx)(h.Lc,{children:b?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.U,{content:"\n\n### How does the Vercel integration work?\n\nSupabase will keep your environment variables up to date in each of the projects you assign to a Supabase project.\nYou can also link multiple Vercel Projects to the same Supabase project.\n"}),O?(0,a.jsxs)("div",{children:[(0,a.jsx)(u.ML,{title:"Vercel",integration:O}),F.length>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.WY,{title:G,markdown:"Repository connections for Vercel"}),(0,a.jsx)("ul",{className:"flex flex-col",children:F.map(e=>(0,a.jsxs)("div",{className:(0,A.cn)(t&&"relative flex flex-col -gap-[1px] [&>li]:pb-0"),children:[(0,a.jsx)(d.z,{connection:e,disabled:!y,type:"Vercel",onDeleteConnection:Z,className:(0,A.cn)(t&&"!rounded-b-none !mb-0")}),t?(0,a.jsx)("div",{className:"relative pl-8 ml-6 border-l border-muted pb-6",children:(0,a.jsx)("div",{className:"border-b border-l border-r rounded-b-lg",children:(0,a.jsx)(X,{connection:e,integration:O,disabled:!y})})}):null]},e.id))})]}):(0,a.jsx)(u.WY,{title:G,className:"pb-0",markdown:"Repository connections for Vercel"}),(0,a.jsx)(u.FP,{orgSlug:null==f?void 0:f.slug,disabled:!j,onClick:()=>D(O.id),children:"Add new project connection"})]},O.id):(0,a.jsx)("div",{children:(0,a.jsx)(R.z,{icon:(0,a.jsx)(i.Z,{}),asChild:!L,type:"default",disabled:L,children:L?(0,a.jsx)("p",{children:"Install Vercel Integration"}):(0,a.jsx)(s(),{href:"https://vercel.com/integrations/supabase",target:"_blank",rel:"noreferrer",children:"Install Vercel Integration"})})}),B&&(0,a.jsx)(m.U,{extLinks:!0,content:B,className:"text-foreground-lighter"})]}):(0,a.jsx)(p.Z,{resourceText:"view this organization's Vercel connections"})})]})})}},74178:function(e,n,t){t.d(n,{CG:function(){return p},FW:function(){return d},I7:function(){return m},Lc:function(){return f},Wv:function(){return v},_S:function(){return u},g$:function(){return x},gW:function(){return j},jX:function(){return h},q7:function(){return c},tM:function(){return g},tU:function(){return l},ur:function(){return b}});var a=t(52322),i=t(2784),r=t(54383);let s="mx-auto w-full max-w-[1200px]",o="px-6 lg:px-14 xl:px-24 2xl:px-32",l=i.forwardRef((e,n)=>{let{className:t,...i}=e;return(0,a.jsx)("header",{...i,ref:n,className:(0,r.cn)("w-full","flex-col gap-3 py-6",t)})}),c=i.forwardRef((e,n)=>{let{className:t,...i}=e;return(0,a.jsx)("h1",{ref:n,...i,className:(0,r.cn)("text-2xl",t)})}),d=i.forwardRef((e,n)=>{let{className:t,...i}=e;return(0,a.jsx)("span",{ref:n,...i,className:(0,r.cn)("text-sm text-foreground-light",t)})}),u=i.forwardRef((e,n)=>{let{className:t,bottomPadding:i,...l}=e;return(0,a.jsx)("div",{ref:n,...l,className:(0,r.cn)(s,o,i&&"pb-16",t)})}),m=i.forwardRef((e,n)=>{let{className:t,...i}=e;return(0,a.jsx)("div",{ref:n,...i,className:(0,r.cn)("w-full h-px bg-border",t)})}),h=i.forwardRef((e,n)=>{let{className:t,...i}=e;return(0,a.jsx)("div",{ref:n,...i,className:(0,r.cn)("flex flex-col gap-3 py-6","lg:grid md:grid-cols-12 lg:py-12",t)})}),p=i.forwardRef((e,n)=>{let{className:t,...i}=e;return(0,a.jsx)("div",{ref:n,...i,className:(0,r.cn)("flex flex-col gap-3","min-w-[420px]",t)})}),x=i.forwardRef((e,n)=>{let{className:t,children:i,title:s,...o}=e;return(0,a.jsxs)("div",{ref:n,...o,className:(0,r.cn)("col-span-4 xl:col-span-5 prose text-sm",t),children:[s&&(0,a.jsx)("h2",{children:s}),i]})}),f=i.forwardRef((e,n)=>{let{className:t,...i}=e;return(0,a.jsx)("div",{ref:n,...i,className:(0,r.cn)("col-span-8 xl:col-span-7","flex flex-col gap-6",t)})}),g=i.forwardRef((e,n)=>{let{className:t,...i}=e;return(0,a.jsx)("div",{ref:n,...i,className:(0,r.cn)("flex flex-col gap-3 items-center",t)})}),v=i.forwardRef((e,n)=>{let{className:t,...i}=e;return(0,a.jsx)("div",{ref:n,...i,className:(0,r.cn)("flex w-full items-center",t)})}),b=i.forwardRef((e,n)=>{let{className:t,...i}=e;return(0,a.jsx)("div",{ref:n,...i,className:(0,r.cn)("flex flex-row gap-3",t)})}),j=i.forwardRef((e,n)=>{let{className:t,...i}=e;return(0,a.jsx)("div",{ref:n,...i,className:(0,r.cn)(s,o,"my-8 flex flex-col gap-8",t)})});l.displayName="ScaffoldHeader",c.displayName="ScaffoldTitle",d.displayName="ScaffoldDescription",u.displayName="ScaffoldContainer",m.displayName="ScaffoldDivider",h.displayName="ScaffoldSection",p.displayName="ScaffoldColumn",x.displayName="ScaffoldSectionDetail",f.displayName="ScaffoldSectionContent",g.displayName="ScaffoldFilterAndContent",v.displayName="ScaffoldActionsContainer",b.displayName="ScaffoldActionsGroup",j.displayName="ScaffoldContainerLegacy"},9673:function(e,n,t){t.d(n,{B:function(){return r},t:function(){return s}});var a=t(52322),i=t(9548);let r=(0,a.jsx)("div",{className:"flex items-center justify-center rounded bg-black p-1",children:(0,a.jsx)("svg",{className:"m-auto fill-current text-white",width:"12px",height:"12px",viewBox:"0 0 1155 1000",children:(0,a.jsx)("path",{d:"M577.344 0L1154.69 1000H0L577.344 0Z"})})}),s=(0,a.jsx)("div",{className:"flex items-center justify-center rounded bg-green-500 p-1 [[data-theme*=dark]_&]:text-typography-body-dark ",children:(0,a.jsx)(i.Z,{size:12,strokeWidth:2})})},6554:function(e,n,t){t.d(n,{i:function(){return r}});var a=t(52322),i=t(32079);let r=e=>{let{form:n,hasChanges:t,handleReset:r,helper:s,disabled:o=!1,isSubmitting:l,submitText:c="Save"}=e,d=l||o||!t&&void 0!==t;return(0,a.jsxs)("div",{className:["flex w-full items-center gap-2",s?"justify-between":"justify-end"].join(" "),children:[s&&(0,a.jsx)("span",{className:"text-sm text-foreground-lighter",children:s}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(i.z,{disabled:d,type:"default",htmlType:"reset",onClick:()=>r(),children:"Cancel"}),(0,a.jsx)(i.z,{form:n,type:"primary",htmlType:"submit",disabled:d,loading:l,children:c})]})]})}},14782:function(e,n,t){var a=t(52322),i=t(52006);n.Z=e=>{let{resourceText:n,isFullPage:t=!1}=e,r=()=>(0,a.jsx)("div",{className:"block w-full rounded border border-opacity-20 py-4 px-6 border-overlay bg-surface-200",children:(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)(i.Z,{size:20})}),(0,a.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{className:"text-sm",children:["You need additional permissions to ",n]}),(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Contact your organization owner or administrator for assistance."})})]})})]})});return t?(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsx)("div",{className:"w-[550px]",children:(0,a.jsx)(r,{})})}):(0,a.jsx)(r,{})}},34928:function(e,n,t){t.d(n,{e:function(){return c}});var a=t(85945),i=t(48228),r=t(56958),s=t(31696),o=t(79073);async function l(e){let{id:n,branchName:t,gitBranch:a,persistent:i}=e,{data:r,error:o}=await (0,s.r$)("/v1/branches/{branch_id}",{params:{path:{branch_id:n}},body:{branch_name:t,git_branch:a,persistent:i}});return o&&(0,s.S3)(o),r}let c=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,a.NL)();return(0,i.D)(e=>l(e),{async onSuccess(n,t,a){let{projectRef:i}=t;await s.invalidateQueries(o.x.list(i)),await (null==e?void 0:e(n,t,a))},async onError(e,t,a){void 0===n?r.Am.error("Failed to update branch: ".concat(e.message)):n(e,t,a)},...t})}},9915:function(e,n,t){t.d(n,{T:function(){return l}});var a=t(36492),i=t(88354),r=t(99248),s=t(90301);async function o(e,n){let{orgSlug:t}=e;if(!t)throw Error("orgSlug is required");let a=await (0,i.U2)("".concat(r.T5,"/integrations/").concat(t,"?expand=true"),{signal:n});if(a.error)throw a.error;return a}let l=function(e){let{orgSlug:n}=e,{enabled:t=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.a)(s.F.integrationsListWithOrg(n),e=>{let{signal:t}=e;return o({orgSlug:n},t)},{enabled:t&&void 0!==n,...i})}},40119:function(e,n,t){t.d(n,{h:function(){return o}});var a=t(48228),i=t(56958),r=t(31696);async function s(e){let{connectionId:n}=e,{data:t,error:a}=await (0,r.v_)("/platform/integrations/vercel/connections/{connection_id}/sync-envs",{params:{path:{connection_id:n}}});return a&&(0,r.S3)(a),t}let o=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.D)(e=>s(e),{async onSuccess(n,t,a){await (null==e?void 0:e(n,t,a))},async onError(e,t,a){void 0===n?i.Am.error("Failed to sync environment variables: ".concat(e.message)):n(e,t,a)},...t})}},15111:function(e,n,t){t.d(n,{K:function(){return d}});var a=t(85945),i=t(48228),r=t(56958),s=t(31696),o=t(63422),l=t(90301);async function c(e){let{organizationIntegrationId:n,connection:t}=e,{data:a,error:i}=await (0,s.v_)("/platform/integrations/vercel/connections",{body:{organization_integration_id:n,connection:{foreign_project_id:t.foreign_project_id,supabase_project_ref:t.supabase_project_ref,metadata:t.metadata}}});return i&&(0,s.S3)(i),a}let d=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,a.NL)(),d=(0,o.IF)();return(0,i.D)(e=>c(e),{async onSuccess(n,t,a){await Promise.all([s.invalidateQueries(l.F.integrationsList()),s.invalidateQueries(l.F.integrationsListWithOrg(t.orgSlug)),s.invalidateQueries(l.F.vercelProjectList(t.organizationIntegrationId)),s.invalidateQueries(l.F.vercelConnectionsList(t.organizationIntegrationId))]),await (null==e?void 0:e(n,t,a))},async onError(e,t,a){d.setLoading(!1),void 0===n?r.Am.error("Failed to create connection: ".concat(e.message)):n(e,t,a)},...t})}},12459:function(e,n,t){t.d(n,{t:function(){return o}});var a=t(36492),i=t(31696),r=t(90301);async function s(e,n){let{organization_integration_id:t}=e;if(!t)throw Error("organization_integration_id is required");let{data:a,error:r}=await (0,i.U2)("/platform/integrations/vercel/projects/{organization_integration_id}",{params:{path:{organization_integration_id:t},query:{limit:"1000"}},signal:n});return r&&(0,i.S3)(r),a.projects}let o=function(e){let{organization_integration_id:n}=e,{enabled:t=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.a)(r.F.vercelProjectList(n),e=>{let{signal:t}=e;return s({organization_integration_id:n},t)},{enabled:t&&void 0!==n,...i})}},63422:function(e,n,t){t.d(n,{IF:function(){return s}});var a=t(9162),i=t(4741);let r=(0,a.sj)({loading:!1,setLoading:e=>{r.loading=e}}),s=e=>(0,i.R)(r,e)},74138:function(e,n,t){var a=t(52322),i=t(2784),r=t(41909),s=t(54383),o=t(32079),l=t(71550);let c=(0,i.forwardRef)((e,n)=>{let{title:t,size:c="small",visible:d,onCancel:u,onConfirm:m,loading:h=!1,cancelLabel:p="Cancel",confirmLabel:x="Submit",confirmLabelLoading:f,alert:g,children:v,variant:b="default",disabled:j,...y}=e;(0,i.useEffect)(()=>{d&&N(!1)},[d]),(0,i.useEffect)(()=>{N(h)},[h]);let[_,N]=(0,i.useState)(!1);return(0,a.jsx)(r.Vq,{open:d,...y,onOpenChange:()=>{d&&u()},children:(0,a.jsxs)(r.cZ,{ref:n,className:"p-0 gap-0 pb-5 !block",size:c,children:[(0,a.jsx)(r.fK,{className:(0,s.cn)("border-b"),padding:"small",children:(0,a.jsx)(r.$N,{className:"",children:t})}),g&&(0,a.jsx)(l.J,{type:b,label:g.title,description:g.description,className:"border-r-0 border-l-0 rounded-none -mt-px [&_svg]:ml-0.5 mb-0",...null==g?void 0:g.base}),v&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.VO,{padding:"small",children:v}),(0,a.jsx)(r.P3,{})]}),(0,a.jsxs)("div",{className:"flex gap-2 px-5 pt-5",children:[(0,a.jsx)(o.z,{size:"medium",block:!0,type:"default",disabled:_,onClick:()=>u(),children:p}),(0,a.jsx)(o.z,{block:!0,size:"medium",type:"destructive"===b?"danger":"warning"===b?"warning":"primary",htmlType:"submit",loading:_,disabled:_||j,onClick:e=>{e.preventDefault(),e.stopPropagation(),N(!0),m()},className:"truncate",children:x})]})]})})});c.displayName="ConfirmationModal",n.Z=c},93705:function(e,n,t){t.d(n,{r:function(){return d}});var a=t(52322),i=t(16530),r=t(10929),s=t(2784),o=t(54383);let l=(0,r.j)("peer inline-flex shrink-0 cursor-pointer items-center rounded-full border transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-brand data-[state=checked]:hover:bg-brand-600/90 data-[state=unchecked]:bg-control data-[state=unchecked]:hover:bg-border",{variants:{size:{small:"h-[16px] w-[28px]",medium:"h-[20px] w-[34px]",large:"h-[24px] w-[44px]"}},defaultVariants:{size:"medium"}}),c=(0,r.j)("pointer-events-none block rounded-full bg-foreground-lighter data-[state=checked]:bg-white shadow-lg ring-0 transition-transform",{variants:{size:{small:"h-[12px] w-[12px] data-[state=checked]:translate-x-[13px] data-[state=unchecked]:translate-x-[1px]",medium:"h-[16px] w-[16px] data-[state=checked]:translate-x-[15px] data-[state=unchecked]:translate-x-[1px]",large:"h-[18px] w-[18px] data-[state=checked]:translate-x-[22px] data-[state=unchecked]:translate-x-[3px]"}},defaultVariants:{size:"medium"}}),d=s.forwardRef((e,n)=>{let{className:t,size:r,...s}=e;return(0,a.jsx)(i.fC,{className:(0,o.cn)(l({size:r}),t),...s,ref:n,children:(0,a.jsx)(i.bU,{className:(0,o.cn)(c({size:r}))})})});d.displayName=i.fC.displayName}}]);