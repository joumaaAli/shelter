(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6377,8020,5632],{40936:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/sql/[id]",function(){return n(37700)}])},22965:function(e,t,n){"use strict";n.d(t,{Bi:function(){return r},E$:function(){return h},Gf:function(){return u},KG:function(){return i}});var s=n(99248);let i=e=>{let{currentTarget:t}=e;return t.scrollTop+10>=t.scrollHeight-t.clientHeight},r=e=>e.map(e=>{var t,n;let i=null!==(n=null===(t=e.raw_app_meta_data)||void 0===t?void 0:t.provider)&&void 0!==n?n:"";return{id:e.id,email:e.email,phone:e.phone,created_at:e.created_at,last_sign_in_at:e.last_sign_in_at,provider:e.is_anonymous?"-":i,provider_type:e.is_anonymous?"Anonymous":c.includes(i)?"Social":d.includes(i)?"Phone":"-",provider_icon:"email"===i?"".concat(s.GW,"/img/icons/email-icon2.svg"):o[i]?"".concat(s.GW,"/img/icons/").concat(o[i],".svg"):void 0,img:h(e),name:u(e)}}),a=[{apple:"apple-icon"},{azure:"microsoft-icon"},{bitbucket:"bitbucket-icon"},{discord:"discord-icon"},{facebook:"facebook-icon"},{figma:"figma-icon"},{github:"github-icon"},{gitlab:"gitlab-icon"},{google:"google-icon"},{kakao:"kakao-icon"},{keycloak:"keycloak-icon"},{linkedin:"linkedin-icon"},{notion:"notion-icon"},{twitch:"twitch-icon"},{twitter:"twitter-icon"},{slack:"slack-icon"},{spotify:"spotify-icon"},{workos:"workos-icon"},{zoom:"zoom-icon"}],l=[{twilio:"twilio-icon"},{messagebird:"messagebird-icon"},{textlocal:"messagebird-icon"},{vonage:"messagebird-icon"},{twilioverify:"twilio-verify-icon"}],o=Object.values([...a,...l]).reduce((e,t)=>{let[[n,s]]=Object.entries(t);return{...e,[n]:s}},{}),c=a.map(e=>{let[t]=Object.keys(e);return t}),d=l.map(e=>{let[t]=Object.keys(e);return t});function u(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",{displayName:s,display_name:i,fullName:r,full_name:a,familyName:l,family_name:o,givenName:c,given_name:d,surname:u,lastName:h,last_name:m,firstName:p,first_name:x}=null!==(t=e.raw_user_meta_data)&&void 0!==t?t:{},g=l||o||u||h||m,f=c||d||p||x;return s||i||r||a||f&&g&&"".concat(f," ").concat(g)||n}function h(e){var t;let{avatarUrl:n,avatarURL:s,avatar_url:i,profileUrl:r,profileURL:a,profile_url:l,profileImage:o,profile_image:c,profileImageUrl:d,profileImageURL:u,profile_image_url:h}=null!==(t=e.raw_user_meta_data)&&void 0!==t?t:{};return n||s||i||o||c||r||a||l||d||u||h}},28043:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var s=n(52322),i=n(39097),r=n.n(i),a=n(55283),l=n(54383),o=n(2784),c=n(91179);function d(e){let{className:t}=e,[n,i]=(0,o.useState)(!1);return(0,s.jsxs)(a.zF,{open:n,onOpenChange:i,className:(0,l.cn)("mt-4",t),children:[(0,s.jsx)(a.wy,{asChild:!0,children:(0,s.jsxs)("div",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,s.jsx)(c.Z,{strokeWidth:2,size:16,className:(0,l.cn)("transition-all",n?"rotate-90":"")}),(0,s.jsx)("p",{className:"text-sm text-foreground-light underline",children:"Important information regarding opting in"})]})}),(0,s.jsx)(a.Fw,{children:(0,s.jsxs)("div",{className:"space-y-2 py-4 text-sm text-foreground-light",children:[(0,s.jsx)("p",{children:"Supabase AI is a chatbot support tool powered by OpenAI. Supabase will share the query you submit and information about the databases you manage through Supabase with OpenAI, L.L.C. and its affiliates in order to provide the Supabase AI tool."}),(0,s.jsx)("p",{children:"OpenAI will only access information about the structure of your databases, such as table names, column and row headings. OpenAI will not access the contents of the database itself."}),(0,s.jsx)("p",{children:"OpenAI uses this information to generate responses to your query, and does not retain or use the information to train its algorithms or otherwise improve its products and services."}),(0,s.jsx)("p",{children:"If you have your own individual account on Supabase, we will use any personal information collected through [Supabase AI] to provide you with the [Supabase AI] tool. If you are in the UK, EEA or Switzerland, the processing of this personal information is necessary for the performance of a contract between you and us."}),(0,s.jsx)("p",{children:"Supabase collects information about the queries you submit through Supabase AI and the responses you receive to assess the performance of the Supabase AI tool and improve our services. If you are in the UK, EEA or Switzerland, the processing is necessary for our legitimate interests, namely informing our product development and improvement."}),(0,s.jsxs)("p",{children:["For more information about how we use personal information, please see our"," ",(0,s.jsx)(r(),{href:"https://supabase.com/privacy",target:"_blank",rel:"noreferrer",className:"text-brand border-b border-brand",children:"privacy policy"}),"."]})]})})]})}},3696:function(e,t,n){"use strict";n.d(t,{Q:function(){return z},G:function(){return Z}});var s=n(52322),i=n(2784),r=n(61786),a=n(32079),l=n(54383),o=n(78232),c=n(24334),d=n(83537),u=n(34503),h=n(6659);let m=e=>{let{isSelected:t=!1}=e,{resolvedTheme:n}=(0,h.F)();return(0,s.jsx)("svg",{width:"53",height:"17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsxs)("g",{opacity:t?"1":".5",children:[(0,s.jsx)("rect",{x:"37.161",y:".53",width:"15",height:"15",rx:"5.5",stroke:"light"===n?"#11181C":"#EDEDED"}),(0,s.jsx)("path",{d:"M1 10.53h32.214",stroke:"#33A7E9",strokeLinecap:"round",strokeDasharray:"2 2"}),(0,s.jsx)("rect",{x:"15.964",y:".53",width:"9",height:"15",rx:"4.5",stroke:"light"===n?"#7E868C":"#7E7E7E"}),(0,s.jsx)("path",{d:"M1 5.53h32.214",stroke:"#33A7E9",strokeLinecap:"round",strokeDasharray:"2 2"})]})})},p=e=>{let{isSelected:t=!1}=e,{resolvedTheme:n}=(0,h.F)();return(0,s.jsx)("svg",{width:"53",height:"17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsxs)("g",{opacity:t?"1":".5",children:[(0,s.jsx)("path",{d:"M1 4.994a.5.5 0 0 0 0 1v-1Zm16.218 1h.5v-1h-.5v1ZM1 5.994h1.014v-1H1v1Zm3.04 0h2.028v-1H4.041v1Zm4.056 0h2.027v-1H8.096v1Zm4.054 0h2.027v-1H12.15v1Zm4.055 0h1.013v-1h-1.013v1Z",fill:"light"===n?"#7E868C":"#7E7E7E"}),(0,s.jsx)("path",{d:"m15.92 12.56 9.04-9.04",stroke:"light"===n?"#11181C":"#EDEDED"}),(0,s.jsx)("rect",{x:"15.964",y:".494",width:"9",height:"15",rx:"4.5",stroke:"light"===n?"#11181C":"#EDEDED"}),(0,s.jsx)("rect",{x:"37.161",y:".744",width:"15",height:"15",rx:"5.5",stroke:"light"===n?"#11181C":"#EDEDED"}),(0,s.jsx)("path",{d:"M1 10.494h32.214",stroke:"#33A7E9",strokeLinecap:"round",strokeDasharray:"2 2"}),(0,s.jsx)("path",{d:"M15.96 7.562 22.568.956M19.049 14.885l5.957-5.958",stroke:"light"===n?"#11181C":"#EDEDED"})]})})},x=e=>{let{isSelected:t=!1}=e,{resolvedTheme:n}=(0,h.F)();return(0,s.jsx)("svg",{width:"68",height:"17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsxs)("g",{opacity:t?"1":".5",children:[(0,s.jsx)("path",{d:"M15.63 5.156a.5.5 0 1 0 0 1v-1Zm16.218 1h.5v-1h-.5v1Zm-16.218 0h1.013v-1H15.63v1Zm3.04 0h2.028v-1h-2.027v1Zm4.055 0h2.028v-1h-2.028v1Zm4.055 0h2.027v-1H26.78v1Zm4.055 0h1.013v-1h-1.013v1Z",fill:"light"===n?"#7E868C":"#7E7E7E"}),(0,s.jsx)("path",{d:"m30.55 12.722 9.04-9.04",stroke:"light"===n?"#11181C":"#EDEDED"}),(0,s.jsx)("rect",{x:"30.594",y:".656",width:"9",height:"15",rx:"4.5",stroke:"light"===n?"#11181C":"#EDEDED"}),(0,s.jsx)("rect",{x:"51.791",y:".906",width:"15",height:"15",rx:"5.5",stroke:"light"===n?"#11181C":"#EDEDED"}),(0,s.jsx)("path",{d:"M15.63 10.656h32.214",stroke:"#33A7E9",strokeLinecap:"round",strokeDasharray:"2 2"}),(0,s.jsx)("path",{d:"m30.59 7.724 6.607-6.606M33.679 15.047l5.957-5.958",stroke:"light"===n?"#11181C":"#EDEDED"}),(0,s.jsx)("path",{d:"M12.666 14.281v-1.333A2.667 2.667 0 0 0 10 10.28H6a2.667 2.667 0 0 0-2.667 2.667v1.333M8 7.615A2.667 2.667 0 1 0 8 2.28a2.667 2.667 0 0 0 0 5.334Z",stroke:"light"===n?"#11181C":"#EDEDED",strokeLinecap:"round",strokeLinejoin:"round"})]})})};var g=n(76141),f=n(17747),v=function(e){let{label:t,value:n,isSelected:i,onSelectedChange:r,icon:a}=e;return(0,s.jsxs)("label",{className:(0,l.cn)("border border-default rounded-md bg-surface-200 hover:bg-overlay-hover hover:border-control px-4 py-3 w-44 cursor-pointer transition-colors",i&&"border-foreground-muted hover:border-foreground-muted bg-surface-300"),tabIndex:0,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&r(n)},htmlFor:"role-".concat(n),children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[a&&(0,s.jsx)("div",{children:a}),i&&(0,s.jsxs)("div",{className:"flex items-center justify-center p-0.5 bg-foreground text-background rounded-full",children:["boolean"==typeof i&&(0,s.jsx)(g.Z,{size:12,strokeWidth:"4",className:"text-background"}),"partially"===i&&(0,s.jsx)(f.Z,{size:12,strokeWidth:"4",className:"text-background"})]})]}),(0,s.jsx)("input",{id:"role-".concat(n),type:"radio",name:"role",value:n,checked:!!i,onChange:e=>{r(e.target.value)},className:"invisible h-0 w-0 border-0"}),(0,s.jsxs)("span",{className:(0,l.cn)("text-sm text-foreground-light whitespace-nowrap select-none transition-colors",i&&"text-foreground"),children:[null!=t?t:n," role"]})]})},_=n(53111),j=n(45010),b=n(68806),y=n(8609),N=n(17172),w=n(27570),k=n(56006),E=n(38530),S=n(750),C=n(55283),q=n(93705),A=n(69548),R=n(22965),L=()=>{var e,t,n,r;let[l,c]=(0,i.useState)(""),[u,h]=(0,i.useState)("aal1"),m=(0,_.Nr)(l,300),{project:p}=(0,w.d2)(),{data:x,isSuccess:g,isLoading:f,isError:v,error:L,isFetching:Z,isPreviousData:z}=(0,E.xY)({projectRef:null==p?void 0:p.ref,connectionString:null==p?void 0:p.connectionString,keywords:m||void 0},{keepPreviousData:!0}),T=(0,d.fN)(),F=(null===(e=T.role)||void 0===e?void 0:e.type)==="postgrest"&&"authenticated"===T.role.role&&T.role.user;function O(e){T.setRole({type:"postgrest",role:"authenticated",user:e,aal:u})}return(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)("h2",{className:"text-foreground text-base",children:F?"Impersonating ".concat((0,R.Gf)(F,null!==(r=null!==(n=null!==(t=F.email)&&void 0!==t?t:F.phone)&&void 0!==n?n:F.id)&&void 0!==r?r:"Unknown")):"Impersonate a User"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light max-w-md",children:F?"Results will respect your database's Row-Level Security policies for this user.":"Select a user to respect your database's Row-Level Security policies for that particular user."}),F?(0,s.jsx)(I,{user:F,onClick:function(){T.setRole(void 0)},isImpersonating:!0,aal:u}):(0,s.jsxs)("div",{className:"flex flex-col gap-2 mt-4",children:[(0,s.jsx)(S.Z,{className:"table-editor-search border-none",icon:z&&Z?(0,s.jsx)(j.Z,{className:"animate-spin text-foreground-lighter",size:16,strokeWidth:1.5}):(0,s.jsx)(b.Z,{className:"text-foreground-lighter",size:16,strokeWidth:1.5}),placeholder:"Search for a user..",onChange:e=>c(e.target.value.trim()),value:l,size:"small",actions:l&&(0,s.jsx)(a.z,{size:"tiny",type:"text",className:"px-1",onClick:()=>c(""),children:(0,s.jsx)(y.Z,{size:12,strokeWidth:2})})}),(0,s.jsxs)(C.zF,{children:[(0,s.jsx)(C.wy,{className:"group font-normal p-0 [&[data-state=open]>div>svg]:!-rotate-180",children:(0,s.jsxs)("div",{className:"flex items-center gap-x-1 w-full",children:[(0,s.jsx)("p",{className:"text-xs text-foreground-light group-hover:text-foreground transition",children:"Advanced options"}),(0,s.jsx)(o.Z,{className:"transition-transform duration-200",strokeWidth:1.5,size:14})]})}),(0,s.jsxs)(C.Fw,{className:"mt-1 flex flex-row items-center gap-x-4 text-sm text-foreground-light",children:[(0,s.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,s.jsx)("h3",{children:"MFA assurance level"}),(0,s.jsxs)(A.b,{side:"top",className:"flex flex-col gap-1 max-w-96",children:[(0,s.jsxs)("p",{children:["AAL1 verifies users via standard login methods, while AAL2 adds a second authentication factor.",(0,s.jsx)("br",{}),"If you're not using MFA, you can leave this on AAL1."]}),(0,s.jsxs)("a",{href:"/docs/guides/auth/auth-mfa",target:"_blank",rel:"noreferrer",className:"flex items-center gap-x-1 opacity-50 hover:opacity-100 transition",children:["Learn more about MFA ",(0,s.jsx)(N.Z,{size:14,strokeWidth:2})]})]})]}),(0,s.jsxs)("div",{className:"flex flex-row items-center gap-x-2 text-xs font-bold",children:[(0,s.jsx)("p",{className:"aal1"===u?void 0:"text-foreground-lighter",children:"AAL1"}),(0,s.jsx)(q.r,{checked:"aal2"===u,onCheckedChange:function(){h(e=>"aal2"===e?"aal1":"aal2")}}),(0,s.jsx)("p",{className:"aal2"===u?void 0:"text-foreground-lighter",children:"AAL2"})]})]})]}),f&&(0,s.jsxs)("div",{className:"flex flex-col gap-2 items-center justify-center h-24",children:[(0,s.jsx)(j.Z,{className:"animate-spin",size:24}),(0,s.jsx)("span",{children:"Loading users..."})]}),v&&(0,s.jsx)(k.Z,{error:L,subject:"Failed to retrieve users"}),g&&(x.users.length>0?(0,s.jsx)("ul",{className:"divide-y max-h-[192px] overflow-y-scroll",role:"list",children:x.users.map(e=>(0,s.jsx)("li",{role:"listitem",children:(0,s.jsx)(D,{user:e,onClick:O})},e.id))}):(0,s.jsx)("div",{className:"flex flex-col gap-2 items-center justify-center h-24",children:(0,s.jsx)("p",{className:"text-foreground-light text-xs",role:"status",children:"No users found"})}))]})]})};let I=e=>{var t,n,i;let{user:r,onClick:l,isImpersonating:o=!1,aal:d}=e,u=(0,R.E$)(r),h=(0,R.Gf)(r,null!==(i=null!==(n=null!==(t=r.email)&&void 0!==t?t:r.phone)&&void 0!==n?n:r.id)&&void 0!==i?i:"Unknown")+(r.is_anonymous?" (anonymous)":"");return(0,s.jsxs)("div",{className:"flex items-center gap-3 py-2 text-foreground",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 bg-surface-200 pr-4 pl-0.5 py-0.5 border rounded-full max-w-l",children:[u?(0,s.jsx)("img",{className:"rounded-full w-5 h-5",src:u,alt:h}):(0,s.jsx)("div",{className:"rounded-full w-[21px] h-[21px] bg-surface-300 border border-strong flex items-center justify-center",children:(0,s.jsx)(c.Z,{size:12,strokeWidth:2})}),(0,s.jsxs)("span",{className:"text-sm truncate",children:[h," ",(0,s.jsx)("span",{className:"ml-2 text-foreground-lighter text-xs font-light",children:"aal2"===d?"AAL2":"AAL1"})]})]}),(0,s.jsx)(a.z,{type:"secondary",onClick:()=>{l(r)},children:o?"Stop Impersonating":"Impersonate"})]})},D=e=>{var t,n,i;let{user:r,onClick:l,isImpersonating:o=!1}=e,d=(0,R.E$)(r),u=(0,R.Gf)(r,null!==(i=null!==(n=null!==(t=r.email)&&void 0!==t?t:r.phone)&&void 0!==n?n:r.id)&&void 0!==i?i:"Unknown")+(r.is_anonymous?" (anonymous)":"");return(0,s.jsxs)("div",{className:"flex items-center justify-between py-2 text-foreground",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[d?(0,s.jsx)("img",{className:"rounded-full w-5 h-5",src:d,alt:u}):(0,s.jsx)("div",{className:"rounded-full w-[21px] h-[21px] bg-surface-300 border text-muted flex items-center justify-center text-background",children:(0,s.jsx)(c.Z,{size:12,strokeWidth:2})}),(0,s.jsx)("span",{className:"text-sm",children:u})]}),(0,s.jsx)(a.z,{type:"secondary",onClick:()=>{l(r)},children:o?"Stop Impersonating":"Impersonate"})]})};var Z=e=>{var t;let{serviceRoleLabel:n,padded:r=!0}=e,a=(0,d.fN)(),[o,c]=(0,i.useState)(()=>{var e;return(null===(e=a.role)||void 0===e?void 0:e.type)==="postgrest"&&("anon"===a.role.role||"authenticated"===a.role.role)?a.role.role:"service_role"}),h=!!("authenticated"===o&&(null===(t=a.role)||void 0===t?void 0:t.type)==="postgrest"&&"authenticated"===a.role.role&&a.role.user);function g(e){"service_role"===e&&a.setRole(void 0),"anon"===e&&a.setRole({type:"postgrest",role:e}),c(e)}return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:(0,l.cn)("flex flex-col gap-3",r?"p-5":"pb-5"),children:[(0,s.jsx)("h2",{className:"text-foreground text-base",children:"Database role settings"}),(0,s.jsx)("form",{onSubmit:e=>{e.preventDefault()},children:(0,s.jsxs)("fieldset",{className:"flex gap-3",children:[(0,s.jsx)(v,{value:"service_role",isSelected:"service_role"===o,onSelectedChange:g,label:n,icon:(0,s.jsx)(m,{isSelected:"service_role"===o})}),(0,s.jsx)(v,{value:"anon",isSelected:"anon"===o,onSelectedChange:g,icon:(0,s.jsx)(p,{isSelected:"anon"===o})}),(0,s.jsx)(v,{value:"authenticated",isSelected:"authenticated"===o&&(h||"partially"),onSelectedChange:g,icon:(0,s.jsx)(x,{isSelected:"authenticated"===o})})]})}),"service_role"===o&&(0,s.jsxs)("p",{className:"text-foreground-light text-sm",children:["The default Postgres/superuser role. This has admin privileges.",(0,s.jsx)("br",{}),"It will bypass Row Level Security (RLS) policies."]}),"anon"===o&&(0,s.jsxs)("p",{className:"text-foreground-light text-sm",children:['For "anonymous access". This is the role which the API (PostgREST) will use when a user',(0,s.jsx)("br",{}),"is not logged in. It will respect Row Level Security (RLS) policies."]}),"authenticated"===o&&(0,s.jsxs)("p",{className:"text-foreground-light text-sm",children:['For "authenticated access". This is the role which the API (PostgREST) will use when',(0,s.jsx)("br",{})," a user is logged in. It will respect Row Level Security (RLS) policies."]})]}),"authenticated"===o&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.VD,{}),(0,s.jsx)("div",{className:(0,l.cn)("py-5",r&&"px-5"),children:(0,s.jsx)(L,{})})]})]})},z=e=>{var t,n,c,u;let{serviceRoleLabel:h,variant:m="regular",align:p="end"}=e,x=(0,d.fN)(),[g,f]=(0,i.useState)(!1),v=null!==(u=null!==(c=null===(t=x.role)||void 0===t?void 0:t.role)&&void 0!==c?c:h)&&void 0!==u?u:"service role";return(0,s.jsxs)(r.J2,{open:g,onOpenChange:f,modal:!1,children:[(0,s.jsx)(r.xo,{asChild:!0,children:(0,s.jsx)(a.z,{size:"tiny",type:"default",className:(0,l.cn)("h-[26px] pr-3 gap-0","connected-on-right"===m&&"rounded-r-none border-r-0","connected-on-left"===m&&"rounded-l-none border-l-0","connected-on-both"===m&&"rounded-none border-x-0"),children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("span",{className:"text-foreground-muted",children:"role"}),(0,s.jsx)("span",{children:v}),(null===(n=x.role)||void 0===n?void 0:n.type)==="postgrest"&&"authenticated"===x.role.role&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(T,{user:x.role.user}),(0,s.jsx)("span",{className:"text-xs text-foreground-lighter font-light",children:"aal2"===x.role.aal?"AAL2":"AAL1"})]}),(0,s.jsx)(o.Z,{className:"text-muted",strokeWidth:1,size:12})]})})}),(0,s.jsx)(r.yk,{className:"p-0 w-full overflow-hidden",side:"bottom",align:p,children:(0,s.jsx)(Z,{serviceRoleLabel:h})})]})};let T=e=>{var t,n,i;let{user:r}=e,a=(0,R.E$)(r),l=(0,R.Gf)(r,null!==(i=null!==(n=null!==(t=r.email)&&void 0!==t?t:r.phone)&&void 0!==n?n:r.id)&&void 0!==i?i:"Unknown");return(0,s.jsxs)("div",{className:"flex gap-1 items-center pl-0.5 pr-1.5 h-[21px] bg-surface-200 rounded-full overflow-hidden",children:[a?(0,s.jsx)("img",{className:"rounded-full w-[18px] h-[18px]",src:a,alt:l}):(0,s.jsx)("div",{className:"rounded-full w-[18px] h-[18px] bg-surface-100 border flex items-center justify-center text-light",children:(0,s.jsx)(c.Z,{size:12,strokeWidth:2})}),(0,s.jsx)("span",{className:"truncate max-w-[84px]",children:l})]})}},75951:function(e,t,n){"use strict";n.d(t,{B:function(){return o},F2:function(){return d},G2:function(){return m},LZ:function(){return p},Y4:function(){return l},_J:function(){return u},hk:function(){return c},nK:function(){return a},q_:function(){return h}});var s=n(63059),i=n(99248),r=n(28702);let a=660,l=50,o=20,c={...i.S,INIT_READ_REPLICA:"INIT_READ_REPLICA",INIT_READ_REPLICA_FAILED:"INIT_READ_REPLICA_FAILED"},d={SOUTHEAST_ASIA:[103.8,1.37],NORTHEAST_ASIA:[139.42,35.41],NORTHEAST_ASIA_2:[126.98,37.56],CENTRAL_CANADA:[-73.6,45.5],WEST_US:[-121.96,37.35],EAST_US:[-78.45,38.13],WEST_EU:[-8,53],WEST_EU_2:[-.1,51],CENTRAL_EU:[8,50],SOUTH_ASIA:[72.88,19.08],OCEANIA:[151.2,-33.86],SOUTH_AMERICA:[-46.38,-23.34]},u={SOUTHEAST_ASIA:[103.8,1.37]},h=Object.keys(r.Wp).map(e=>({key:e,name:null===r.Wp||void 0===r.Wp?void 0:r.Wp[e].displayName,region:null===r.Wp||void 0===r.Wp?void 0:r.Wp[e].code,coordinates:d[e]})).filter(e=>void 0!==e.coordinates),m={[s.Vb.Requested]:"Requesting replica instance",[s.Vb.Started]:"Launching replica instance",[s.Vb.LaunchedReadReplicaInstance]:"Initiating replica setup",[s.Vb.InitiatedReadReplicaSetup]:"Downloading base backup",[s.Vb.DownloadedBaseBackup]:"Replaying WAL archives",[s.Vb.ReplayedWalArchives]:"Completing set up",[s.Vb.CompletedReadReplicaSetup]:"Completed"},p={[s.Bm.ReadReplicaInstanceLaunchFailed]:"Failed to launch replica",[s.Bm.InitiateReadReplicaSetupFailed]:"Failed to initiate replica",[s.Bm.DownloadBaseBackupFailed]:"Failed to download backup",[s.Bm.ReplayWalArchivesFailed]:"Failed to replay WAL archives",[s.Bm.CompleteReadReplicaSetupFailed]:"Failed to set up replica"}},79735:function(e,t,n){"use strict";var s=n(52322),i=n(2784),r=n(28879),a=n.n(r),l=n(17699),o=n(52576),c=n(83039),d=n(504),u=n(27118),h=n(13050),m=n(31174),p=n(98578),x=n(32854),g=n(51428),f=n(74244),v=n(27029);t.Z=e=>{var t,n,r;let{data:_,yAxisKey:j,xAxisKey:b,format:y,customDateFormat:N=x.EE.FULL,title:w,highlightedValue:k,highlightedLabel:E,displayDateInUtc:S,minimalHeader:C,valuePrecision:q,className:A="",size:R="normal",emptyStateMessage:L,onBarClick:I,showLegend:D=!1,xAxisIsDate:Z=!0,XAxisProps:z,YAxisProps:T,showGrid:F=!1}=e,{Container:O}=(0,f.D3)(R),[M,W]=(0,i.useState)(null),P=z||{interval:_.length-2,angle:0,tick:!1},U=T||{tickFormatter:e=>(0,f.V2)(e,q),tick:!1,width:0},K=e=>S?a()(e).utc():a()(e),V=function(){if(!Z){var e;return M?null===(e=_[M])||void 0===e?void 0:e[b]:E}return null!==M&&_&&void 0!==_[M]&&K(_[M][b]).format(N)||E}(),G=null!==M?null===(t=_[M])||void 0===t?void 0:t[j]:k;return 0===_.length?(0,s.jsx)(v.Z,{message:L,description:"It may take up to 24 hours for data to show",size:R,className:A,attribute:w,format:y}):(0,s.jsxs)("div",{className:["flex flex-col gap-y-3",A].join(" "),children:[(0,s.jsx)(g.Z,{title:w,format:y,customDateFormat:N,highlightedValue:"number"==typeof G?(0,f.V2)(G,q):G,highlightedLabel:V,minimalHeader:C}),(0,s.jsx)(O,{children:(0,s.jsxs)(l.v,{data:_,className:"overflow-visible",onMouseMove:e=>{e.activeTooltipIndex!==M&&W(e.activeTooltipIndex)},onMouseLeave:()=>W(null),onClick:e=>{var t,n;let s=null==e?void 0:null===(n=e.activePayload)||void 0===n?void 0:null===(t=n[0])||void 0===t?void 0:t.payload;I&&I(s,e)},children:[D&&(0,s.jsx)(o.D,{}),F&&(0,s.jsx)(c.q,{stroke:x.ZE.AXIS}),(0,i.createElement)(d.B,{...U,axisLine:{stroke:x.ZE.AXIS},tickLine:{stroke:x.ZE.AXIS},key:j}),(0,i.createElement)(u.K,{...P,axisLine:{stroke:x.ZE.AXIS},tickLine:{stroke:x.ZE.AXIS},key:b}),(0,s.jsx)(h.u,{content:()=>null}),(0,s.jsx)(m.$,{dataKey:j,fill:x.ZE.GREEN_1,animationDuration:300,maxBarSize:48,children:null==_?void 0:_.map((e,t)=>(0,s.jsx)(p.b,{className:"transition-all duration-300 ".concat(I?"cursor-pointer":""),fill:M===t||null===M?x.ZE.GREEN_1:x.ZE.GREEN_2,enableBackground:12},"cell-".concat(t)))})]})}),_&&(0,s.jsxs)("div",{className:"text-foreground-lighter -mt-9 flex items-center justify-between text-xs",children:[(0,s.jsx)("span",{children:Z?K(_[0][b]).format(N):_[0][b]}),(0,s.jsx)("span",{children:Z?K(null===(n=_[(null==_?void 0:_.length)-1])||void 0===n?void 0:n[b]).format(N):null===(r=_[(null==_?void 0:_.length)-1])||void 0===r?void 0:r[b]})]})]})}},51428:function(e,t,n){"use strict";var s=n(52322);t.Z=e=>{let{format:t,highlightedValue:n,highlightedLabel:i,title:r,minimalHeader:a=!1}=e,l=(0,s.jsx)("h3",{className:"text-foreground-lighter "+(a?"text-xs":"text-sm"),children:r}),o=(0,s.jsxs)("h5",{className:"text-foreground text-xl font-normal ".concat(a?"text-base":"text-2xl"),children:[void 0!==n&&String(n),"seconds"===t?" ":"",(0,s.jsx)("span",{className:"text-lg",children:"function"==typeof t?t(n):t})]}),c=(0,s.jsx)("h5",{className:"text-foreground-lighter text-xs",children:i});return a?(0,s.jsxs)("div",{className:"flex flex-row items-center gap-x-4",style:{minHeight:"1.8rem"},children:[r&&l,(0,s.jsxs)("div",{className:"flex flex-row items-baseline gap-x-2",children:[void 0!==n&&o,c]})]}):(0,s.jsxs)("div",{className:"h-16",children:[r&&l,void 0!==n&&o,c]})}},32854:function(e,t,n){"use strict";var s,i;n.d(t,{EE:function(){return s},FK:function(){return a},Ki:function(){return l},ZE:function(){return r}});let r={TICK:"hsl(var(--background-overlay-hover))",AXIS:"hsl(var(--background-overlay-hover))",GREEN_1:"hsl(var(--brand-default))",GREEN_2:"hsl(var(--brand-500))"},a=e=>e.map(e=>{var t;let n=null!==(t=({slate:11})[e])&&void 0!==t?t:9;return{lighter:"var(--colors-".concat(e).concat(n-1,")"),base:"var(--colors-".concat(e).concat(n,")"),darker:"var(--colors-".concat(e).concat(n+1,")")}}),l=["brand","slate","blue","yellow","indigo"];(i=s||(s={})).FULL="MMM D, YYYY, hh:mma",i.DATE_ONLY="MMM D, YYYY"},74244:function(e,t,n){"use strict";n.d(t,{Bh:function(){return m},D3:function(){return x},Hx:function(){return p},V2:function(){return u},ww:function(){return g}});var s=n(52322),i=n(28879),r=n.n(i),a=n(10264),l=n.n(a),o=n(2784),c=n(92696),d=n(32854);r().extend(l());let u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return h(e)?m(e,t):e.toLocaleString()},h=e=>String(e).includes("."),m=(e,t)=>{if(!h(e))return e.toLocaleString()+"."+"0".repeat(t);{let[n,s]=String(e).split(".");return Number(n).toLocaleString()+"."+s.slice(0,t)}},p=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.EE.FULL,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?r().utc(e).format(t):r()(e).format(t)},x=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"normal",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{tiny:76,small:96,normal:160,large:280},n=t[e];return{Container:(0,o.useMemo)(()=>e=>{let{children:t}=e;return(0,s.jsx)(c.h,{height:n,minHeight:n,width:"100%",children:t})},[e]),minHeight:n}},g=e=>{let{data:t,xAxisKey:n,yAxisKey:s,stackKey:i,variant:r="values"}=e,a=(0,o.useMemo)(()=>t?Object.entries(t.reduce((e,t)=>{let r=t[n],a=t[s],l=t[i];return e[r]||(e[r]={}),e[r][l]=a,e},{})).map(e=>{let[t,s]=e;return{...s,[n]:Number.isNaN(Number(t))?t:Number(t)}}):[],[JSON.stringify(t)]),l=(0,o.useMemo)(()=>Object.keys(a[0]||{}).filter(e=>e!==n&&e!==s).sort(),[JSON.stringify(a[0]||{})]),c=(0,o.useMemo)(()=>{if("percentages"===r)return a.map(e=>{let t=Object.entries(e),n=t.filter(e=>{let[t,n]=e;return l.includes(t)}).reduce((e,t)=>{let[n,s]=t;return e+s},0);return t.reduce((e,t)=>{let[s,i]=t;return l.includes(s)?{...e,[s]:0!==i?i/n:0}:{...e,[s]:i}},{})})},[JSON.stringify(a)]);return{dataKeys:l,stackedData:a,percentagesStackedData:c}}},27029:function(e,t,n){"use strict";var s=n(52322),i=n(69767),r=n(54383),a=n(51428),l=n(74244);t.Z=e=>{let{attribute:t,message:n="No data to show",description:o,format:c,className:d="",size:u}=e,{minHeight:h}=(0,l.D3)(u);return(0,s.jsxs)("div",{children:[void 0!==t&&(0,s.jsx)(a.Z,{title:t,format:c,highlightedValue:0}),(0,s.jsxs)("div",{className:(0,r.cn)("border-control flex flex-grow w-full flex-col items-center justify-center space-y-2 border border-dashed text-center",d),style:{minHeight:h+20},children:[(0,s.jsx)(i.Z,{size:20,className:"text-border-stronger"}),(0,s.jsxs)("div",{className:"px-1",children:[(0,s.jsx)("p",{className:"text-foreground-light text-xs",children:n}),o&&(0,s.jsx)("p",{className:"text-foreground-lighter text-xs",children:o})]})]})]})}},82663:function(e,t,n){"use strict";var s=n(52322),i=n(79534),r=n(98537),a=n.n(r),l=n(34291),o=n.n(l),c=n(2784),d=n(80435),u=n(82955),h=n(54383),m=n(25733),p=n(98280);t.Z=e=>{let{id:t,language:n,defaultValue:r,autofocus:l=!0,isReadOnly:x=!1,hideLineNumbers:g=!1,onInputChange:f=o(),onInputRun:v=o(),className:_,loading:j,options:b,value:y,placeholder:N,disableTabToUsePlaceholder:w=!1}=e,k=(0,c.useRef)(),E=(0,c.useRef)(),S=(0,c.useRef)(),C=void 0!==N&&0===(null!=y?y:"").trim().length,[q,A]=(0,c.useState)(C),R=async(e,t)=>{E.current=e,S.current=t,(0,p.$)(e),k.current=e.createContextKey("hasValue",!1),k.current.set(void 0!==y&&y.trim().length>0),A(C),w||e.addCommand(t.KeyCode.Tab,()=>{e.executeEdits("source",[{identifier:"add-placeholder",range:new t.Range(1,1,1,1),text:(null!=N?N:"").split("\n\n").join("\n").replaceAll("*","").replaceAll("&nbsp;","")}])},"!hasValue"),e.addAction({id:"supabase",label:"Run Query",keybindings:[t.KeyMod.CtrlCmd+t.KeyCode.Enter],contextMenuGroupId:"operation",contextMenuOrder:0,run:async()=>{var e,t;v((null==E?void 0:E.current).getModel().getValueInRange(null==E?void 0:null===(e=E.current)||void 0===e?void 0:e.getSelection())||(null==E?void 0:null===(t=E.current)||void 0===t?void 0:t.getValue()))}});let n=e.getModel();if(n){let t=n.getPositionAt((null!=y?y:"").length);e.setPosition(t)}await (0,u.Vs)(500),l&&(null==e||e.focus())},L=a()({tabSize:2,fontSize:13,readOnly:x,minimap:{enabled:!1},wordWrap:"on",fixedOverflowWidgets:!0,contextmenu:!0,lineNumbers:g?"off":void 0,glyphMargin:!g&&void 0,lineNumbersMinChars:g?0:4,folding:!g&&void 0,scrollBeyondLastLine:!1},b);return(0,c.useEffect)(()=>{A(C)},[C]),(0,c.useEffect)(()=>{if(!w&&void 0!==E.current&&void 0!==S.current){let e=E.current,t=S.current;e.addCommand(t.KeyCode.Tab,()=>{e.executeEdits("source",[{identifier:"add-placeholder",range:new t.Range(1,1,1,1),text:(null!=N?N:"  ").split("\n\n").join("\n").replaceAll("*","").replaceAll("&nbsp;","")}])},"!hasValue")}},[N,w]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.default,{path:t,theme:"supabase",className:(0,h.cn)(_,"monaco-editor"),value:null!=y?y:void 0,language:n,defaultValue:null!=r?r:void 0,loading:j||(0,s.jsx)(m.Z,{}),options:L,onMount:R,onChange:e=>{k.current.set((null!=e?e:"").length>0),A(!e),f(e)}}),void 0!==N&&(0,s.jsx)("div",{className:(0,h.cn)("monaco-placeholder absolute top-[3px] left-[57px] text-sm pointer-events-none font-mono","[&>div>p]:text-foreground-lighter [&>div>p]:!m-0 tracking-tighter",q?"block":"hidden"),children:(0,s.jsx)(d.U,{content:N})})]})}},57663:function(e,t,n){"use strict";var s=n(87612);class i{hasNext(){return this.lineNumber>=0||this.offset>=0}isFowardDQuote(){return!!this.hasForward()&&34===this.peekForward()}isNextDQuote(){return!!this.hasNext()&&34===this.peekNext()}isNextPeriod(){return!!this.hasNext()&&46===this.peekNext()}peekNext(){return this.offset<0?this.lineNumber>0?10:0:this._line.charCodeAt(this.offset)}hasForward(){return this.lineNumber<this._lines.length||this.offset<this._line.length}peekForward(){return this.offset===this._line.length?this.lineNumber===this._lines.length?0:10:this._line.charCodeAt(this.offset+1)}next(){if(this.offset<0)return this.lineNumber>0?(this.lineNumber--,this._line=this._lines[this.lineNumber],this.offset=this._line.length-1,10):(this.lineNumber=-1,0);let e=this._line.charCodeAt(this.offset);return this.offset--,e}readArguments(){let e=0,t=0,n=0,s=0;for(;this.hasNext();){let i=this.next();switch(i){case 40:if(--e<0)return s;break;case 41:e++;break;case 123:n--;break;case 125:n++;break;case 91:t--;break;case 93:t++;break;case 34:case 39:for(;this.hasNext()&&i!==this.next(););break;case 44:!e&&!t&&!n&&s++}}return -1}readIdent(){let e=!1,t=!1,n="";for(;this.hasNext();){let s=this.peekNext();if(e&&!t&&!this._isIdentPart(s))break;if(s=this.next(),!e&&t&&34===s){e=!0;continue}if(e||32!==s&&9!==s&&10!=s){if(!e&&(34===s||this._isIdentPart(s)))e=!0,t=34===s,n=String.fromCharCode(s)+n;else if(e){if(t){if(0===s||(n=String.fromCharCode(s)+n,34===s))break}else n=String.fromCharCode(s)+n}}}return n}readIdents(e){let t=[];for(;e>0;){e--;let n=this.readIdent();if(!n||(t.push(n),!this.isNextPeriod()))break}return t.reverse()}_isIdentPart(e){return 95===e||e>=97&&e<=122||e>=65&&e<=90||e>=48&&e<=57}constructor(e,t,n){(0,s._)(this,"_line",void 0),(0,s._)(this,"_text",void 0),(0,s._)(this,"_lines",void 0),(0,s._)(this,"model",void 0),(0,s._)(this,"offset",void 0),(0,s._)(this,"lineNumber",void 0),this.model=e,this.offset=t,this.lineNumber=n,this._text=e.getValue(),this._lines=this._text.split(/\r?\n/g),this._line=this._lines[n]}}t.Z=i},37962:function(e,t,n){"use strict";var s=n(52322),i=n(99959),r=n(34291),a=n.n(r),l=n(45010),o=n(78232),c=n(76141),d=n(89404),u=n(39097),h=n.n(u),m=n(5632),p=n(2784),x=n(61786),g=n(32079),f=n(54383),v=n(90504),_=n(19869),j=n(2322),b=n(80435),y=n(75951),N=n(92575),w=n(89523),k=n(9109);t.Z=e=>{var t;let{variant:n="regular",additionalOptions:r=[],onSelectId:u=a()}=e,E=(0,m.useRouter)(),{ref:S}=(0,i.UO)(),[C,q]=(0,p.useState)(!1),A=(0,k.TF)(),R=A.selectedDatabaseId,{data:L,isLoading:I,isSuccess:D}=(0,N.bN)({projectRef:S}),Z=null!=L?L:[],z=Z.sort((e,t)=>e.inserted_at>t.inserted_at?1:0).sort(e=>e.identifier===S?-1:0),T=Z.find(e=>e.identifier===R),F=(0,w.f)(null!==(t=null==T?void 0:T.region)&&void 0!==t?t:""),O=(0,w.U)(null!=R?R:""),M=r.find(e=>e.id===R);return(0,s.jsxs)(x.J2,{open:C,onOpenChange:q,modal:!1,children:[(0,s.jsx)(x.xo,{asChild:!0,children:(0,s.jsx)("div",{className:"flex items-center space-x-2 cursor-pointer",children:(0,s.jsxs)(g.z,{type:"default",className:(0,f.cn)("pr-2","connected-on-right"===n&&"rounded-r-none","connected-on-left"===n&&"rounded-l-none border-l-0","connected-on-both"===n&&"rounded-none border-x-0"),icon:I&&(0,s.jsx)(l.Z,{className:"animate-spin"}),iconRight:(0,s.jsx)(o.Z,{className:"text-foreground-light",strokeWidth:2,size:12}),children:[(0,s.jsx)("span",{className:"text-foreground-muted mr-1",children:"source"}),M?(0,s.jsx)("span",{children:M.name}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"capitalize",children:I||(null==T?void 0:T.identifier)===S?"Primary database":"Read replica"})," ",D&&(null==T?void 0:T.identifier)!==S&&(0,s.jsxs)("span",{children:["(",F," - ",O,")"]})]})]})})}),(0,s.jsx)(x.yk,{className:"p-0 w-64",side:"bottom",align:"end",children:(0,s.jsx)(v.mY,{children:(0,s.jsxs)(v.e8,{children:[r.length>0&&(0,s.jsx)(v.fu,{className:"border-b",children:r.map(e=>(0,s.jsx)(v.di,{value:e.id,className:"cursor-pointer w-full",onSelect:()=>{A.setSelectedDatabaseId(e.id),q(!1),u(e.id)},onClick:()=>{A.setSelectedDatabaseId(e.id),q(!1),u(e.id)},children:(0,s.jsxs)("div",{className:"w-full flex items-center justify-between",children:[(0,s.jsx)("p",{children:e.name}),e.id===R&&(0,s.jsx)(c.Z,{size:14})]})},e.id))}),(0,s.jsx)(v.fu,{children:(0,s.jsx)(_.x,{className:(Z||[]).length>7?"h-[210px]":"",children:null==z?void 0:z.map(e=>{let t=(0,w.f)(e.region),n=(0,w.U)(e.identifier);if("ACTIVE_HEALTHY"!==e.status){let i=[y.hk.INIT_READ_REPLICA,y.hk.COMING_UP].includes(e.status)?"coming up":"not healthy";return(0,s.jsxs)(j.u,{children:[(0,s.jsx)(j.aJ,{asChild:!0,children:(0,s.jsx)("div",{className:"px-2 py-1.5 w-full flex items-center justify-between",children:(0,s.jsxs)("p",{className:"text-xs text-foreground-lighter",children:["Read replica (",t," - ",n,")"]})})}),(0,s.jsx)(j._v,{side:"right",className:"w-80",children:(0,s.jsx)(b.U,{className:"text-xs text-foreground",content:"Replica unable to accept requests as its ".concat(i,". [View infrastructure settings](/project/").concat(S,"/settings/infrastructure) for more information.")})})]},e.identifier)}return(0,s.jsx)(v.di,{value:e.identifier,className:"cursor-pointer w-full",onSelect:()=>{A.setSelectedDatabaseId(e.identifier),q(!1),u(e.identifier)},onClick:()=>{A.setSelectedDatabaseId(e.identifier),q(!1),u(e.identifier)},children:(0,s.jsxs)("div",{className:"w-full flex items-center justify-between",children:[(0,s.jsx)("p",{children:e.identifier===S?"Primary database":"Read replica (".concat(t," - ").concat(n,")")}),e.identifier===R&&(0,s.jsx)(c.Z,{size:16})]})},e.identifier)})})}),(0,s.jsx)(v.fu,{className:"border-t",children:(0,s.jsx)(v.di,{className:"cursor-pointer w-full",onSelect:()=>{q(!1),E.push("/project/".concat(S,"/settings/infrastructure"))},onClick:()=>q(!1),children:(0,s.jsxs)(h(),{href:"/project/".concat(S,"/settings/infrastructure"),onClick:()=>q(!1),className:"w-full flex items-center gap-2",children:[(0,s.jsx)(d.Z,{size:14,strokeWidth:1.5}),(0,s.jsx)("p",{children:"Create a new read replica"})]})})})]})})})]})}},55600:function(e,t,n){"use strict";n.d(t,{x:function(){return r}});var s=n(52322),i=n(54383);let r=e=>{let{children:t,className:n}=e;return(0,s.jsx)("div",{className:(0,i.cn)("flex min-h-9 h-9 overflow-hidden items-center px-2 w-full border-t",n),children:t})}},8334:function(e,t,n){"use strict";n.d(t,{V:function(){return o}});var s=n(48228),i=n(56958),r=n(88354),a=n(99248);async function l(e){let{errorMessage:t,sql:n,entityDefinitions:s}=e,i=await (0,r.v_)(a.GW+"/api/ai/sql/debug",{errorMessage:t,sql:n,entityDefinitions:s});if(!(0,r.d8)(i))throw i.error;return i}let o=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.D)(e=>l(e),{async onSuccess(t,n,s){await (null==e?void 0:e(t,n,s))},async onError(e,n,s){void 0===t?i.Am.error("Failed to debug SQL: ".concat(e.message)):t(e,n,s)},...n})}},38530:function(e,t,n){"use strict";n.d(t,{RT:function(){return a},xY:function(){return o}});var s=n(36492),i=n(31696),r=n(7161);let a=20;async function l(e,t){let{projectRef:n,page:s=1,keywords:r="",filter:l}=e;if(!n)throw Error("Project ref is required");let o={limit:a.toString(),offset:((s-1)*10).toString(),keywords:r};l&&(o.verified=l);let{data:c,error:d}=await (0,i.U2)("/platform/auth/{ref}/users",{params:{path:{ref:n},query:o},signal:t});return d&&(0,i.S3)(d),c}let o=function(e){let{projectRef:t,page:n,keywords:i,filter:a,connectionString:o}=e,{enabled:c=!0,...d}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.a)(r.o.users(t,{page:n,keywords:i,filter:a}),e=>{let{signal:s}=e;return l({projectRef:t,page:n,keywords:i,filter:a,connectionString:o},s)},{enabled:c&&void 0!==t,...d})}},7509:function(e,t,n){"use strict";n.d(t,{R:function(){return a}});var s=n(98402),i=n(18592);let r=s.Z.functions.list(),a=function(e){let{projectRef:t,connectionString:n}=e,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,i.cp)({projectRef:t,connectionString:n,sql:r.sql,queryKey:["functions-list"]},{select(e){var t;return null!==(t=null==e?void 0:e.result)&&void 0!==t?t:[]},...s})}},17055:function(e,t,n){"use strict";n.d(t,{u:function(){return l}});var s=n(18592),i=n(68871),r=n(22329);let a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return"\n".concat(i.k,"\n\nwith records as (\n  select\n    c.oid::int8 as \"id\",\n    case c.relkind\n      when 'r' then pg_temp.pg_get_tabledef(\n        concat(nc.nspname),\n        concat(c.relname),\n        false,\n        'FKEYS_INTERNAL',\n        'NO_TRIGGERS'\n      )\n      when 'v' then concat(\n        'create view ', concat(nc.nspname, '.', c.relname), ' as', \n        pg_get_viewdef(concat(nc.nspname, '.', c.relname), true)\n      )\n      when 'm' then concat(\n        'create materialized view ', concat(nc.nspname, '.', c.relname), ' as',\n        pg_get_viewdef(concat(nc.nspname, '.', c.relname), true)\n      )\n      when 'f' then pg_temp.pg_get_tabledef(\n        concat(nc.nspname),\n        concat(c.relname),\n        false,\n        'FKEYS_INTERNAL',\n        'NO_TRIGGERS'\n      )\n      when 'p' then pg_temp.pg_get_tabledef(\n        concat(nc.nspname),\n        concat(c.relname),\n        false,\n        'FKEYS_INTERNAL',\n        'NO_TRIGGERS'\n      )\n    end as \"sql\"\n  from\n    pg_namespace nc\n    join pg_class c on nc.oid = c.relnamespace\n  where\n    c.relkind in ('r', 'v', 'm', 'f', 'p')\n    and not pg_is_other_temp_schema(nc.oid)\n    and (\n      pg_has_role(c.relowner, 'USAGE')\n      or has_table_privilege(\n        c.oid,\n        'SELECT, INSERT, UPDATE, DELETE, TRUNCATE, REFERENCES, TRIGGER'\n      )\n      or has_any_column_privilege(c.oid, 'SELECT, INSERT, UPDATE, REFERENCES')\n    )\n    and nc.nspname IN (").concat(e.map(e=>"'".concat(e,"'")).join(", "),")\n  order by c.relname asc\n  limit ").concat(t,"\n  offset 0\n)\nselect\n  jsonb_build_object(\n    'definitions', coalesce(jsonb_agg(\n      jsonb_build_object(\n        'id', r.id,\n        'sql', r.sql\n      )\n    ), '[]'::jsonb)\n  ) \"data\"\nfrom records r;\n  ").trim()},l=function(e){let{schemas:t,limit:n,projectRef:i,connectionString:l}=e,{enabled:o=!0,...c}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.cp)({projectRef:i,connectionString:l,sql:a(t,n),queryKey:r.A.entityDefinitions(i,t)},{select:e=>e.result[0].data.definitions,enabled:o&&t.length>0,...c})}},39338:function(e,t,n){"use strict";n.d(t,{K:function(){return r}});var s=n(18592);let i=(e,t)=>{let n=[];e&&n.push("tablename = '".concat(e,"'")),t&&n.push("schemaname = '".concat(t,"'"));let s=n.length>0?"WHERE ".concat(n.join(" AND ")):"";return"\n  \n  SELECT\n    tbl.schemaname,\n    tbl.tablename,\n    tbl.quoted_name,\n    tbl.is_table,\n    json_agg(a) as columns\n  FROM\n    (\n      SELECT\n        n.nspname as schemaname,\n        c.relname as tablename,\n        (quote_ident(n.nspname) || '.' || quote_ident(c.relname)) as quoted_name,\n        true as is_table\n      FROM\n        pg_catalog.pg_class c\n        JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace\n      WHERE\n        c.relkind = 'r'\n        AND n.nspname not in ('information_schema', 'pg_catalog', 'pg_toast')\n        AND n.nspname not like 'pg_temp_%'\n        AND n.nspname not like 'pg_toast_temp_%'\n        AND has_schema_privilege(n.oid, 'USAGE') = true\n        AND has_table_privilege(quote_ident(n.nspname) || '.' || quote_ident(c.relname), 'SELECT, INSERT, UPDATE, DELETE, TRUNCATE, REFERENCES, TRIGGER') = true\n      union all\n      SELECT\n        n.nspname as schemaname,\n        c.relname as tablename,\n        (quote_ident(n.nspname) || '.' || quote_ident(c.relname)) as quoted_name,\n        false as is_table\n      FROM\n        pg_catalog.pg_class c\n        JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace\n      WHERE\n        c.relkind in ('v', 'm')\n        AND n.nspname not in ('information_schema', 'pg_catalog', 'pg_toast')\n        AND n.nspname not like 'pg_temp_%'\n        AND n.nspname not like 'pg_toast_temp_%'\n        AND has_schema_privilege(n.oid, 'USAGE') = true\n        AND has_table_privilege(quote_ident(n.nspname) || '.' || quote_ident(c.relname), 'SELECT, INSERT, UPDATE, DELETE, TRUNCATE, REFERENCES, TRIGGER') = true\n    ) as tbl\n    LEFT JOIN (\n      SELECT\n        attrelid,\n        attname,\n        format_type(atttypid, atttypmod) as data_type,\n        attnum,\n        attisdropped\n      FROM\n        pg_attribute\n    ) as a ON (\n      a.attrelid = tbl.quoted_name::regclass\n      AND a.attnum > 0\n      AND NOT a.attisdropped\n      AND has_column_privilege(tbl.quoted_name, a.attname, 'SELECT, INSERT, UPDATE, REFERENCES')\n    )\n  ".concat(s,"\n  GROUP BY schemaname, tablename, quoted_name, is_table;\n").trim()},r=function(e){let{projectRef:t,connectionString:n,table:r,schema:a}=e,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.cp)({projectRef:t,connectionString:n,sql:i(r,a),queryKey:["table-columns",a,r]},l)}},6654:function(e,t,n){"use strict";n.d(t,{k:function(){return c}});var s=n(85945),i=n(48228),r=n(56958),a=n(31696),l=n(91160);async function o(e){let{slug:t,name:n,billing_email:s,opt_in_tags:i}=e,r={};n&&(r.name=n),s&&(r.billing_email=s),i&&(r.opt_in_tags=i);let{data:l,error:o}=await (0,a.r$)("/platform/organizations/{slug}",{params:{path:{slug:t}},body:r});return o&&(0,a.S3)(o),l}let c=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,s.NL)();return(0,i.D)(e=>o(e),{async onSuccess(t,n,s){await a.invalidateQueries(l.O.list()),await (null==e?void 0:e(t,n,s))},async onError(e,n,s){void 0===t?r.Am.error("Failed to update organization: ".concat(e.message)):t(e,n,s)},...n})}},89523:function(e,t,n){"use strict";n.d(t,{U:function(){return a},f:function(){return l}});var s=n(75951),i=n(56974),r=n.n(i);let a=e=>{var t;return r()(null!==(t=e.split("-"))&&void 0!==t?t:[])},l=e=>{var t,n;return null===(t=r()(null===(n=s.q_.find(t=>t.region===e))||void 0===n?void 0:n.name.split("(")))||void 0===t?void 0:t.split(")")[0]}},30120:function(e,t,n){"use strict";n.d(t,{r:function(){return a}});var s=n(48228),i=n(56958),r=n(18592);let a=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.D)(e=>(0,r.Rj)(e),{async onSuccess(t,n,s){await (null==e?void 0:e(t,n,s))},async onError(e,n,s){void 0===t?i.Am.error("Failed to execute SQL: ".concat(e.message)):t(e,n,s)},...n})}},49574:function(e,t,n){"use strict";n.d(t,{X:function(){return l},x:function(){return a}});var s=n(48228),i=n(88354),r=n(99248);async function a(e,t){let{projectRef:n,connectionString:s,sql:a}=e,l=new Headers;s&&l.set("x-connection-encrypted",s);let o=await (0,i.v_)("".concat(r.T5,"/pg-meta/").concat(n,"/query/format"),{query:a},{headers:Object.fromEntries(l),signal:t});if(o.error)throw o.error;return{result:o}}let l=function(){let{onSuccess:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.D)(e=>a(e),{async onSuccess(t,n,s){await (null==e?void 0:e(t,n,s))},...t})}},84602:function(e,t,n){"use strict";n.d(t,{aL:function(){return a},D9:function(){return l}});var s=n(2784),i=n(11886),r=n.n(i);function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],[i,a]=(0,s.useState)(),l=s=>{if(!e||r()(t,s.target.nodeName)||r()(n,s.target.className))return;let i=s.metaKey&&s.shiftKey?"Command+Shift+".concat(s.key):s.metaKey?"Command+".concat(s.key):s.shiftKey&&"Enter"===s.key?"Shift+".concat(s.key):s.ctrlKey&&s.key?"Control+".concat(s.key):s.key;e[i]&&(i.includes("+")?(s.preventDefault(),e[i](s),a(null)):(a(s.key),s.preventDefault()))},o=t=>{e&&e[t.key]&&i===t.key&&(t.preventDefault(),e[t.key](t),a(null))};(0,s.useEffect)(()=>(document.body.addEventListener("keydown",l),document.body.addEventListener("keyup",o),()=>{document.body.removeEventListener("keydown",l),document.body.removeEventListener("keyup",o)}))}function l(e){let t=(0,s.useRef)();return(0,s.useEffect)(()=>{t.current=e}),t.current}n(52322),n(48090),n(82955)},37700:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return tW}});var s=n(52322),i=n(79534),r=n(5632),a=n(2784),l=n(93885),o=n(85945),c=n(76803),d=n(45010),u=n(20670),h=n(25237),m=n.n(h),p=n(56958),x=n(82784),g=n(99959),f=n(55600),v=n(8334),_=n(99430),j=n(17055),b=n(93276),y=n(92575),N=n(30120),w=n(49574),k=n(93463),E=n(23770),S=n(22150),C=n(78696),q=n(89823),A=n(26211),R=n(75939),L=n(99248),I=n(82955),D=n(74067),Z=n(35432),z=n(28020),T=n(16289),F=n(9109),O=n(83537),M=n(2670),W=n(24413),P=n(79983),U=n(54383),K=n(54849),V=n(2322),G=n(34503),Q=n(32079),B=n(73831),H=n(34750),Y=n(75746),X=n(82137),J=e=>{let{children:t,delay:n=300,onClickSettings:i}=e;(0,q.l)();let r=(0,S.C)(),[l]=(0,E.l)("supabase_sql-editor-ai-schema",!0),[o,d]=(0,a.useState)(!1),[u]=(0,E.l)("supabase_sql-editor-ai-query-count",0),h=(r||!L.Qy)&&l,[m,p]=(0,E.l)("supabase_sql-editor-ai-schema-suggestion-dismissed",!1);return(0,a.useEffect)(()=>{let e=window.setTimeout(()=>{d(!0)},n);return()=>window.clearTimeout(e)}),(0,s.jsxs)(Y.fC,{open:o&&!h&&u>=3&&!m,children:[(0,s.jsx)(Y.ee,{asChild:!0,children:t}),(0,s.jsx)(Y.h_,{children:(0,s.jsx)(Y.VY,{side:"bottom",sideOffset:5,children:(0,s.jsxs)(c.E.div,{variants:{visible:{opacity:1,y:0},hidden:{opacity:0,y:-10}},initial:"hidden",animate:"visible",children:[(0,s.jsx)(Y.Eh,{className:"fill-background-surface-300"}),(0,s.jsxs)("div",{className:"flex flex-col gap-2 border border-default rounded-md p-4 bg-surface-100 shadow-xl",children:[(0,s.jsxs)("div",{className:"flex flex-row gap-4 max-w-sm xl:max-w-xl xl:items-center",children:[(0,s.jsx)(X.Z,{size:18}),(0,s.jsx)("p",{className:"text-sm",children:"Generate more relevant queries by including database metadata in your requests."})]}),(0,s.jsxs)("div",{className:"flex flex-row gap-2 justify-end",children:[(0,s.jsx)(Q.z,{type:"default",onClick:()=>{p(!0)},children:"Dismiss"}),(0,s.jsx)(Q.z,{onClick:()=>{p(!0),null==i||i()},children:"Open settings"})]})]})]})})})]})},$=n(59491),ee=n(27533),et=n(60417),en=n.n(et),es=n(56974),ei=n.n(es),er=n(8040),ea=n(6654),el=n(87175),eo=n(26250),ec=n(95492),ed=n(37970),eu=n(71381),eh=n(74138),em=n(28043),ep=n(28879),ex=n.n(ep),eg=n(34291),ef=n.n(eg),ev=n(96577),e_=n.n(ev),ej=n(14048),eb=n(12188),ey=n(81076),eN=n(73071),ew=n(18094),ek=n(76141),eE=n(94299),eS=n(58898),eC=n(14706);let eq=e=>{let{onDiff:t,children:n,className:i}=e,[l,o]=(0,a.useState)(!1),c=(0,r.useRouter)(),d=(0,g.Mk)();(0,a.useEffect)(()=>{if(!l)return;let e=setTimeout(()=>o(!1),2e3);return()=>clearTimeout(e)},[l]);let u=(n||[""])[0];try{u=(0,x.WU)(u,{language:"postgresql",keywordCase:"upper"})}catch(e){}return 0===u.length?null:(0,s.jsxs)("pre",{className:(0,U.cn)("rounded-md relative group",i),children:[(0,s.jsx)(eS.d,{value:u,language:"sql",className:(0,U.cn)("!bg-transparent !py-3 !px-3.5 prose dark:prose-dark","[&>code]:m-0 [&>code>span]:flex [&>code>span]:flex-wrap"),hideCopy:!0,hideLineNumbers:!0}),(0,s.jsxs)("div",{className:"absolute top-2 right-2 bg-surface-100 border-muted border rounded-lg h-[28px] hidden group-hover:block",children:[(0,s.jsxs)(V.u,{children:[(0,s.jsx)(V.aJ,{asChild:!0,children:(0,s.jsx)(Q.z,{type:"text",size:"tiny",onClick:()=>{t(eC.U.Addition,u),z.Z.sendEvent({category:"sql_editor_ai_assistant",action:"ai_suggestion_inserted",label:"sql-editor-ai-assistant"},d,c)},children:(0,s.jsx)(ew.ec,{className:"h-4 w-4 text-foreground-light",strokeWidth:1.5})})}),(0,s.jsx)(V._v,{side:"bottom",className:"font-sans",children:"Insert code"})]}),(0,s.jsxs)(V.u,{children:[(0,s.jsx)(V.aJ,{asChild:!0,children:(0,s.jsx)(Q.z,{type:"text",size:"tiny",onClick:()=>{t(eC.U.Modification,u),z.Z.sendEvent({category:"sql_editor_ai_assistant",action:"ai_suggestion_replaced",label:"sql-editor-ai-assistant"},d,c)},children:(0,s.jsx)(ew.nY,{className:"h-4 w-4 text-foreground-light",strokeWidth:1.5})})}),(0,s.jsx)(V._v,{side:"bottom",className:"font-sans",children:"Replace code"})]}),(0,s.jsxs)(V.u,{children:[(0,s.jsx)(V.aJ,{asChild:!0,children:(0,s.jsx)(Q.z,{type:"text",size:"tiny",onClick:()=>{var e;e=u,navigator.clipboard.writeText(e).then(),o(!0),z.Z.sendEvent({category:"sql_editor_ai_assistant",action:"ai_suggestion_copied",label:"sql-editor-ai-assistant"},d,c)},children:l?(0,s.jsx)(ek.Z,{size:16,className:"text-brand-600"}):(0,s.jsx)(eE.Z,{size:16,className:"text-foreground-light",strokeWidth:1.5})})}),(0,s.jsx)(V._v,{side:"bottom",className:"font-sans",children:"Copy code"})]})]})]})},eA=(0,a.memo)(function(e){let{name:t,role:n,content:i,createdAt:r,isDebug:l,isSelected:o=!1,onDiff:c=ef(),children:d,action:u=(0,s.jsx)(s.Fragment,{})}=e,{profile:h}=(0,D.Un)(),m=(0,a.useMemo)(()=>"assistant"===n?(0,s.jsx)(K.c,{loading:"Thinking..."===i,className:"[&>div>div]:border-black dark:[&>div>div]:border-white"}):(0,s.jsx)("div",{className:"relative border shadow-lg w-8 h-8 rounded-full overflow-hidden",children:(0,s.jsx)(e_(),{src:"https://github.com/".concat(null==h?void 0:h.username,".png")||0,width:30,height:30,alt:"avatar",className:"relative"})}),[i,null==h?void 0:h.username,n]);return i?(0,s.jsxs)("div",{className:"flex flex-col py-4 gap-4 border-t px-5 text-foreground-light text-sm",children:[(0,s.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[(0,s.jsxs)("div",{className:"flex flex-row gap-3 items-center",children:[m,(0,s.jsx)("span",{className:"text-sm",children:"assistant"===n?"Assistant":t||"You"}),r&&(0,s.jsx)("span",{className:"text-xs text-foreground-muted",children:ex()(r).fromNow()}),l&&(0,s.jsx)(ey.C,{variant:"warning",children:"Debug request"})]})," ",u]}),(0,s.jsx)(ej.D,{className:"gap-2.5 flex flex-col [&>*>code]:text-xs [&>*>*>code]:text-xs",remarkPlugins:[eb.Z],components:{...eN.t,pre:e=>(0,s.jsx)(eq,{onDiff:c,className:(0,U.cn)("transition",o?"[&>div>pre]:!border-stronger [&>div>pre]:!bg-surface-200":""),children:e.children[0].props.children})},children:i}),d]}):null}),eR=e=>{var t;let{selectedMessage:n,existingSql:i,onDiff:l,onClose:o,includeSchemaMetadata:c}=e,d=(0,A.V)(),u=(0,r.useRouter)(),{ref:h}=(0,g.UO)(),{profile:m}=(0,D.Un)(),[x,f]=(0,C.l)(null==d?void 0:d.ref),{data:v}=(0,j.u)({schemas:x,projectRef:null==d?void 0:d.ref,connectionString:null==d?void 0:d.connectionString},{enabled:c}),_=c?null==v?void 0:v.map(e=>e.sql.trim()):void 0,[b,y]=(0,a.useState)((0,eo.Z)()),{messages:N,append:w,isLoading:k}=(0,ee.RJ)({id:b,api:"".concat(L.GW,"/api/ai/sql/generate-v2"),body:{existingSql:i,entityDefinitions:_}}),S=(0,a.useMemo)(()=>[...N.map(e=>({...e,isDebug:!1}))].sort((e,t)=>{var n,s,i,r;return(null!==(i=null===(n=e.createdAt)||void 0===n?void 0:n.getTime())&&void 0!==i?i:0)-(null!==(r=null===(s=t.createdAt)||void 0===s?void 0:s.getTime())&&void 0!==r?r:0)||e.role.localeCompare(t.role)}),[N]),R=(0,a.useRef)(null),I=(0,g.Mk)(),[Z,T]=(0,a.useState)(""),F=(0,a.useRef)(null),O=en()([null==m?void 0:m.first_name,null==m?void 0:m.last_name]).join(" "),M=k&&(null===(t=ei()(S))||void 0===t?void 0:t.role)==="user";(0,a.useEffect)(()=>{!k&&(T(""),F.current&&F.current.focus()),setTimeout(()=>{R.current&&R.current.scrollIntoView({behavior:"smooth"})},k?100:500)},[k]);let W=(0,q.l)(),[P,G]=(0,a.useState)(!1),B=(0,el.Xo)($.KA.UPDATE,"organizations"),{mutate:H,isLoading:Y}=(0,ea.k)(),J=async()=>{var e;if(!B)return p.Am.error("You do not have the required permissions to update this organization");if(!(null==W?void 0:W.slug))return console.error("Organization slug is required");let t=null!==(e=null==W?void 0:W.opt_in_tags)&&void 0!==e?e:[],n=t.includes(L.PV.AI_SQL)?t:[...t,L.PV.AI_SQL];H({slug:null==W?void 0:W.slug,opt_in_tags:n},{onSuccess:()=>{p.Am.success("Successfully opted-in"),G(!1)}})},[et,es]=(0,E.l)(L.dA.SHOW_AI_NOT_OPTIMIZED_WARNING(h),!0),ep=W&&!c&&et;return(0,s.jsxs)("div",{className:"flex flex-col h-full border-l border-control",children:[(0,s.jsxs)("div",{className:(0,U.cn)("overflow-auto flex-1",0===S.length?"flex flex-col justify-between":""),children:[(0,s.jsx)(eA,{role:"assistant",content:"Hi".concat(O?" "+O:"",", how can I help you? I'm powered by AI, so surprises and mistakes are possible.\n        Make sure to verify any generated code or suggestions, and share feedback so that we can\n        learn and improve."),action:(0,s.jsxs)("div",{className:"flex gap-2",children:[S.length>0&&(0,s.jsx)(Q.z,{type:"warning",onClick:()=>y((0,eo.Z)()),children:"Clear history"}),(0,s.jsx)(Q.z,{type:"default",onClick:o,children:"Close Assistant"})]}),children:c?(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("span",{className:"inline-block text-lighter",children:"Include these schemas in your prompts:"}),(0,s.jsx)("div",{className:"flex flex-row justify-between space-x-2 mt-2",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(er.J,{disabled:!c,selectedSchemas:x,onSelectSchemas:f,label:c&&x.length>0?"".concat(x.length," schema").concat(x.length>1?"s":""," selected"):"No schemas selected"}),(0,s.jsxs)(V.u,{children:[(0,s.jsx)(V.aJ,{className:"flex items-center gap-2 text-lighter",children:(0,s.jsx)(X.Z,{className:"text-lighter w-4 h-4"})}),(0,s.jsx)(V._v,{className:"w-72",side:"right",children:"Select specific schemas to send with your queries. Supabase AI can use this data to improve the responses it shows you."})]})]})})]}):(0,s.jsx)(s.Fragment,{children:ep?(0,s.jsxs)(ec.bZ,{className:"[&>svg]:left-5 border-l-0 border-r-0 rounded-none -mx-5 px-5 w-[calc(100%+40px)]",children:[(0,s.jsx)(ed.aN,{}),(0,s.jsx)(ec.Cd,{children:"AI Assistant is not optimized"}),(0,s.jsx)(ec.X,{children:"You need to agree to share anonymous schema data with OpenAI for the best experience."}),(0,s.jsxs)("div",{className:"flex items-center gap-4 mt-6",children:[(0,s.jsx)(Q.z,{type:"default",onClick:()=>G(!0),children:"Update AI settings"}),(0,s.jsx)(Q.z,{type:"text",onClick:()=>es(!1),children:"Dismiss"})]})]}):(0,s.jsx)(s.Fragment,{})})},"zero"),S.map((e,t)=>{let i="user"===e.role&&S.slice(0,t).every(e=>"user"!==e.role);return(0,s.jsxs)(eA,{name:e.name,role:e.role,content:e.content,createdAt:new Date(e.createdAt||new Date).getTime(),isDebug:e.isDebug,isSelected:n===e.id,onDiff:(t,n)=>l({id:e.id,diffType:t,sql:n}),children:[i&&!c&&!ep&&(0,s.jsx)(ec.bZ,{children:(0,s.jsxs)(ec.X,{className:"flex flex-col gap-4",children:[(0,s.jsx)("span",{children:"Quick reminder that you're not sending project metadata with your queries. By opting into sending anonymous data, Supabase AI can improve the answers it shows you."}),(0,s.jsx)(Q.z,{type:"default",className:"w-fit",onClick:()=>G(!0),children:"Update AI settings"})]})}),i&&c&&0===x.length&&(0,s.jsx)(ec.bZ,{children:(0,s.jsx)(ec.X,{className:"flex flex-col gap-4",children:(0,s.jsx)("span",{children:"We recommend including the schemas for better answers by Supabase AI."})})})]},"message-".concat(e.id))}),M&&(0,s.jsx)(eA,{role:"assistant",content:"Thinking..."},"thinking"),(0,s.jsx)("div",{ref:R,className:"h-1"})]}),(0,s.jsx)("div",{className:"sticky p-5 flex-0 border-t",children:(0,s.jsx)(eu.P,{textAreaRef:F,loading:k,disabled:k,icon:(0,s.jsx)(K.c,{allowHoverEffect:!0,className:"[&>div>div]:border-black dark:[&>div>div]:border-white"}),placeholder:"Ask a question about your SQL query",value:Z,onValueChange:e=>T(e.target.value),onSubmit:e=>{e.preventDefault(),w({content:Z,role:"user",createdAt:new Date}),z.Z.sendEvent({category:"sql_editor_ai_assistant",action:"ai_suggestion_asked",label:"sql-editor-ai-assistant"},I,u)}})}),(0,s.jsxs)(eh.Z,{visible:P,size:"large",title:"Confirm sending anonymous data to OpenAI",confirmLabel:"Confirm",onCancel:()=>G(!1),onConfirm:J,loading:Y,children:[(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"By opting into sending anonymous data, Supabase AI can improve the answers it shows you. This is an organization-wide setting, and affects all projects in your organization."}),(0,s.jsx)(em.Z,{})]})]})};var eL=n(82401),eI=n(78232),eD=n(30789);let eZ=e=>{let{loading:t,selectedDiffType:n,onChangeDiffType:i,onAccept:r,onCancel:a}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(Q.z,{className:"rounded-r-none",type:"primary",size:"tiny",icon:t&&(0,s.jsx)(d.Z,{className:"animate-spin"}),iconRight:(0,s.jsx)(eL.Z,{size:12,strokeWidth:1.5}),onClick:r,children:(0,eD.re)(n)}),(0,s.jsxs)(G.h_,{children:[(0,s.jsx)(G.$F,{asChild:!0,children:(0,s.jsx)(Q.z,{type:"primary",className:"rounded-l-none border-l-0 px-[4px] py-[5px] flex",icon:(0,s.jsx)(eI.Z,{})})}),(0,s.jsx)(G.AW,{align:"end",side:"bottom",children:Object.values(eC.U).filter(e=>e!==n).map(e=>(0,s.jsx)(G.Xi,{onClick:()=>i(e),children:(0,s.jsx)("p",{children:(0,eD.IT)(e)})},e))})]})]}),(0,s.jsx)(Q.z,{type:"alternative",size:"tiny",className:"bg-brand-300 hover:bg-brand-400 dark:bg-brand-400 dark:hover:bg-brand-500 text-brand-600 group",iconRight:(0,s.jsx)("span",{className:"dark:text-brand-500 group-hover:text-brand-600",children:"ESC"}),onClick:a,children:"Discard"})]})};var ez=n(56902),eT=n(13800),eF=n(65467),eO=n(89828),eM=n(79735),eW=n(27029),eP=n(47433),eU=n(62949),eK=n(6112),eV=n(71640);let eG=(e,t)=>{var n;return(null==e?void 0:null===(n=e.rows)||void 0===n?void 0:n.length)?e.rows.reduce((e,n)=>{let s=e[e.length-1]||{};return[...e,{...n,[t.yKey]:(s[t.yKey]||0)+n[t.yKey]}]},[]):[]},eQ=["number","string","date"];function eB(e){let{results:t={rows:[]},config:n,onConfigChange:i}=e,r=(0,a.useMemo)(()=>Object.keys(t.rows[0]||{}).filter(e=>{let n=typeof t.rows[0][e];return eQ.includes(n)}),[t]),l=(0,a.useMemo)(()=>eG(t,n),[t,n]),o=n.cumulative?l:t.rows;if(!r.length)return(0,s.jsx)("div",{className:"p-2",children:(0,s.jsx)(eW.Z,{size:"normal",description:"Execute a query and configure the chart options."})});let c=(e=>{let t=o[0][e];return"number"==typeof t?"number":ex()(t).isValid()?"date":"string"})(n.xKey);return(0,s.jsx)(P.pO,{direction:"horizontal",className:"flex-grow h-full",children:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(P.ee,{className:"p-4 h-full",defaultSize:75,children:"bar"===n.type&&(0,s.jsx)(eM.Z,{showLegend:!0,size:"normal",xAxisIsDate:"date"===c,data:o,xAxisKey:n.xKey,yAxisKey:n.yKey,emptyStateMessage:"Execute a query and configure the chart options",showGrid:n.showGrid,XAxisProps:{angle:0,interval:0,hide:!n.showLabels,tickFormatter:e=>{let t=o[+e][n.xKey];return"date"===c?ex()(t).format("MMM D YYYY"):t}},YAxisProps:{tickFormatter:e=>e.toLocaleString(),label:(0,s.jsx)(s.Fragment,{}),hide:!n.showLabels}})}),(0,s.jsx)(P.Dp,{withHandle:!0}),(0,s.jsx)(P.ee,{defaultSize:25,minSize:15,className:"px-3 py-3 space-y-4",children:(0,s.jsxs)("form",{className:"grid gap-4",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center h-5",children:[(0,s.jsx)("h2",{className:"text-sm text-foreground-lighter",children:"Chart options"}),n.xKey&&n.yKey&&(0,s.jsx)(Q.z,{type:"text",onClick:()=>{let e=n.xKey,t=n.yKey;i({...n,xKey:t,yKey:e})},title:"Swap X and Y axis",icon:(0,s.jsx)(eP.Z,{size:"15",className:"text-foreground-lighter"}),children:"Flip"})]}),(0,s.jsxs)(eU.Ph,{value:n.xKey,onValueChange:e=>{i({...n,xKey:e})},children:[(0,s.jsxs)(eU.i4,{children:["X Axis ",n.xKey&&"- ".concat(n.xKey)]}),(0,s.jsx)(eU.Bw,{children:(0,s.jsx)(eU.DI,{children:r.map(e=>(0,s.jsx)(eU.Ql,{value:e,children:e},e))})})]}),(0,s.jsxs)(eU.Ph,{value:n.yKey,onValueChange:e=>{i({...n,yKey:e})},children:[(0,s.jsxs)(eU.i4,{children:["Y Axis ",n.yKey&&"- ".concat(n.yKey)]}),(0,s.jsx)(eU.Bw,{children:(0,s.jsx)(eU.DI,{children:r.map(e=>(0,s.jsx)(eU.Ql,{value:e,children:e},e))})})]}),(0,s.jsxs)("div",{className:"*:flex *:gap-2 *:items-center grid gap-2 *:text-foreground-light *:p-1.5 *:pl-0",children:[(0,s.jsxs)(eK._,{className:"",htmlFor:"cumulative",children:[(0,s.jsx)(eV.X,{id:"cumulative",name:"cumulative",checked:n.cumulative,onClick:()=>i({...n,cumulative:!n.cumulative})}),"Cumulative"]}),(0,s.jsxs)(eK._,{htmlFor:"showLabels",children:[(0,s.jsx)(eV.X,{id:"showLabels",name:"showLabels",checked:n.showLabels,onClick:()=>i({...n,showLabels:!n.showLabels})}),"Show labels"]}),(0,s.jsxs)(eK._,{htmlFor:"showGrid",children:[(0,s.jsx)(eV.X,{id:"showGrid",name:"showGrid",checked:n.showGrid,onClick:()=>i({...n,showGrid:!n.showGrid})}),"Show grid"]})]})]})})]})})}var eH=n(29259),eY=n.n(eH),eX=n(85505),eJ=n.n(eX),e$=n(16760),e0=n.n(e$),e1=n(66142),e2=n(83606),e5=n(27570),e3=n(17913),e4=n(7774),e8=e=>{var t,n,i,l,o,c,d;let{id:u}=e,{project:h}=(0,e5.d2)(),m=(0,g.Mk)(),x=(0,M.W2)(),f=(0,W.B0)(),v=(0,R.P)("sqlFolderOrganization"),_=v?null===(n=f.results)||void 0===n?void 0:null===(t=n[u])||void 0===t?void 0:t[0]:null!==(d=null===(l=x.results)||void 0===l?void 0:null===(i=l[u])||void 0===i?void 0:i[0])&&void 0!==d?d:void 0,j=(0,a.useRef)(null),b=(0,r.useRouter)(),y=(0,a.useMemo)(()=>{if(null==_?void 0:_.rows){let e=Array.from(_.rows||[]).map(e=>e0()(e,(e,t)=>eJ()(e)?e.replaceAll(/\n/g,"\\n").replaceAll(/"/g,'""'):eY()(e)?JSON.stringify(e).replaceAll(/\"/g,'""'):e));return en()(e)}return""},[_]),N=(0,a.useMemo)(()=>{if(null==_?void 0:_.rows){let e=Array.from(_.rows||[])[0];if(e)return Object.keys(e)}},[_]);return(0,s.jsxs)(G.h_,{children:[(0,s.jsx)(G.$F,{asChild:!0,children:(0,s.jsx)(Q.z,{type:"text",iconRight:(0,s.jsx)(eI.Z,{size:14}),children:"Export"})}),(0,s.jsx)(e2.CSVLink,{ref:j,className:"hidden",headers:N,data:y,filename:v?"supabase_".concat(null==h?void 0:h.ref,"_").concat(null===(o=f.snippets[u])||void 0===o?void 0:o.snippet.name,".csv"):"supabase_".concat(null==h?void 0:h.ref,"_").concat(null===(c=x.snippets[u])||void 0===c?void 0:c.snippet.name,".csv")}),(0,s.jsxs)(G.AW,{side:"bottom",align:"start",children:[(0,s.jsxs)(G.Xi,{onClick:function(){var e;null===(e=j.current)||void 0===e||e.link.click(),z.Z.sendEvent({category:"sql_editor",action:"sql_download_csv",label:""},m,b)},className:"space-x-2",children:[(0,s.jsx)(e3.Z,{size:14}),(0,s.jsx)("p",{children:"Download CSV"})]}),(0,s.jsxs)(G.Xi,{onClick:function(){if(navigator){if(!_||!_.rows)return"results is empty";if(_.rows.constructor!==Array&&_.error)return _.error;if(0==_.rows.length)return"results is empty";let e=Object.keys(_.rows[0]),t=_.rows.map(t=>{let n=[];return e.forEach(e=>n.push(t[e])),n}),n=[e].concat(t),s=(0,e1.x)(n);(0,I.vQ)(s,()=>{p.Am.success("Copied results to clipboard"),z.Z.sendEvent({category:"sql_editor",action:"sql_copy_as_markdown",label:""},m,b)})}},className:"space-x-2",children:[(0,s.jsx)(e4.Z,{size:14}),(0,s.jsx)("p",{children:"Copy as markdown"})]}),(0,s.jsxs)(G.Xi,{onClick:function(){if(navigator){if(!_||!_.rows)return"results is empty";if(_.rows.constructor!==Array&&_.error)return _.error;if(0==_.rows.length)return"results is empty";(0,I.vQ)(JSON.stringify(_.rows,null,2),()=>{p.Am.success("Copied results to clipboard"),z.Z.sendEvent({category:"sql_editor",action:"sql_copy_as_json",label:""},m,b)})}},className:"space-x-2",children:[(0,s.jsx)(e4.Z,{size:14}),(0,s.jsx)("p",{children:"Copy as JSON"})]})]})]})},e6=n(78549),e9=n(99336),e7=n(76541),te=n(28507),tt=n(62046),tn=n(3696),ts=n(37962),ti=n(1073),tr=n(52006),ta=n(84602),tl=e=>{var t,n,i;let{id:r}=e,a=(0,g.aF)(),l=(0,M.W2)().snippets[r],o=(null==a?void 0:null===(t=a.user_metadata)||void 0===t?void 0:t.user_name)===(null==l?void 0:null===(i=l.snippet)||void 0===i?void 0:null===(n=i.owner)||void 0===n?void 0:n.username);return(0,s.jsx)(s.Fragment,{children:o?null:(0,s.jsx)(ey.C,{children:"Read-only"})})},to=e=>{let{id:t}=e,{profile:n}=(0,D.Un)(),i=(0,M.W2)(),r=(0,W.B0)(),l=(0,R.P)("sqlFolderOrganization"),o=l?r.savingStates[t]:i.savingStates[t],c=(0,ta.D9)(o),[u,h]=(0,a.useState)(!1),m=l?r.snippets[t]:i.snippets[t],p=(null==n?void 0:n.id)===(null==m?void 0:m.snippet.owner_id);return(0,a.useEffect)(()=>{let e=!1;return"UPDATING"===c&&"IDLE"===o&&(h(!0),setTimeout(()=>{e||h(!1)},5e3)),()=>{e=!0}},[o]),(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"mx-2 flex items-center gap-2",children:[p&&"UPDATING_FAILED"===o&&(0,s.jsx)(Q.z,{type:"text",size:"tiny",icon:(0,s.jsx)(ti.Z,{className:"text-gray-1100",strokeWidth:2}),onClick:()=>l?r.addNeedsSaving(t):i.addNeedsSaving(t),children:"Retry"}),u?(0,s.jsxs)(V.u,{children:[(0,s.jsx)(V.aJ,{children:(0,s.jsx)(ek.Z,{className:"text-brand",size:14,strokeWidth:3})}),(0,s.jsx)(V._v,{side:"bottom",children:"All changes saved"})]}):"UPDATING"===o?(0,s.jsxs)(V.u,{children:[(0,s.jsx)(V.aJ,{children:(0,s.jsx)(d.Z,{className:"animate-spin",size:14,strokeWidth:2})}),(0,s.jsx)(V._v,{children:"Saving changes..."})]}):"UPDATING_FAILED"===o?p?(0,s.jsxs)(V.u,{children:[(0,s.jsx)(V.aJ,{children:(0,s.jsx)(tr.Z,{className:"text-red-900",size:14,strokeWidth:2})}),(0,s.jsx)(V._v,{children:"Failed to save changes"})]}):(0,s.jsx)(tl,{id:t}):null]})})},tc=e=>{let{id:t,isExecuting:n=!1,isDisabled:i=!1,hasSelection:r,prettifyQuery:a,executeQuery:l}=e,c=(0,I.fV)(),u=(0,o.NL)(),{project:h}=(0,e5.d2)(),m=(0,M.W2)(),x=(0,W.B0)(),g=(0,R.P)("sqlFolderOrganization"),[f]=(0,E.l)(L.dA.SQL_EDITOR_AI_OPEN,!0),[v,_]=(0,E.l)(L.dA.SQL_EDITOR_INTELLISENSE,!0),j=g?x.snippets[t]:m.snippets[t],b=void 0!==j&&(g?j.snippet.favorite:j.snippet.content.favorite),y=()=>{_(!v),p.Am.success("Successfully ".concat(v?"disabled":"enabled"," intellisense. ").concat(v?"Please refresh your browser for changes to take place.":""))},N=async()=>{g?x.addFavorite(t):m.addFavorite(t),u.setQueryData(eF.$.list(null==h?void 0:h.ref),e=>{if(e)return{...e,content:e.content.map(e=>"sql"===e.type&&e.id===t?{...e,content:{...e.content,favorite:!0}}:e)}})},w=async()=>{g?x.removeFavorite(t):m.removeFavorite(t),u.setQueryData(eF.$.list(null==h?void 0:h.ref),e=>{if(e)return{...e,content:e.content.map(e=>"sql"===e.type&&e.id===t?{...e,content:{...e.content,favorite:!1}}:e)}})};return(0,s.jsxs)("div",{className:"inline-flex items-center justify-end gap-x-2",children:[L.Qy&&(0,s.jsx)(to,{id:t}),(0,s.jsxs)(G.h_,{children:[(0,s.jsx)(G.$F,{asChild:!0,children:(0,s.jsx)(Q.z,{type:"default",className:(0,U.cn)("px-1",f?"block 2xl:hidden":"hidden"),icon:(0,s.jsx)(e6.Z,{className:"text-foreground-light"})})}),(0,s.jsxs)(G.AW,{className:"w-48",children:[(0,s.jsxs)(G.Xi,{className:"justify-between",onClick:y,children:[(0,s.jsxs)("span",{className:"flex items-center gap-x-2",children:[(0,s.jsx)(e9.Z,{size:14,className:"text-foreground-light"}),"Intellisense enabled"]}),v&&(0,s.jsx)(ek.Z,{className:"text-brand",size:16})]}),(0,s.jsx)(G.VD,{}),(0,s.jsxs)(G.Xi,{className:"gap-x-2",onClick:()=>{b?w():N()},children:[(0,s.jsx)(e7.Z,{size:14,strokeWidth:2,className:b?"fill-brand stroke-none":"fill-none stroke-foreground-light"}),b?"Remove from":"Add to"," favorites"]}),(0,s.jsxs)(G.Xi,{className:"gap-x-2",onClick:a,children:[(0,s.jsx)(te.Z,{size:14,strokeWidth:2,className:"text-foreground-light"}),"Prettify SQL"]})]})]}),(0,s.jsxs)("div",{className:(0,U.cn)("items-center gap-x-2",f?"hidden 2xl:flex":"flex"),children:[(0,s.jsxs)(G.h_,{children:[(0,s.jsx)(G.$F,{asChild:!0,children:(0,s.jsx)(Q.z,{type:"text",className:"px-1",icon:(0,s.jsx)(e9.Z,{className:"text-foreground-light"})})}),(0,s.jsx)(G.AW,{className:"w-48",children:(0,s.jsxs)(G.Xi,{className:"justify-between",onClick:y,children:["Intellisense enabled",v&&(0,s.jsx)(ek.Z,{className:"text-brand",size:16})]})})]}),L.Qy&&(0,s.jsxs)(V.u,{children:[(0,s.jsx)(V.aJ,{asChild:!0,children:b?(0,s.jsx)(Q.z,{type:"text",size:"tiny",onClick:w,className:"px-1",icon:(0,s.jsx)(e7.Z,{className:"fill-brand stroke-none"})}):(0,s.jsx)(Q.z,{type:"text",size:"tiny",onClick:N,className:"px-1",icon:(0,s.jsx)(e7.Z,{className:"fill-none stroke-foreground-light"})})}),(0,s.jsxs)(V._v,{side:"bottom",children:[b?"Remove from":"Add to"," favorites"]})]}),(0,s.jsxs)(V.u,{children:[(0,s.jsx)(V.aJ,{asChild:!0,children:(0,s.jsx)(Q.z,{type:"text",onClick:a,className:"px-1",icon:(0,s.jsx)(te.Z,{strokeWidth:2,className:"text-foreground-light"})})}),(0,s.jsx)(V._v,{side:"bottom",children:"Prettify SQL"})]})]}),(0,s.jsx)("div",{className:"flex items-center justify-between gap-x-2",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(ts.Z,{variant:"connected-on-right",onSelectId:()=>{g?x.resetResult(t):m.resetResult(t)}}),(0,s.jsx)(tn.Q,{serviceRoleLabel:"postgres",variant:"connected-on-both"}),(0,s.jsx)(Q.z,{onClick:()=>l(),disabled:i||n,type:"primary",size:"tiny",iconRight:n?(0,s.jsx)(d.Z,{className:"animate-spin",size:10,strokeWidth:1.5}):(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:["macos"===c?(0,s.jsx)(tt.Z,{size:10,strokeWidth:1.5}):(0,s.jsx)("p",{className:"text-xs text-foreground-light",children:"CTRL"}),(0,s.jsx)(eL.Z,{size:10,strokeWidth:1.5})]}),className:"rounded-l-none min-w-[82px]",children:r?"Run selected":"Run"})]})})]})},td=n(17172),tu=n(26674),th=n(47370),tm=n(72683),tp=n(80435),tx=n(82663),tg=n(38264),tf=n(7117);let tv=e=>{let{column:t,value:n,visible:i,onClose:r}=e,[l,o]=(0,a.useState)("view"),c=null===n?"":"object"==typeof n?JSON.stringify(n,null,"	"):String(n),d="string"==typeof n;return(0,a.useEffect)(()=>{i&&o("view")},[i]),(0,s.jsx)(tf.yo,{open:i,onOpenChange:()=>r(),children:(0,s.jsxs)(tf.ue,{size:"lg",className:"flex flex-col gap-0",children:[(0,s.jsx)(tf.Tu,{className:"py-2.5",children:(0,s.jsxs)(tf.bC,{className:"flex items-center justify-between pr-7",children:[(0,s.jsxs)("p",{className:"truncate",children:["Viewing cell details on column: ",(0,s.jsx)("code",{className:"text-sm",children:t})]}),d&&(0,s.jsx)(tg.Z,{options:["MD","view"],activeOption:l,borderOverride:"border-muted",onClickOption:o})]})}),"view"===l?(0,s.jsx)("div",{className:"relative h-full",children:(0,s.jsx)(tx.Z,{isReadOnly:!0,id:"sql-editor-expand-cell",language:"json",value:c,placeholder:null===n?"NULL":void 0,options:{wordWrap:"off",contextmenu:!1}})}):(0,s.jsx)("div",{className:"flex-grow py-4 px-4 bg-default overflow-y-auto",children:(0,s.jsx)(tp.U,{remarkPlugins:[eb.Z],className:"!max-w-full markdown-body",content:c})})]})})};function t_(e){return null===e?"":"object"==typeof e||Array.isArray(e)?JSON.stringify(e):e}var tj=e=>{var t,n,i;let{rows:r}=e,[l,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)(),u=()=>{if(c){var e,t;let{rowIdx:n,column:s}=c,i=s.key,a=t_(null!==(t=null===(e=r[n])||void 0===e?void 0:e[i])&&void 0!==t?t:"");(0,I.vQ)(a)}};(0,ta.aL)({"Command+c":e=>{e.stopPropagation(),u()},"Control+c":e=>{e.stopPropagation(),u()}},["INPUT","TEXTAREA"]);let h=(e,t)=>(0,s.jsxs)(tm.xV,{modal:!1,children:[(0,s.jsx)(tm.W4,{asChild:!0,children:(0,s.jsx)("div",{className:(0,U.cn)("flex items-center h-full font-mono text-xs w-full whitespace-pre",null===t[e]&&"text-foreground-lighter"),children:null===t[e]?"NULL":JSON.stringify(t[e])})}),(0,s.jsxs)(tm.h_,{onCloseAutoFocus:e=>e.stopPropagation(),children:[(0,s.jsxs)(tm.Zo,{className:"gap-x-2",onSelect:()=>{var n;let s=t_(null!==(n=t[e])&&void 0!==n?n:"");(0,I.vQ)(s)},onFocusCapture:e=>e.stopPropagation(),children:[(0,s.jsx)(e4.Z,{size:14}),"Copy cell content"]}),(0,s.jsxs)(tm.Zo,{className:"gap-x-2",onSelect:()=>o(!0),onFocusCapture:e=>e.stopPropagation(),children:[(0,s.jsx)(tu.Z,{size:14}),"View cell content"]})]})]}),m=e=>(0,s.jsx)("div",{className:"flex h-full items-center justify-center font-mono text-xs",children:e}),p=Object.keys(null!==(n=null==r?void 0:r[0])&&void 0!==n?n:[]).map((e,t)=>{let n=r.map(t=>String(t[e]).length).reduce((e,t)=>Math.max(e,t),0);return{idx:t,key:e,name:e,resizable:!0,parent:void 0,level:0,width:Math.max(Math.min(8.25*n,500),100),minWidth:100,maxWidth:void 0,draggable:!1,frozen:!1,sortable:!1,isLastFrozenColumn:!1,renderCell:t=>{let{row:n}=t;return h(e,n)},renderHeaderCell:()=>m(e)}});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(th.ZP,{columns:p,rows:r,className:"h-full flex-grow border-t-0",rowClass:()=>"[&>.rdg-cell]:items-center",onSelectedCellChange:d}),(0,s.jsx)(tv,{column:null!==(i=null==c?void 0:c.column.name)&&void 0!==i?i:"",value:null==c?void 0:null===(t=c.row)||void 0===t?void 0:t[c.column.name],visible:l,onClose:()=>o(!1)})]})},tb=n(39097),ty=n.n(tb),tN=e=>{var t,n,i,r,a,l,o,c,u,h;let{id:m,isExecuting:p,isDisabled:x,isDebugging:f,onDebug:v}=e,{ref:_}=(0,g.UO)(),j=(0,F.TF)(),b=(0,q.l)(),y=(0,M.W2)(),N=(0,W.B0)(),w=(0,R.P)("sqlFolderOrganization")?null===(t=N.results[m])||void 0===t?void 0:t[0]:null===(n=y.results[m])||void 0===n?void 0:n[0],{data:E}=(0,k.Gl)({orgSlug:null==b?void 0:b.slug}),S=(0,H.$w)(E),C=(null==w?void 0:null===(r=w.error)||void 0===r?void 0:null===(i=r.message)||void 0===i?void 0:i.includes("canceling statement due to statement timeout"))||(null==w?void 0:null===(l=w.error)||void 0===l?void 0:null===(a=l.message)||void 0===a?void 0:a.includes("upstream request timeout"));if(p)return(0,s.jsxs)("div",{className:"flex items-center gap-x-4 px-6 py-4 bg-table-header-light [[data-theme*=dark]_&]:bg-table-header-dark",children:[(0,s.jsx)(d.Z,{size:14,className:"animate-spin"}),(0,s.jsx)("p",{className:"m-0 border-0 font-mono text-sm",children:"Running..."})]});if(null==w?void 0:w.error){let e=(null!==(h=null===(c=w.error)||void 0===c?void 0:null===(o=c.formattedError)||void 0===o?void 0:o.split("\n"))&&void 0!==h?h:[]).filter(e=>e.length>0),t=j.selectedDatabaseId!==_&&w.error.message.includes("in a read-only transaction"),n=w.error.message.includes("Query is too large to be run via the SQL Editor");return(0,s.jsx)("div",{className:"bg-table-header-light [[data-theme*=dark]_&]:bg-table-header-dark",children:(0,s.jsxs)("div",{className:"flex flex-row justify-between items-start py-4 px-6 gap-x-4",children:[C?(0,s.jsxs)("div",{className:"flex flex-col gap-y-1",children:[(0,s.jsx)("p",{className:"font-mono text-sm",children:"SQL query ran into an upstream timeout"}),(0,s.jsxs)("p",{className:"font-mono text-sm text-foreground-light",children:["You can either"," ",(0,s.jsx)("a",{target:"_blank",rel:"noreferrer",className:"underline transition hover:text-foreground",href:"https://supabase.com/docs/guides/platform/performance#examining-query-performance",children:"optimize your query"}),", or"," ",(0,s.jsx)("a",{target:"_blank",rel:"noreferrer",className:"underline transition hover:text-foreground",href:"https://supabase.com/docs/guides/database/timeouts",children:"increase the statement timeout"}),"."]})]}):(0,s.jsxs)("div",{className:"flex flex-col gap-y-1",children:[e.length>0?e.map((e,t)=>(0,s.jsx)("pre",{className:"font-mono text-sm text-wrap",children:e},"error-".concat(t))):(0,s.jsxs)("p",{className:"font-mono text-sm tracking-tight",children:["Error: ",null===(u=w.error)||void 0===u?void 0:u.message]}),w.autoLimit&&(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:["Note: A limit of ",w.autoLimit,' was applied to your query. If this was the cause of a syntax error, try selecting "No limit" instead and re-run the query.']}),t&&(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Note: Read replicas are for read only queries. Run write queries on the primary database instead."}),n&&(0,s.jsxs)("p",{className:"text-sm text-foreground-light flex items-center gap-x-1",children:["Run this query by"," ",(0,s.jsxs)(ty(),{target:"_blank",rel:"noreferrer",href:"/project/".concat(_,"/settings/database"),className:"underline transition hover:text-foreground flex items-center gap-x-1",children:["connecting to your database directly",(0,s.jsx)(td.Z,{size:12})]}),"."]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-x-2",children:[t&&(0,s.jsx)(Q.z,{className:"py-2",type:"default",onClick:()=>{j.setSelectedDatabaseId(_),y.resetResult(m)},children:"Switch to primary database"}),!S&&(0,s.jsx)(Q.z,{icon:(0,s.jsx)(K.c,{className:"scale-75 w-3 h-3",loading:f}),disabled:!!x||f,onClick:v,children:"Debug with Supabase AI"})]})]})})}return w?w.rows.length<=0?(0,s.jsx)("div",{className:"bg-table-header-light [[data-theme*=dark]_&]:bg-table-header-dark",children:(0,s.jsx)("p",{className:"m-0 border-0 px-6 py-4 font-mono text-sm",children:"Success. No rows returned"})}):(0,s.jsx)(tj,{rows:w.rows}):(0,s.jsx)("div",{className:"bg-table-header-light [[data-theme*=dark]_&]:bg-table-header-dark",children:(0,s.jsxs)("p",{className:"m-0 border-0 px-6 py-4 text-sm text-foreground-light",children:["Click ",(0,s.jsx)("code",{children:"Run"})," to execute your query."]})})};let tw={type:"bar",cumulative:!1,xKey:"",yKey:"",showLabels:!1,showGrid:!1};var tk=e=>{var t,n,i,r;let{id:a,isExecuting:l,isDebugging:c,isDisabled:d,hasSelection:u,prettifyQuery:h,executeQuery:m,onDebug:x}=e,{ref:f}=(0,g.UO)(),v=(0,o.NL)(),_=(0,M.W2)(),j=(0,W.B0)(),b=(0,R.P)("sqlFolderOrganization"),y=b?null===(t=j.snippets[a])||void 0===t?void 0:t.snippet:null===(n=_.snippets[a])||void 0===n?void 0:n.snippet,N=eF.$.list(f),w=b?null===(i=j.results[a])||void 0===i?void 0:i[0]:null===(r=_.results[a])||void 0===r?void 0:r[0],{mutate:k}=(0,eT.R)({invalidateQueriesOnSuccess:!1,onMutate:async e=>{let{payload:t}=e;if("sql"!==t.type||!("chart"in t.content))return;await v.cancelQueries(N);let n={...y,content:{...y.content,chart:t.content.chart}};b?j.updateSnippet({id:a,snippet:n}):_.updateSnippet(a,n)},onError:async(e,t,n)=>{p.Am.error("Failed to update chart. Please try again.")}}),E=y&&"sql"===y.type&&y.content.chart?y.content.chart:tw;return(0,s.jsxs)(eO.mQ,{defaultValue:"results",className:"w-full h-full flex flex-col",children:[(0,s.jsxs)(eO.dr,{className:"flex justify-between gap-2 px-2 overflow-x-auto min-h-[42px]",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(eO.SP,{className:"py-3 text-xs",value:"results",children:(0,s.jsx)("span",{className:"translate-y-[1px]",children:"Results"})}),(0,s.jsx)(eO.SP,{className:"py-3 text-xs",value:"chart",children:(0,s.jsx)("span",{className:"translate-y-[1px]",children:"Chart"})}),(null==w?void 0:w.rows)&&(0,s.jsx)(e8,{id:a})]}),(0,s.jsx)(tc,{id:a,isExecuting:l,isDisabled:d,hasSelection:u,prettifyQuery:h,executeQuery:m})]}),(0,s.jsx)(eO.nU,{asChild:!0,value:"results",className:"mt-0 flex-grow",children:(0,s.jsx)(tN,{id:a,isExecuting:l,isDisabled:d,onDebug:x,isDebugging:c})}),(0,s.jsx)(eO.nU,{asChild:!0,value:"chart",className:"mt-0 flex-grow",children:(0,s.jsx)(eB,{results:w,config:E,onConfigChange:function(e){f&&(null==y?void 0:y.id)&&k({projectRef:f,payload:{...y,id:y.id,description:y.description||"",project_id:y.project_id||0,content:{...y.content,content_id:a,chart:e}}})}})})]})};let tE=m()(()=>n.e(8845).then(n.bind(n,68845)),{loadableGenerated:{webpack:()=>[68845]},ssr:!1}),tS=m()(()=>Promise.resolve().then(n.bind(n,79534)).then(e=>{let{DiffEditor:t}=e;return t}),{loadableGenerated:{webpack:()=>[79534]},ssr:!1});var tC=()=>{var e,t,n,i;let{ref:l,id:h}=(0,g.UO)(),m=(0,r.useRouter)(),Y=(0,g.Mk)(),X=(0,a.useMemo)(()=>(0,I.k$)(),[h]),$=h&&"new"!==h?h:X,{profile:ee}=(0,D.Un)(),et=(0,A.V)(),en=(0,q.l)(),es=(0,T.WZ)(),ei=(0,M.W2)(),er=(0,W.B0)(),ea=(0,O.z6)(),el=(0,F.TF)(),eo=(0,o.NL)(),ec=(0,R.P)("sqlFolderOrganization"),{mutate:ed}=(0,w.X)(),{mutateAsync:eu}=(0,_.g)(),{mutateAsync:eh,isLoading:em}=(0,v.V)(),[ep,ex]=(0,a.useState)(),[eg,ef]=(0,a.useState)(),[ev,e_]=(0,a.useState)(),[ej,eb]=(0,a.useState)(),[ey,eN]=(0,a.useState)(!1),ew=(0,a.useRef)(null),ek=(0,a.useRef)(null),eE=(0,a.useRef)(null),{data:eS}=(0,k.Gl)({orgSlug:null==en?void 0:en.slug}),{data:eq,isSuccess:eA}=(0,y.bN)({projectRef:l}),eL=(0,H.$w)(eS),[eI,eT]=(0,E.l)(L.dA.SQL_EDITOR_AI_OPEN,!0),[eF,eO]=(0,a.useState)(!1),eM=(0,S.C)(),[eW]=(0,C.l)(null==et?void 0:et.ref),eP=eM||!L.Qy,[eU,eK]=(0,a.useState)(!1),[,eV]=(0,E.l)("supabase_sql-editor-ai-query-count",0),[eG,eQ]=(0,a.useState)(void 0),[eB,eH]=(0,a.useState)(!0),[eY,eX]=(0,a.useState)([]),{data:eJ,refetch:e$}=(0,j.u)({schemas:eW,projectRef:null==et?void 0:et.ref,connectionString:null==et?void 0:et.connectionString},{enabled:eP}),e0=eP?null==eJ?void 0:eJ.map(e=>e.sql.trim()):void 0,e1=!!ev,e2=ec?er.limit:ei.limit,e5=ec?null===(e=er.results[$])||void 0===e?void 0:e[0]:null===(t=ei.results[$])||void 0===t?void 0:t[0],e3=ec?!($ in er.snippets&&void 0!==er.snippets[$].snippet.content):!($&&l&&ei.loaded[l]),e4="new"!==h&&e3,{mutate:e8,isLoading:e6}=(0,N.r)({onSuccess(e,t){$&&(ec?er.addResult($,e.result,t.autoLimit):ei.addResult($,e.result,t.autoLimit)),e$(),eo.invalidateQueries(b.X.lint(l))},onError(e,t){if($){if(e.position&&ek.current){var n,s,i;let t=ew.current,r=ek.current,a=ey&&null!==(s=null==t?void 0:null===(n=t.getSelection())||void 0===n?void 0:n.startLineNumber)&&void 0!==s?s:0,l=null!==(i=e.formattedError)&&void 0!==i?i:"",o=l.slice(l.indexOf("LINE")),c=a+Number(o.slice(0,o.indexOf(":")).split(" ")[1]);if(!isNaN(c)){let e=null==t?void 0:t.deltaDecorations([],[{range:new r.Range(c,1,c,20),options:{isWholeLine:!0,inlineClassName:"bg-warning-400"}}]);e&&(null==t||t.revealLineInCenter(c),eX(e))}}ec?er.addResultError($,e,t.autoLimit):ei.addResultError($,e,t.autoLimit)}}}),e9=(0,a.useCallback)(async(e,t)=>{try{let{title:n}=await eu({sql:t});ec?er.renameSnippet({id:e,name:n}):ei.renameSnippet(e,n)}catch(e){}},[eu,ei]),e7=(0,a.useCallback)(async()=>{if(e1)return;let e=(ec?(0,W.pB)():(0,M.X8)()).snippets[$];if(ew.current&&et){var t,n,s,i;let r=ew.current,a=r.getSelection(),l=a?null===(t=r.getModel())||void 0===t?void 0:t.getValueInRange(a):void 0,o=e?null!==(i=l||(null===(n=ew.current)||void 0===n?void 0:n.getValue()))&&void 0!==i?i:e.snippet.content.sql:l||(null===(s=ew.current)||void 0===s?void 0:s.getValue());ed({projectRef:et.ref,connectionString:et.connectionString,sql:o},{onSuccess:e=>{var t;let n=null==ew?void 0:null===(t=ew.current)||void 0===t?void 0:t.getModel();ew.current&&n&&(ew.current.executeEdits("apply-prettify-edit",[{text:e.result,range:n.getFullModelRange()}]),ei.setSql($,e.result))}})}},[ed,$,e1,et,ei]),te=(0,a.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e1)return;let t=(ec?(0,W.pB)():(0,M.X8)()).snippets[$];if(null!==ew.current&&!e6&&void 0!==et){var n,s,i,r,a;let l=ew.current,o=l.getSelection(),c=o?null===(n=l.getModel())||void 0===n?void 0:n.getValueInRange(o):void 0,d=t?null!==(a=c||(null===(s=ew.current)||void 0===s?void 0:s.getValue()))&&void 0!==a?a:t.snippet.content.sql:c||(null===(i=ew.current)||void 0===i?void 0:i.getValue()),u=(0,eD.mw)(d);if(!e&&u){eO(!0);return}eL||(null==t?void 0:t.snippet.name)!==ez.$C||e9($,d),eY.length>0&&(null==l||l.deltaDecorations(eY,[]),eX([]));let h=ea(),m=null==eq?void 0:null===(r=eq.find(e=>e.identifier===el.selectedDatabaseId))||void 0===r?void 0:r.connectionString;if(L.Qy&&!m)return p.Am.error("Unable to run query: Connection string is missing");let{appendAutoLimit:x}=(0,eD.c6)(d,e2),g=(0,eD.se)(d,e2);e8({projectRef:et.ref,connectionString:m,sql:(0,Z.Jh)(g,{projectRef:et.ref,role:h}),autoLimit:x?e2:void 0,isRoleImpersonationEnabled:(0,O.Gm)(h),handleError:e=>{throw e}})}},[e1,$,e6,et,eL,e8,ea,e9,el.selectedDatabaseId,eq,e2]),tt=(0,a.useCallback)(async(e,t)=>{if(!l)return console.error("Project ref is required");try{let n=(0,eD.UA)({id:(0,I.k$)(),name:t,sql:e,owner_id:null==ee?void 0:ee.id,project_id:null==et?void 0:et.id});ei.addSnippet(n,l),ei.addNeedsSaving(n.id),m.push("/project/".concat(l,"/sql/").concat(n.id))}catch(e){p.Am.error("Failed to create new query: ".concat(e.message))}},[null==ee?void 0:ee.id,null==et?void 0:et.id,l,m,ei]),tn=(0,a.useCallback)(e=>{var t,n,s,i,r;let{id:a,diffType:l,sql:o}=e,c=null===(t=ew.current)||void 0===t?void 0:t.getModel();c&&((eV(e=>e+1),0===(null!==(s=null===(n=ew.current)||void 0===n?void 0:n.getValue())&&void 0!==s?s:"").length)?null===(i=ew.current)||void 0===i||i.executeEdits("apply-ai-message",[{text:"".concat(ez.eg,"\n\n").concat(o),range:c.getFullModelRange()}]):(ex(a),e_({original:(null===(r=ew.current)||void 0===r?void 0:r.getValue())||"",modified:o}),eQ(l)))},[eV]),ts=(0,a.useCallback)(async()=>{var e,t;try{let n=ec?er.snippets[$]:ei.snippets[$],s=ec?null===(e=er.results[$])||void 0===e?void 0:e[0]:null===(t=ei.results[$])||void 0===t?void 0:t[0],{solution:i,sql:r}=await eh({sql:n.snippet.content.sql.replace(ez.eg,"").trim(),errorMessage:s.error.message,entityDefinitions:e0}),a=ez.eg+"\n\n"+(0,x.WU)(r,{language:"postgresql",keywordCase:"lower"});ef(i),e_({original:n.snippet.content.sql,modified:a}),eQ(eC.U.Modification)}catch(e){e&&"object"==typeof e&&"message"in e&&"string"==typeof e.message&&p.Am.error("Sorry, the assistant failed to debug your query! Please try again with a different one.")}},[eh,e0,$,ei.results,ei.snippets]),ti=(0,a.useCallback)(async()=>{try{if(eK(!0),!ev||!ew.current||!eE.current)return;let e=ew.current.getModel(),t=eE.current.getModel();if(!e||!t)return;let n=t.modified.getValue();if(eG===eC.U.NewSnippet){let{title:e}=await eu({sql:n});await tt(n,e)}else ew.current.executeEdits("apply-ai-edit",[{text:n,range:e.getFullModelRange()}]),ej&&ei.renameSnippet($,ej);z.Z.sendEvent({category:"sql_editor",action:"ai_suggestion_accepted",label:eg?"debug_snippet":"edit_snippet"},Y,m),ex(void 0),eQ(eC.U.Modification),ef(void 0),e_(void 0),eb(void 0)}finally{eK(!1)}},[ev,eG,tt,eu,eg,Y,m,$,ej,ei]),tr=(0,a.useCallback)(()=>{z.Z.sendEvent({category:"sql_editor",action:"ai_suggestion_rejected",label:eg?"debug_snippet":"edit_snippet"},Y,m),ex(void 0),ef(void 0),e_(void 0),eb(void 0)},[eg,Y,m]);(0,a.useEffect)(()=>{let e=e=>{if(e1)switch(e.key){case"Enter":ti();return;case"Escape":tr();return}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[e1,ti,tr]),(0,a.useEffect)(()=>{var e;let t=e=>{var t;let{original:n,modified:s}=e,i=null===(t=eE.current)||void 0===t?void 0:t.getModel();i&&i.original&&i.modified&&(i.original.setValue(n),i.modified.setValue(s))},n=null===(e=eE.current)||void 0===e?void 0:e.getModel();try{if((null==n?void 0:n.original)&&n.modified&&ev)switch(eG){case eC.U.Modification:{let e=(0,eD.GS)(ev);t(e);return}case eC.U.Addition:{let e=(0,eD.EF)(ev);t(e);return}case eC.U.NewSnippet:{let e=(0,eD.BJ)(ev);t(e);return}default:throw Error("Unknown diff type '".concat(eG,"'"))}}catch(e){console.log(e)}},[eG,ev]),(0,a.useEffect)(()=>{eH(!1)},[]),(0,a.useEffect)(()=>{if(eA){let e=eq.find(e=>e.identifier===l);el.setSelectedDatabaseId(null==e?void 0:e.identifier)}},[eA,eq,l]);let ta=(0,a.useMemo)(()=>{if(!ev)return{original:"",modified:""};switch(eG){case eC.U.Modification:return(0,eD.GS)(ev);case eC.U.Addition:return(0,eD.EF)(ev);case eC.U.NewSnippet:return(0,eD.BJ)(ev);default:return{original:"",modified:""}}},[eG,ev]),tl=(0,a.useRef)(null);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(B.Z,{visible:eF,title:"Destructive operation",danger:!0,description:"We've detected a potentially destructive operation in the query. Please confirm that you would like to execute this query.",buttonLabel:"Run destructive query",onSelectCancel:()=>{eO(!1),setTimeout(()=>{var e;return null===(e=ew.current)||void 0===e?void 0:e.focus()},100)},onSelectConfirm:()=>{eO(!1),te(!0)}}),(0,s.jsxs)(P.pO,{className:"flex h-full",direction:"horizontal",autoSaveId:L.dA.SQL_EDITOR_AI_PANEL_SPLIT_SIZE,children:[(0,s.jsx)(P.ee,{minSize:30,children:(0,s.jsxs)(P.pO,{className:"relative",direction:"vertical",autoSaveId:L.dA.SQL_EDITOR_SPLIT_SIZE,children:[(eI||e1)&&!eL&&(0,s.jsx)(J,{onClickSettings:()=>{es.setShowAiSettingsModal(!0)},children:e1&&(0,s.jsxs)(c.E.div,{layoutId:"ask-ai-input-container",variants:{visible:{borderRadius:0,x:0},hidden:{x:100}},initial:eB?"visible":"hidden",animate:"visible",className:(0,U.cn)("flex flex-row items-center gap-3 justify-end px-2 py-2 w-full z-10","bg-brand-200 border-b border-brand-400  !shadow-none"),children:[eg&&(0,s.jsx)("div",{className:"h-full w-full flex flex-row items-center overflow-y-hidden text-sm text-brand-600",children:eg}),(0,s.jsx)(eZ,{loading:eU,selectedDiffType:eG||eC.U.Modification,onChangeDiffType:e=>eQ(e),onAccept:ti,onCancel:tr})]},"ask-ai-input-container")}),(0,s.jsx)(P.ee,{maxSize:70,children:(0,s.jsxs)("div",{className:"flex-grow overflow-y-auto border-b h-full",children:[!eI&&(0,s.jsx)(c.E.button,{layoutId:"ask-ai-input-icon",transition:{duration:.1},onClick:()=>{var e;return null===(e=tl.current)||void 0===e?void 0:e.expand()},className:(0,U.cn)("group absolute z-10 rounded-lg right-[24px] top-4 transition-all duration-200 ease-out"),children:(0,s.jsx)(K.c,{loading:!1,allowHoverEffect:!0})}),e4?(0,s.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,s.jsx)(d.Z,{className:"animate-spin text-brand"})}):(0,s.jsxs)(s.Fragment,{children:[e1&&(0,s.jsx)(c.E.div,{className:"w-full h-full",variants:{visible:{opacity:1,filter:"blur(0px)"},hidden:{opacity:0,filter:"blur(10px)"}},initial:"hidden",animate:"visible",children:(0,s.jsx)(tS,{theme:"supabase",language:"pgsql",original:ta.original,modified:ta.modified,onMount:e=>{eE.current=e},options:{fontSize:13}})}),(0,s.jsx)(c.E.div,{variants:{visible:{opacity:1,filter:"blur(0px)"},hidden:{opacity:0,filter:"blur(10px)"}},initial:"hidden",animate:e1?"hidden":"visible",className:"w-full h-full",children:(0,s.jsx)(tE,{autoFocus:!0,id:$,editorRef:ew,monacoRef:ek,executeQuery:te,onHasSelection:eN})},$)]})]})}),(0,s.jsx)(P.Dp,{withHandle:!0}),(0,s.jsx)(P.ee,{maxSize:70,children:e4?(0,s.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,s.jsx)(d.Z,{className:"animate-spin text-brand"})}):(0,s.jsx)(tk,{id:$,isExecuting:e6,isDisabled:e1,isDebugging:em,hasSelection:ey,prettifyQuery:e7,executeQuery:te,onDebug:ts})}),(0,s.jsx)(P.ee,{maxSize:10,minSize:10,className:"max-h-9",children:(null==e5?void 0:e5.rows)!==void 0&&!e6&&(0,s.jsxs)(f.x,{className:"flex items-center justify-between gap-2",children:[(0,s.jsxs)(V.u,{children:[(0,s.jsx)(V.aJ,{children:(0,s.jsxs)("p",{className:"text-xs",children:[(0,s.jsxs)("span",{className:"text-foreground",children:[e5.rows.length," row",e5.rows.length>1?"s":""]}),(0,s.jsx)("span",{className:"text-foreground-lighter ml-1",children:void 0!==e5.autoLimit&&" (Limited to only ".concat(e5.autoLimit," rows)")})]})}),(0,s.jsx)(V._v,{className:"max-w-xs",children:(0,s.jsxs)("p",{className:"flex flex-col gap-y-1",children:[(0,s.jsx)("span",{children:"Results are automatically limited to preserve browser performance, in particular if your query returns an exceptionally large number of rows."}),(0,s.jsx)("span",{className:"text-foreground-light",children:"You may change or remove this limit from the dropdown on the right"})]})})]}),void 0!==e5.autoLimit&&(0,s.jsxs)(G.h_,{children:[(0,s.jsx)(G.$F,{asChild:!0,children:(0,s.jsxs)(Q.z,{type:"default",iconRight:(0,s.jsx)(u.Z,{size:14}),children:["Limit results to:"," ",null===(n=ez.Tu.find(e=>e.value===(ec?er.limit:ei.limit)))||void 0===n?void 0:n.label]})}),(0,s.jsx)(G.AW,{className:"w-40",align:"end",children:(0,s.jsx)(G._x,{value:ec?er.limit.toString():ei.limit.toString(),onValueChange:e=>{ec?er.setLimit(Number(e)):ei.setLimit(Number(e))},children:ez.Tu.map(e=>(0,s.jsx)(G.qB,{value:e.value.toString(),children:e.label},e.label))})})]})]})})]})}),(0,s.jsx)(P.Dp,{withHandle:!0}),(0,s.jsx)(P.ee,{ref:tl,collapsible:!0,collapsedSize:0,minSize:31,maxSize:40,onCollapse:()=>eT(!1),onExpand:()=>eT(!0),children:(0,s.jsx)(eR,{selectedMessage:ep,existingSql:(null===(i=ew.current)||void 0===i?void 0:i.getValue())||"",includeSchemaMetadata:eP,onDiff:tn,onClose:()=>{var e;return null===(e=tl.current)||void 0===e?void 0:e.collapse()}})})]})]})},tq=n(1728),tA=n(57663);function tR(e){return e.replace(/^\"/,"").replace(/\"$/,"").replace(/\"\"/,'"')}function tL(e){return e!=e.toLowerCase()?'"'.concat(e,'"'):e}var tI=n(18734),tD=n(7509),tZ=n(18592);let tz=()=>"\nSELECT word FROM pg_get_keywords();\n".trim(),tT=function(e){let{projectRef:t,connectionString:n}=e,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,tZ.cp)({projectRef:t,connectionString:n,sql:tz(),queryKey:["keywords"]},{select:e=>({result:e.result.map(e=>e.word.toLocaleLowerCase())}),...s})};var tF=n(49650),tO=n(39338);let tM=()=>{let e=(0,r.useRouter)(),t=(0,i.useMonaco)(),{id:n,ref:o,content:c}=(0,l.U)(),{project:d}=(0,e5.d2)(),u=(0,T.WZ)(),h=(0,M.W2)(),m=(0,W.B0)(),p=(0,M.Fy)(o),x=(0,R.P)("sqlFolderOrganization"),{mutateAsync:g}=(0,w.X)(),[f]=(0,E.l)(L.dA.SQL_EDITOR_INTELLISENSE,!0);async function v(e){try{if(!d)throw Error("No project");return(await g({projectRef:d.ref,connectionString:d.connectionString,sql:e})).result}catch(t){return console.error("formatPgsql error:",t),e}}(0,tI.N)({projectRef:o,id:n},{retry:!1,enabled:!!(x&&"new"!==n&&"function"==typeof m.addSnippet),onSuccess:e=>{m.addSnippet({projectRef:o,snippet:e})},onError:()=>{}});let{data:_,isSuccess:j}=tT({projectRef:null==d?void 0:d.ref,connectionString:null==d?void 0:d.connectionString},{enabled:f}),{data:b,isSuccess:y}=(0,tD.R)({projectRef:null==d?void 0:d.ref,connectionString:null==d?void 0:d.connectionString},{enabled:f}),{data:N,isSuccess:k}=(0,tF.Q)({projectRef:null==d?void 0:d.ref,connectionString:null==d?void 0:d.connectionString},{enabled:f}),{data:S,isSuccess:C}=(0,tO.K)({projectRef:null==d?void 0:d.ref,connectionString:null==d?void 0:d.connectionString},{enabled:f}),q=(0,a.useRef)(null),A=(0,a.useRef)(v);A.current=v;let I=f&&C&&k&&j&&y;return I&&(null===q.current&&(q.current={}),q.current.tableColumns=null==S?void 0:S.result,q.current.schemas=N,q.current.keywords=null==_?void 0:_.result,q.current.functions=b),(0,a.useEffect)(()=>{"new"===n&&void 0!==u.dashboardHistory.sql&&void 0===c&&void 0!==p.find(e=>e.id===u.dashboardHistory.sql)&&e.push("/project/".concat(o,"/sql/").concat(u.dashboardHistory.sql))},[n,p,c]),(0,a.useEffect)(()=>{if(t){let e=t.languages.registerDocumentFormattingEditProvider("pgsql",{async provideDocumentFormattingEdits(e){let t=e.getValue(),s=await A.current(t);return n&&h.setSql(n,s),[{range:e.getFullModelRange(),text:s}]}});return()=>e.dispose()}},[t]),(0,a.useEffect)(()=>{if(I){let e,n;return t&&I&&(e=t.languages.registerCompletionItemProvider("pgsql",{triggerCharacters:[" ",".",'"'],provideCompletionItems:function(e,n,s){try{let i=new tA.Z(e,n.column-2,n.lineNumber-1);if('"'===s.triggerCharacter)return function(e,t,n){let s=[];if(!n.isFowardDQuote())return{suggestions:s};if(n.next(),n.isNextPeriod()){let i=n.readIdent(),r=!1;i.match(/^\".*?\"$/)&&(r=!0,i=tR(i));let a=t.current.tableColumns.find(e=>r&&e.tablename===i||!r&&e.tablename.toLocaleLowerCase()==i.toLocaleLowerCase());if(!a)return{suggestions:s};a.columns.forEach(t=>{s.push({label:t.attname,kind:e.languages.CompletionItemKind.Property,detail:t.data_type,insertText:t.attname})})}else t.current.tableColumns.forEach(t=>{s.push({label:t.tablename,kind:e.languages.CompletionItemKind.Class,insertText:t.tablename})});return{suggestions:s}}(t,q,i);if("."===s.triggerCharacter)return function(e,t,n){let s=[],i=n.readIdents(3).map(e=>{let t=!1;return e.match(/^\".*?\"$/)&&(t=!0,e=tR(e)),{isQuoted:t,name:e}}),r=0,a=t.current.schemas.find(e=>{var t,n;let s=i&&i.length>r?i[r]:{};return s.isQuoted&&e.name===s.name||!s.isQuoted&&(null===(t=e.name)||void 0===t?void 0:t.toLocaleLowerCase())==(null===(n=s.name)||void 0===n?void 0:n.toLocaleLowerCase())});if(a?r++:a=t.current.schemas.find(e=>"public"==e.name),i.length==r)return t.current.tableColumns.forEach(t=>{t.schemaname==a.name&&s.push({label:t.tablename,kind:e.languages.CompletionItemKind.Class,detail:"public"!==t.schemaname?t.schemaname:null,insertText:tL(t.tablename)})}),{suggestions:s};let l=t.current.tableColumns.find(e=>{var t,n;let s=i&&i.length>r?i[r]:{};return e.schemaname==a.name&&s.isQuoted&&e.tablename===s.name||!s.isQuoted&&(null===(t=e.tablename)||void 0===t?void 0:t.toLocaleLowerCase())==(null===(n=s.name)||void 0===n?void 0:n.toLocaleLowerCase())});return l&&l.columns.forEach(t=>{s.push({label:t.attname,kind:e.languages.CompletionItemKind.Property,detail:t.data_type,insertText:tL(t.attname)})}),{suggestions:s}}(t,q,i);return function(e,t){var n,s,i,r;let a=[];return(null===(n=t.current.keywords)||void 0===n?void 0:n.length)>0&&t.current.keywords.forEach(t=>{a.push({label:t,kind:e.languages.CompletionItemKind.Keyword,insertText:t})}),(null===(s=t.current.schemas)||void 0===s?void 0:s.length)>0&&t.current.schemas.forEach(t=>{a.push({label:t.name,kind:e.languages.CompletionItemKind.Keyword,insertText:t.name})}),(null===(i=t.current.tableColumns)||void 0===i?void 0:i.length)>0&&t.current.tableColumns.forEach(t=>{let n="public"==t.schemaname?t.tablename:t.schemaname+"."+t.tablename;a.push({label:t.tablename,detail:"public"!==t.schemaname?t.schemaname:null,kind:t.is_table?e.languages.CompletionItemKind.Class:e.languages.CompletionItemKind.Interface,insertText:tL(n)}),t.columns.forEach(n=>{if(!n)return;let s=a.find(t=>t.label===(null==n?void 0:n.attname)&&t.kind===e.languages.CompletionItemKind.Field&&t.detail===(null==n?void 0:n.data_type));s?(s.tables.push(t.tablename),s.tables.sort(),s.documentation=s.tables.join(", ")):a.push({label:n.attname,kind:e.languages.CompletionItemKind.Field,detail:n.data_type,documentation:t.tablename,tables:[t.tablename],insertText:tL(n.attname)})})}),(null===(r=t.current.functions)||void 0===r?void 0:r.length)>0&&t.current.functions.forEach(t=>{a.push({label:t.name,kind:e.languages.CompletionItemKind.Function,detail:t.return_type,insertText:t.name})}),{suggestions:a}}(t,q)}catch(e){return{suggestions:[]}}}}),n=t.languages.registerSignatureHelpProvider("pgsql",{signatureHelpTriggerCharacters:["(",","],provideSignatureHelp:function(e,t){let n=new tA.Z(e,t.column-2,t.lineNumber-1),s=n.readArguments();if(s<0)return null;let i=n.readIdent();if(!i||i.match(/^\".*?\"$/))return null;let r=q.current.functions.find(e=>e.name.toLocaleLowerCase()===i.toLocaleLowerCase());if(!r||!r.args||r.args.length<s)return null;let a=Math.min(s,r.args.length-1),l=[];return l.push({label:"".concat(r.name,"(").concat(r.argument_types,")"),parameters:r.args.map(e=>({label:e.name}))}),{value:{signatures:l,activeSignature:0,activeParameter:a},dispose:()=>{}}}})),()=>{null==e||e.dispose(),null==n||n.dispose()}}},[I]),(0,s.jsx)("div",{className:"flex-1 overflow-auto",children:(0,s.jsx)(tC,{})})};tM.getLayout=e=>(0,s.jsx)(tq.Z,{title:"SQL",children:e});var tW=tM},71381:function(e,t,n){"use strict";n.d(t,{P:function(){return c}});var s=n(52322),i=n(45010),r=n(2784),a=n(54383),l=n(91316);let o=(0,r.forwardRef)((e,t)=>{let{className:n,value:i,...o}=e,c=(0,r.useRef)(null);return(0,r.useImperativeHandle)(t,()=>c.current),(0,r.useEffect)(()=>{if(c){if(c.current&&!i)c.current.style.height="40px";else if(c&&c.current){c.current.style.height="auto";let e=c.current.scrollHeight+"px";c.current.style.height=e}}},[i,c]),(0,s.jsx)(l.K,{ref:c,rows:1,"aria-expanded":!1,className:(0,a.cn)("transition-all resize-none leading-6 box-border",n),value:i,...o})});o.displayName="ExpandingTextArea";let c=r.forwardRef((e,t)=>{let{loading:n=!1,disabled:l=!1,value:c="",textAreaRef:d,commandsOpen:u=!1,icon:h=null,onValueChange:m,setCommandsOpen:p,onSubmit:x,placeholder:g,...f}=e,v=(0,r.useRef)(null),_=(0,r.useRef)(null);return(0,s.jsxs)("form",{ref:v,className:"relative",...f,onSubmit:x,children:[h&&(0,s.jsx)("div",{className:(0,a.cn)("absolute","top-2 left-2","ml-1 w-6 h-6 rounded-full bg-dbnew"),children:h}),(0,s.jsx)(o,{ref:d,autoFocus:!0,disabled:l,className:(0,a.cn)(h?"pl-12":"","text-sm pr-10 rounded-[18px]"),placeholder:g,spellCheck:!1,value:c,onChange:e=>m(e),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||u||(e.preventDefault(),_.current&&_.current.click()),"Enter"===e.key&&u&&p&&p(!1)}}),(0,s.jsxs)("div",{className:"absolute right-1.5 top-1.5 flex gap-3 items-center",children:[n&&(0,s.jsx)(i.Z,{size:22,className:"animate-spin w-7 h-7 text-muted",strokeWidth:1}),(0,s.jsx)("button",{ref:_,type:"submit",className:(0,a.cn)("transition-all","flex items-center justify-center w-7 h-7 border border-control rounded-full mr-0.5 p-1.5 background-alternative",c?"text-default opacity-100":"text-muted opacity-50",n&&"hidden"),children:(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.5 3V2.25H15V3V10C15 10.5523 14.5522 11 14 11H3.56062L5.53029 12.9697L6.06062 13.5L4.99996 14.5607L4.46963 14.0303L1.39641 10.9571C1.00588 10.5666 1.00588 9.93342 1.39641 9.54289L4.46963 6.46967L4.99996 5.93934L6.06062 7L5.53029 7.53033L3.56062 9.5H13.5V3Z",fill:"currentColor"})})})]})]})});c.displayName="AssistantChatForm"},69548:function(e,t,n){"use strict";n.d(t,{b:function(){return l}});var s=n(52322),i=n(2784),r=n(2322);let a=(0,i.forwardRef)((e,t)=>(0,s.jsx)("svg",{ref:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",...e,children:(0,s.jsx)("path",{"fill-rule":"evenodd",d:"M15 8A7 7 0 1 1 1 8a7 7 0 0 1 14 0ZM9 5a1 1 0 1 1-2 0 1 1 0 0 1 2 0ZM6.75 8a.75.75 0 0 0 0 1.5h.75v1.75a.75.75 0 0 0 1.5 0v-2.5A.75.75 0 0 0 8.25 8h-1.5Z","clip-rule":"evenodd"})})),l=(0,i.forwardRef)((e,t)=>{let{...n}=e;return(0,s.jsxs)(r.u,{children:[(0,s.jsx)(r.aJ,{type:"button",role:"button",className:"flex [&_svg]:data-[state=delayed-open]:fill-foreground-lighter [&_svg]:data-[state=instant-open]:fill-foreground-lighter",children:(0,s.jsx)(a,{strokeWidth:2,className:"transition-colors fill-foreground-muted w-4 h-4"})}),(0,s.jsx)(r._v,{...n})]})})},58898:function(e,t,n){"use strict";n.d(t,{d:function(){return k}});var s=n(52322),i=n(76141),r=n(94299),a=n(6659),l=n(2784),o=n(72282),c=n(90028),d=n(54383),u=n(32079);let h=e=>({hljs:{display:"block",overflowX:"auto",color:e?"#ddd":"#888"},"hljs-tag":{color:"#569cd6"},"hljs-keyword":{color:"#569cd6",fontWeight:"normal"},"hljs-selector-tag":{color:"#569cd6",fontWeight:"normal"},"hljs-literal":{color:"#569cd6",fontWeight:"normal"},"hljs-strong":{color:"#569cd6"},"hljs-name":{color:"#569cd6"},"hljs-code":{color:"#66d9ef"},"hljs-class .hljs-title":{color:"gray"},"hljs-attribute":{color:"#bf79db"},"hljs-symbol":{color:"#bf79db"},"hljs-regexp":{color:"#bf79db"},"hljs-link":{color:"#bf79db"},"hljs-string":{color:"#3ECF8E"},"hljs-bullet":{color:"#3ECF8E"},"hljs-subst":{color:"#3ECF8E"},"hljs-title":{color:"#3ECF8E",fontWeight:"normal"},"hljs-section":{color:"#3ECF8E",fontWeight:"normal"},"hljs-emphasis":{color:"#3ECF8E"},"hljs-type":{color:"#3ECF8E",fontWeight:"normal"},"hljs-built_in":{color:"#3ECF8E"},"hljs-builtin-name":{color:"#3ECF8E"},"hljs-selector-attr":{color:"#3ECF8E"},"hljs-selector-pseudo":{color:"#3ECF8E"},"hljs-addition":{color:"#3ECF8E"},"hljs-variable":{color:"#3ECF8E"},"hljs-template-tag":{color:"#3ECF8E"},"hljs-template-variable":{color:"#3ECF8E"},"hljs-comment":{color:e?"#999":"#888"},"hljs-quote":{color:"#75715e"},"hljs-deletion":{color:"#75715e"},"hljs-meta":{color:"#75715e"},"hljs-doctag":{fontWeight:"normal"},"hljs-selector-id":{fontWeight:"normal"}});var m=n(65820),p=n.n(m),x=n(27666),g=n(31806),f=n(88109),v=n(80039),_=n(86497),j=n(81303),b=n(83667),y=n(54299),N=n(14969),w=n(12463);let k=e=>{var t,n,m,k;let{title:E,language:S,linesToHighlight:C=[],highlightBorder:q,styleConfig:A,className:R,wrapperClassName:L,value:I,theme:D,children:Z,hideCopy:z=!1,hideLineNumbers:T=!1,renderer:F,focusable:O=!0}=e,{resolvedTheme:M}=(0,a.F)(),W=null==M?void 0:M.includes("dark"),P=null!=D?D:h(W),[U,K]=(0,l.useState)(!1),V=()=>{K(!0),setTimeout(()=>{K(!1)},1e3)},G=l.Children.toArray(Z),[Q]=1===G.length?G:[],B=null!==(n=null!=I?I:"string"==typeof Q?Q:void 0)&&void 0!==n?n:Z,H="string"==typeof(B=null!==(m=null==B?void 0:null===(t=B.trimEnd)||void 0===t?void 0:t.call(B))&&void 0!==m?m:B)&&B.length<70?"short-inline-codeblock":"",Y=S||(R?R.replace("language-",""):"js");"jsx"===Y&&(Y="js"),c.Z.registerLanguage("js",_.Z),c.Z.registerLanguage("ts",w.Z),c.Z.registerLanguage("py",y.Z),c.Z.registerLanguage("sql",N.Z),c.Z.registerLanguage("bash",x.Z),c.Z.registerLanguage("dart",f.Z),c.Z.registerLanguage("csharp",g.Z),c.Z.registerLanguage("json",j.Z),c.Z.registerLanguage("kotlin",b.Z),c.Z.registerLanguage("curl",p()),c.Z.registerLanguage("http",v.Z),("bash"===Y||"sh"===Y)&&(T=!0);let X=!T;return(0,s.jsxs)(s.Fragment,{children:[E&&(0,s.jsx)("div",{className:"text-sm rounded-t-md bg-surface-100 py-2 px-4 border border-b-0 border-default font-sans",children:E}),R?(0,s.jsxs)("div",{className:(0,d.cn)("group relative max-w-[90vw] md:max-w-none overflow-auto",L),children:[(0,s.jsx)(c.Z,{language:Y,wrapLines:!0,style:P,className:(0,d.cn)("code-block border border-surface p-4 w-full !my-0 !bg-surface-100 outline-none focus:border-foreground-lighter/50","".concat(E?"!rounded-t-none !rounded-b-md":"!rounded-md"),"".concat(X?"":"pl-6"),R),customStyle:{fontSize:13,lineHeight:1.4},showLineNumbers:X,lineProps:e=>C.includes(e)?{style:{display:"block",backgroundColor:(null==A?void 0:A.highlightBackgroundColor)?null==A?void 0:A.highlightBackgroundColor:"hsl(var(--background-selection))",borderLeft:q?"1px solid ".concat((null==A?void 0:A.highlightBorderColor)?null==A?void 0:A.highlightBorderColor:"hsl(var(--foreground-default)",")"):null},class:"hljs-line-highlight"}:{},lineNumberContainerStyle:{paddingTop:"128px"},lineNumberStyle:{minWidth:"44px",paddingLeft:"4px",paddingRight:"4px",marginRight:"12px",color:null!==(k=null==A?void 0:A.lineNumber)&&void 0!==k?k:"#828282",textAlign:"center",fontSize:12,paddingTop:"4px",paddingBottom:"4px"},renderer:F,contentEditable:O,onBeforeInput:e=>(e.preventDefault(),!1),suppressContentEditableWarning:!0,children:B}),!z&&(I||Z)&&R?(0,s.jsx)("div",{className:["absolute right-2 top-2","opacity-0 group-hover:opacity-100 transition","".concat(W?"dark":"")].join(" "),children:(0,s.jsx)(o.CopyToClipboard,{text:I||Z,children:(0,s.jsx)(u.z,{type:"default",className:"px-1.5",icon:U?(0,s.jsx)(i.Z,{}):(0,s.jsx)(r.Z,{}),onClick:()=>V(),children:U?"Copied":""})})}):null]}):(0,s.jsx)("code",{className:H,children:I||Z})]})}},62949:function(e,t,n){"use strict";n.d(t,{Bw:function(){return _},DI:function(){return m},Ph:function(){return h},Ql:function(){return b},U$:function(){return y},i4:function(){return g},ki:function(){return p},n5:function(){return j}});var s=n(52322),i=n(38947),r=n(78232),a=n(20670),l=n(76141),o=n(2784),c=n(54383),d=n(10929),u=n(75109);let h=i.fC,m=i.ZA,p=i.B4,x=(0,d.j)("",{variants:{size:{...u.Ld}},defaultVariants:{size:u.Rc}}),g=o.forwardRef((e,t)=>{let{className:n,children:a,size:l,...o}=e;return(0,s.jsxs)(i.xz,{ref:t,className:(0,c.cn)("flex w-full items-center justify-between rounded-md border border-strong hover:border-stronger bg-alternative dark:bg-muted hover:bg-selection text-xs ring-offset-background-control placeholder:text-foreground-muted focus:outline-none ring-border-control focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all duration-200","data-[state=open]:bg-selection data-[state=open]:border-stronger",x({size:l}),n),...o,children:[a,(0,s.jsx)(i.JO,{asChild:!0,children:(0,s.jsx)(r.Z,{className:"h-4 w-4 text-foreground-muted"})})]})});g.displayName=i.xz.displayName;let f=o.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,s.jsx)(i.u_,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1 text-foreground-muted",n),...r,children:(0,s.jsx)(a.Z,{className:"h-4 w-4"})})});f.displayName=i.u_.displayName;let v=o.forwardRef((e,t)=>{let{className:n,...a}=e;return(0,s.jsx)(i.$G,{ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1 text-foreground-muted",n),...a,children:(0,s.jsx)(r.Z,{className:"h-4 w-4"})})});v.displayName=i.$G.displayName;let _=o.forwardRef((e,t)=>{let{className:n,children:r,position:a="popper",...l}=e;return(0,s.jsx)(i.h_,{children:(0,s.jsxs)(i.VY,{ref:t,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-overlay text-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===a&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",n),position:a,...l,children:[(0,s.jsx)(f,{}),(0,s.jsx)(i.l_,{className:(0,c.cn)("p-1","popper"===a&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,s.jsx)(v,{})]})})});_.displayName=i.VY.displayName;let j=o.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,s.jsx)(i.__,{ref:t,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-xs text-foreground-lighter/75 uppercase tracking-wider font-mono",n),...r})});j.displayName=i.__.displayName;let b=o.forwardRef((e,t)=>{let{className:n,children:r,...a}=e;return(0,s.jsxs)(i.ck,{ref:t,className:(0,c.cn)("group","relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-overlay-hover text-foreground-light focus:text-foreground data-[state=checked]:text-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n),...a,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(i.wU,{className:"h-3.5 w-3.5 bg-foreground rounded-full flex justify-center items-center",children:(0,s.jsx)(l.Z,{className:"h-2 w-2 text-background-overlay",strokeWidth:6})})}),(0,s.jsx)(i.eT,{children:r})]})});b.displayName=i.ck.displayName;let y=o.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,s.jsx)(i.Z0,{ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-border-overlay",n),...r})});y.displayName=i.Z0.displayName},93705:function(e,t,n){"use strict";n.d(t,{r:function(){return d}});var s=n(52322),i=n(16530),r=n(10929),a=n(2784),l=n(54383);let o=(0,r.j)("peer inline-flex shrink-0 cursor-pointer items-center rounded-full border transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-brand data-[state=checked]:hover:bg-brand-600/90 data-[state=unchecked]:bg-control data-[state=unchecked]:hover:bg-border",{variants:{size:{small:"h-[16px] w-[28px]",medium:"h-[20px] w-[34px]",large:"h-[24px] w-[44px]"}},defaultVariants:{size:"medium"}}),c=(0,r.j)("pointer-events-none block rounded-full bg-foreground-lighter data-[state=checked]:bg-white shadow-lg ring-0 transition-transform",{variants:{size:{small:"h-[12px] w-[12px] data-[state=checked]:translate-x-[13px] data-[state=unchecked]:translate-x-[1px]",medium:"h-[16px] w-[16px] data-[state=checked]:translate-x-[15px] data-[state=unchecked]:translate-x-[1px]",large:"h-[18px] w-[18px] data-[state=checked]:translate-x-[22px] data-[state=unchecked]:translate-x-[3px]"}},defaultVariants:{size:"medium"}}),d=a.forwardRef((e,t)=>{let{className:n,size:r,...a}=e;return(0,s.jsx)(i.fC,{className:(0,l.cn)(o({size:r}),n),...a,ref:t,children:(0,s.jsx)(i.bU,{className:(0,l.cn)(c({size:r}))})})});d.displayName=i.fC.displayName},91316:function(e,t,n){"use strict";n.d(t,{K:function(){return l}});var s=n(52322),i=n(2784),r=n(54383);let a=["bg-control"],l=i.forwardRef((e,t)=>{let{className:n,...i}=e;return(0,s.jsx)("textarea",{className:(0,r.cn)("flex min-h-10 w-full rounded-md border border-control bg-control px-3 py-2 text-sm file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-foreground-muted","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-background-control focus-visible:ring-offset-2 focus-visible:ring-offset-foreground-muted disabled:cursor-not-allowed disabled:opacity-50",...a,n),ref:t,...i})});l.displayName="TextArea"},54849:function(e,t,n){"use strict";n.d(t,{c:function(){return o}});var s=n(52322),i=n(84792),r=n.n(i),a=n(2784),l=n(54383);let o=e=>{let{loading:t=!1,className:n,allowHoverEffect:i=!1}=e,[o,c]=(0,a.useState)(1),[d,u]=(0,a.useState)(1),[h,m]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{let e=setInterval(()=>{t&&(m(!0),c(e=>e%5+1),u(e=>e%5+1))},500);return()=>clearInterval(e)},[t]),(0,a.useEffect)(()=>{!1===t&&(setTimeout(()=>{m(!1)},500),c(1))},[t]),(0,s.jsx)("div",{className:(0,l.cn)(r()["ai-icon__container"],i&&r()["ai-icon__container--allow-hover-effect"],t&&h&&r()["spin-ai-icon-container"],n),children:(0,s.jsxs)("div",{className:(0,l.cn)(r()["ai-icon__grid"]),children:[(0,s.jsx)("div",{className:(0,l.cn)(r()["ai-icon__grid__square"],t?r()["ai-icon__grid__square--step-".concat(o)]:h?r()["ai-icon__grid__square--exiting--step-".concat(d)]:r()["ai-icon__grid__square--static"])}),(0,s.jsx)("div",{className:(0,l.cn)(r()["ai-icon__grid__square"],t?r()["ai-icon__grid__square--step-".concat(o)]:h?r()["ai-icon__grid__square--exiting--step-".concat(d)]:r()["ai-icon__grid__square--static"])}),(0,s.jsx)("div",{className:(0,l.cn)(r()["ai-icon__grid__square"],t?r()["ai-icon__grid__square--step-".concat(o)]:h?r()["ai-icon__grid__square--exiting--step-".concat(d)]:r()["ai-icon__grid__square--static"])}),(0,s.jsx)("div",{className:(0,l.cn)(r()["ai-icon__grid__square"],t?r()["ai-icon__grid__square--step-".concat(o)]:h?r()["ai-icon__grid__square--exiting--step-".concat(d)]:r()["ai-icon__grid__square--static"])})]})})}},73071:function(e,t,n){"use strict";n.d(t,{t:function(){return c}});var s=n(52322),i=n(58898),r=n(96577),a=n.n(r),l=n(54383);let o=e=>(0,s.jsx)("span",{className:(0,l.cn)("next-image--dynamic-fill",e.className),children:(0,s.jsx)(a(),{...e,className:"rounded-md border",layout:"fill"})}),c={mono:e=>(0,s.jsx)("code",{className:"text-sm",children:e.children}),code:e=>(0,s.jsx)(i.d,{...e}),img:e=>o(e),Image:e=>o(e)}},84792:function(e){e.exports={"spin-ai-icon-container":"ai-icon-animation-style_spin-ai-icon-container__7sgAA",spinAiIconContainer:"ai-icon-animation-style_spinAiIconContainer__rBP6P","ai-icon__container":"ai-icon-animation-style_ai-icon__container__2aXBS","ai-icon__grid":"ai-icon-animation-style_ai-icon__grid__Qrwxf","ai-icon__grid__square":"ai-icon-animation-style_ai-icon__grid__square__YU8EZ","ai-icon__grid__square--static":"ai-icon-animation-style_ai-icon__grid__square--static__1tOM_","ai-icon__container--allow-hover-effect":"ai-icon-animation-style_ai-icon__container--allow-hover-effect__HrB86","ai-icon__grid__square--step-1":"ai-icon-animation-style_ai-icon__grid__square--step-1__KATlI",step1_square1:"ai-icon-animation-style_step1_square1__BIjL3",step1_square2:"ai-icon-animation-style_step1_square2__QzsE7",step1_square3:"ai-icon-animation-style_step1_square3__ls1SO",step1_square4:"ai-icon-animation-style_step1_square4__Kk8zi","ai-icon__grid__square--step-2":"ai-icon-animation-style_ai-icon__grid__square--step-2__9OoIG",step2_square1:"ai-icon-animation-style_step2_square1__o_hcu",step2_square2:"ai-icon-animation-style_step2_square2__HBZt7",step2_square3:"ai-icon-animation-style_step2_square3__K6E2K",step2_square4:"ai-icon-animation-style_step2_square4__oDGDL","ai-icon__grid__square--step-3":"ai-icon-animation-style_ai-icon__grid__square--step-3__RldL4",step3_square1:"ai-icon-animation-style_step3_square1__Oo6vT",step3_square2:"ai-icon-animation-style_step3_square2__36Os9",step3_square3:"ai-icon-animation-style_step3_square3__Nj5rc",step3_square4:"ai-icon-animation-style_step3_square4__OFVFh","ai-icon__grid__square--step-4":"ai-icon-animation-style_ai-icon__grid__square--step-4__7o69c",step4_square1:"ai-icon-animation-style_step4_square1__G_8pn",step4_square2:"ai-icon-animation-style_step4_square2__KHYf3",step4_square3:"ai-icon-animation-style_step4_square3__XON12",step4_square4:"ai-icon-animation-style_step4_square4__Aq8dV","ai-icon__grid__square--step-5":"ai-icon-animation-style_ai-icon__grid__square--step-5__cF2Rx",step5_square1:"ai-icon-animation-style_step5_square1__me9Ru",step5_square2:"ai-icon-animation-style_step5_square2__0Ydfw",step5_square3:"ai-icon-animation-style_step5_square3__bOHqW",step5_square4:"ai-icon-animation-style_step5_square4__m2l32","ai-icon__grid__square--exiting--step-1":"ai-icon-animation-style_ai-icon__grid__square--exiting--step-1__JYREY",exit_step1_square1:"ai-icon-animation-style_exit_step1_square1__C_GBC",exit_step1_square2:"ai-icon-animation-style_exit_step1_square2__TID0l",exit_step1_square3:"ai-icon-animation-style_exit_step1_square3__ADmUT",exit_step1_square4:"ai-icon-animation-style_exit_step1_square4__kilu_","ai-icon__grid__square--exiting--step-2":"ai-icon-animation-style_ai-icon__grid__square--exiting--step-2__kDUVt",exit_step2_square1:"ai-icon-animation-style_exit_step2_square1__vmYa5",exit_step2_square2:"ai-icon-animation-style_exit_step2_square2__zxv0q",exit_step2_square3:"ai-icon-animation-style_exit_step2_square3__Dhey5",exit_step2_square4:"ai-icon-animation-style_exit_step2_square4__P1UKx","ai-icon__grid__square--exiting--step-3":"ai-icon-animation-style_ai-icon__grid__square--exiting--step-3__h48Ts",exit_step3_square1:"ai-icon-animation-style_exit_step3_square1__l1FKu",exit_step3_square2:"ai-icon-animation-style_exit_step3_square2__4RPQL",exit_step3_square3:"ai-icon-animation-style_exit_step3_square3__s2vMz",exit_step3_square4:"ai-icon-animation-style_exit_step3_square4__Zros9","ai-icon__grid__square--exiting--step-4":"ai-icon-animation-style_ai-icon__grid__square--exiting--step-4__VEmk_",exit_step4_square1:"ai-icon-animation-style_exit_step4_square1__bG99O",exit_step4_square2:"ai-icon-animation-style_exit_step4_square2__1Fxvf",exit_step4_square3:"ai-icon-animation-style_exit_step4_square3__EWeB7",exit_step4_square4:"ai-icon-animation-style_exit_step4_square4__HC5ov","ai-icon__grid__square--exiting--step-5":"ai-icon-animation-style_ai-icon__grid__square--exiting--step-5___9jFB",exit_step5_square1:"ai-icon-animation-style_exit_step5_square1__w4ctB",exit_step5_square2:"ai-icon-animation-style_exit_step5_square2__UZdas",exit_step5_square3:"ai-icon-animation-style_exit_step5_square3__O_mvc",exit_step5_square4:"ai-icon-animation-style_exit_step5_square4__SKL7Z"}}},function(e){e.O(0,[9774,8421,8183,6334,5746,1357,2474,5590,6128,6875,7280,2569,3153,5700,4298,6647,9979,7370,2784,3111,5539,6012,1684,125,1659,5487,8507,9428,5029,4689,1650,1728,2888,179],function(){return e(e.s=40936)}),_N_E=e.O()}]);