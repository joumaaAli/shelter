"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6919],{82366:function(e,a,t){t.d(a,{h:function(){return u}});var s=t(52322),n=t(28879),i=t.n(n),r=t(4787),l=t(31310),o=t(26198),d=t(49251),c=t(750),u=e=>{let{selectedLog:a,onClose:t}=e,{data:n}=(0,o.Sy)(),{data:u}=(0,l.tl)();return null==n||n.find(e=>e.ref===(null==a?void 0:a.target.metadata.project_ref)),null==u||u.find(e=>e.slug===(null==a?void 0:a.target.metadata.org_slug)),(0,s.jsxs)(d.ZP,{size:"large",header:'"'.concat(null==a?void 0:a.action.name,'" on ').concat(i()(null==a?void 0:a.occurred_at).format("DD MMM YYYY, HH:mm:ss")),visible:void 0!==a,onCancel:t,cancelText:"Close",children:[(0,s.jsx)(r.hj,{header:(0,s.jsx)(r.S0,{children:"General"}),children:(0,s.jsx)(r.B4,{loading:!1,children:(0,s.jsx)(c.Z,{readOnly:!0,size:"small",label:"Occurred at",value:null==a?void 0:a.occurred_at,descriptionText:i()(null==a?void 0:a.occurred_at).format("DD MMM YYYY, HH:mm:ss (ZZ)")})})}),(0,s.jsx)(d.ZP.Separator,{}),(0,s.jsx)(r.hj,{header:(0,s.jsx)(r.S0,{children:"Actor"}),children:(0,s.jsxs)(r.B4,{loading:!1,children:[(0,s.jsx)(c.Z,{readOnly:!0,size:"small",label:"Actor ID",value:null==a?void 0:a.actor.id}),(0,s.jsx)(c.Z.TextArea,{readOnly:!0,size:"small",label:"Metadata",rows:5,className:"input-mono input-xs",value:JSON.stringify(null==a?void 0:a.actor.metadata,null,2)})]})}),(0,s.jsx)(d.ZP.Separator,{}),(0,s.jsx)(r.hj,{header:(0,s.jsx)(r.S0,{children:"Action"}),children:(0,s.jsxs)(r.B4,{loading:!1,children:[(0,s.jsx)(c.Z,{readOnly:!0,size:"small",label:"Name",value:null==a?void 0:a.action.name}),(0,s.jsx)(c.Z.TextArea,{readOnly:!0,size:"small",label:"Metadata",rows:5,className:"input-mono input-xs",value:JSON.stringify(null==a?void 0:a.action.metadata,null,2)})]})}),(0,s.jsx)(d.ZP.Separator,{}),(0,s.jsx)(r.hj,{header:(0,s.jsx)(r.S0,{children:"Target"}),children:(0,s.jsxs)(r.B4,{loading:!1,children:[(0,s.jsx)(c.Z,{readOnly:!0,size:"small",label:"Name",value:null==a?void 0:a.target.description}),(0,s.jsx)(c.Z.TextArea,{readOnly:!0,size:"small",label:"Metadata",rows:5,className:"input-mono input-xs",value:JSON.stringify(null==a?void 0:a.target.metadata,null,2)})]})})]})}},46216:function(e,a,t){var s=t(52322),n=t(82137),i=t(39097),r=t.n(i),l=t(61531),o=t(26198),d=t(93463);a.Z=e=>{var a;let{organization:t}=e,{data:i}=(0,o.Sy)({}),c=null!==(a=null==i?void 0:i.filter(e=>e.organization_id===(null==t?void 0:t.id)).length)&&void 0!==a?a:0,{data:u}=(0,d.Gl)({orgSlug:null==t?void 0:t.slug});return c>0||(null==u?void 0:u.plan)===void 0||"free"===u.plan.id||"enterprise"===u.plan.id?null:(0,s.jsx)(l.Z,{defaultVisibility:!0,hideCollapse:!0,title:"Your organization is on the ".concat(u.plan.name," plan with no projects running"),icon:(0,s.jsx)(n.Z,{strokeWidth:2}),description:(0,s.jsxs)("div",{children:["The monthly fees for the paid plan still apply. To cancel your subscription, head over to your"," ",(0,s.jsx)(r(),{href:"/org/".concat(null==t?void 0:t.slug,"/billing"),className:"text-sm text-green-900 transition hover:text-green-1000",children:"organization billing settings ."})]})})}},2320:function(e,a,t){var s=t(52322),n=t(2322);a.Z=e=>{let{projectUpdateDisabled:a,projectNotActive:t=!1,children:i,tooltip:r}=e;return(0,s.jsxs)(n.u,{children:[(0,s.jsx)(n.aJ,{asChild:!0,children:i}),(a||t)&&(0,s.jsx)(n._v,{side:"bottom",className:"w-72 text-center",children:a?r||"Subscription changes are currently disabled. Our engineers are working on a fix.":t?"Unable to update subscription as project is currently not active":""})]})}},28043:function(e,a,t){t.d(a,{Z:function(){return c}});var s=t(52322),n=t(39097),i=t.n(n),r=t(55283),l=t(54383),o=t(2784),d=t(91179);function c(e){let{className:a}=e,[t,n]=(0,o.useState)(!1);return(0,s.jsxs)(r.zF,{open:t,onOpenChange:n,className:(0,l.cn)("mt-4",a),children:[(0,s.jsx)(r.wy,{asChild:!0,children:(0,s.jsxs)("div",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,s.jsx)(d.Z,{strokeWidth:2,size:16,className:(0,l.cn)("transition-all",t?"rotate-90":"")}),(0,s.jsx)("p",{className:"text-sm text-foreground-light underline",children:"Important information regarding opting in"})]})}),(0,s.jsx)(r.Fw,{children:(0,s.jsxs)("div",{className:"space-y-2 py-4 text-sm text-foreground-light",children:[(0,s.jsx)("p",{children:"Supabase AI is a chatbot support tool powered by OpenAI. Supabase will share the query you submit and information about the databases you manage through Supabase with OpenAI, L.L.C. and its affiliates in order to provide the Supabase AI tool."}),(0,s.jsx)("p",{children:"OpenAI will only access information about the structure of your databases, such as table names, column and row headings. OpenAI will not access the contents of the database itself."}),(0,s.jsx)("p",{children:"OpenAI uses this information to generate responses to your query, and does not retain or use the information to train its algorithms or otherwise improve its products and services."}),(0,s.jsx)("p",{children:"If you have your own individual account on Supabase, we will use any personal information collected through [Supabase AI] to provide you with the [Supabase AI] tool. If you are in the UK, EEA or Switzerland, the processing of this personal information is necessary for the performance of a contract between you and us."}),(0,s.jsx)("p",{children:"Supabase collects information about the queries you submit through Supabase AI and the responses you receive to assess the performance of the Supabase AI tool and improve our services. If you are in the UK, EEA or Switzerland, the processing is necessary for our legitimate interests, namely informing our product development and improvement."}),(0,s.jsxs)("p",{children:["For more information about how we use personal information, please see our"," ",(0,s.jsx)(i(),{href:"https://supabase.com/privacy",target:"_blank",rel:"noreferrer",className:"text-brand border-b border-brand",children:"privacy policy"}),"."]})]})})]})}},41421:function(e,a,t){var s=t(52322),n=t(59491),i=t(76141);let r=e=>{let{description:a,hasReadScope:t,hasWriteScope:n}=e;if(t||n){let e=[t?"Read":null,n?"Write":null].filter(Boolean).map(e=>(0,s.jsx)("span",{className:"font-semibold text-foreground",children:e},e)).reduce((e,a)=>(0,s.jsxs)(s.Fragment,{children:[e,(0,s.jsx)("span",{children:" and "}),a]}));return(0,s.jsxs)("div",{className:"first:border-t border-b flex flex-row space-x-1 text-sm text-foreground-light py-2 px-1",children:[(0,s.jsx)("div",{className:"pt-0.5",children:(0,s.jsx)(i.Z,{stroke:"green",height:18,width:18,strokeWidth:1.5})}),(0,s.jsxs)("div",{children:[e," ",a]})]})}return null};a.Z=e=>{let{icon:a,name:t,domain:i,scopes:l}=e;return(0,s.jsxs)("div",{className:"flex gap-y-4 flex-col",children:[(0,s.jsxs)("div",{className:"flex flex-row gap-x-4 items-center",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)("div",{className:"w-14 h-14 md:w-16 md:h-16 bg-center bg-no-repeat bg-cover flex items-center justify-center rounded-md border border-control",style:{backgroundImage:a?"url('".concat(a,"')"):"none"},children:!a&&(0,s.jsx)("p",{className:"text-foreground-light text-lg",children:t[0]})})}),(0,s.jsxs)("p",{className:"text-foreground",children:[t," (",i,") is requesting API access to an organization."]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{children:"Permissions"}),(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:["The following scopes will apply for the"," ",(0,s.jsx)("span",{className:"text-amber-900",children:"selected organization and all of its projects."})]}),(0,s.jsxs)("div",{className:"pt-2",children:[(0,s.jsx)(r,{description:"access to auth configurations and SSO providers.",hasReadScope:l.includes(n.YX.AUTH_READ),hasWriteScope:l.includes(n.YX.AUTH_WRITE)}),(0,s.jsx)(r,{description:"access to Postgres configurations, SQL snippets, SSL enforcement configurations and Typescript schema types.",hasReadScope:l.includes(n.YX.DATABASE_READ),hasWriteScope:l.includes(n.YX.DATABASE_WRITE)}),(0,s.jsx)(r,{description:"access to custom domains and vanity subdomains.",hasReadScope:l.includes(n.YX.DOMAINS_READ),hasWriteScope:l.includes(n.YX.DOMAINS_WRITE)}),(0,s.jsx)(r,{description:"access to edge functions.",hasReadScope:l.includes(n.YX.EDGE_FUNCTIONS_READ),hasWriteScope:l.includes(n.YX.EDGE_FUNCTIONS_WRITE)}),(0,s.jsx)(r,{description:"access to environments/branches.",hasReadScope:l.includes(n.YX.ENVIRONMENT_READ),hasWriteScope:l.includes(n.YX.ENVIRONMENT_WRITE)}),(0,s.jsx)(r,{description:"access to the organization and all its members.",hasReadScope:l.includes(n.YX.ORGANIZATIONS_READ),hasWriteScope:l.includes(n.YX.ORGANIZATIONS_WRITE)}),(0,s.jsx)(r,{description:"access to metadata, its upgrade status, network restrictions and network bans.",hasReadScope:l.includes(n.YX.PROJECTS_READ),hasWriteScope:l.includes(n.YX.PROJECTS_WRITE)}),(0,s.jsx)(r,{description:"access to PostgREST configurations.",hasReadScope:l.includes(n.YX.REST_READ),hasWriteScope:l.includes(n.YX.REST_WRITE)}),(0,s.jsx)(r,{description:"access to API keys, secrets and pgsodium configurations.",hasReadScope:l.includes(n.YX.SECRETS_READ),hasWriteScope:l.includes(n.YX.SECRETS_WRITE)}),(0,s.jsx)(r,{description:"access to storage buckets and files.",hasReadScope:l.includes(n.YX.STORAGE_READ),hasWriteScope:l.includes(n.YX.STORAGE_WRITE)})]})]})]})}},66919:function(e,a,t){t.d(a,{yV:function(){return sg},IV:function(){return aJ},d2:function(){return nK},q$:function(){return a7},iB:function(){return tu},ny:function(){return tw},G3:function(){return tk},ZI:function(){return sQ},cN:function(){return nG},l1:function(){return t9}});var s,n,i=t(52322),r=t(99959),l=t(74178),o=t(40654),d=t(93463),c=t(59491),u=t(2784),m=t(56958),p=t(56006),h=t(6554),x=t(67873),g=t(4787),j=t(14782),v=t(81073),f=t(41679),y=t(36492),b=t(31696),N=t(87175),w=t(91160);async function _(e,a){let{slug:t}=e;if(!t)throw Error("slug is required");let{data:s,error:n}=await (0,b.U2)("/platform/organizations/{slug}/customer",{params:{path:{slug:t}},signal:a});return n&&(0,b.S3)(n),s}let S=function(e){let{slug:a}=e,{enabled:t=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,N.Xo)(c.KA.BILLING_READ,"stripe.customer");return(0,y.a)(w.O.customerProfile(a),e=>{let{signal:t}=e;return _({slug:a},t)},{enabled:t&&n&&void 0!==a,...s})};var C=t(85945),I=t(48228);async function A(e){let{slug:a,address:t}=e;if(!a)return console.error("Slug is required");let{data:s,error:n}=await (0,b.gz)("/platform/organizations/{slug}/customer",{params:{path:{slug:a}},body:{address:t}});if(n)throw(0,b.S3)(n);return s}let Z=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,I.D)(e=>A(e),{async onSuccess(a,t,n){let{address:i,slug:r}=t;s.setQueriesData(w.O.customerProfile(r),e=>e?{...e,address:i}:e),await (null==e?void 0:e(a,t,n))},async onError(e,t,s){void 0===a?m.Am.error("Failed to update customer profile: ".concat(e.message)):a(e,t,s)},...t})};var z=t(89823),E=t(62277),k=t(750),T=t(62284);let P=[{code:"AF",name:"Afghanistan"},{code:"AL",name:"Albania"},{code:"DZ",name:"Algeria"},{code:"AS",name:"American Samoa"},{code:"AD",name:"Andorra"},{code:"AO",name:"Angola"},{code:"AI",name:"Anguilla"},{code:"AQ",name:"Antarctica"},{code:"AG",name:"Antigua and Barbuda"},{code:"AR",name:"Argentina"},{code:"AM",name:"Armenia"},{code:"AW",name:"Aruba"},{code:"AU",name:"Australia"},{code:"AT",name:"Austria"},{code:"AZ",name:"Azerbaijan"},{code:"BS",name:"Bahamas"},{code:"BH",name:"Bahrain"},{code:"BD",name:"Bangladesh"},{code:"BB",name:"Barbados"},{code:"BY",name:"Belarus"},{code:"BE",name:"Belgium"},{code:"BZ",name:"Belize"},{code:"BJ",name:"Benin"},{code:"BM",name:"Bermuda"},{code:"BT",name:"Bhutan"},{code:"BO",name:"Bolivia"},{code:"BA",name:"Bosnia and Herzegovina"},{code:"BW",name:"Botswana"},{code:"BV",name:"Bouvet Island"},{code:"BR",name:"Brazil"},{code:"IO",name:"British Indian Ocean Territory"},{code:"VG",name:"British Virgin Islands"},{code:"BN",name:"Brunei Darussalam"},{code:"BG",name:"Bulgaria"},{code:"BF",name:"Burkina Faso"},{code:"BI",name:"Burundi"},{code:"KH",name:"Cambodia"},{code:"CM",name:"Cameroon"},{code:"CA",name:"Canada"},{code:"CV",name:"Cape Verde"},{code:"KY",name:"Cayman Islands"},{code:"CF",name:"Central African Republic"},{code:"TD",name:"Chad"},{code:"CL",name:"Chile"},{code:"CN",name:"China"},{code:"CX",name:"Christmas Island"},{code:"CC",name:"Cocos (Keeling) Islands"},{code:"CO",name:"Colombia"},{code:"KM",name:"Comoros"},{code:"CG",name:"Congo"},{code:"CK",name:"Cook Islands"},{code:"CR",name:"Costa Rica"},{code:"HR",name:"Croatia"},{code:"CU",name:"Cuba"},{code:"CW",name:"Cura\xe7ao"},{code:"CY",name:"Cyprus"},{code:"CZ",name:"Czech Republic"},{code:"CI",name:"C\xf4te d'Ivoire"},{code:"DK",name:"Denmark"},{code:"DJ",name:"Djibouti"},{code:"DM",name:"Dominica"},{code:"DO",name:"Dominican Republic"},{code:"EC",name:"Ecuador"},{code:"EG",name:"Egypt"},{code:"SV",name:"El Salvador"},{code:"GQ",name:"Equatorial Guinea"},{code:"ER",name:"Eritrea"},{code:"EE",name:"Estonia"},{code:"SZ",name:"Eswatini"},{code:"ET",name:"Ethiopia"},{code:"FK",name:"Falkland Islands"},{code:"FO",name:"Faroe Islands"},{code:"FJ",name:"Fiji"},{code:"FI",name:"Finland"},{code:"FR",name:"France"},{code:"GF",name:"French Guiana"},{code:"PF",name:"French Polynesia"},{code:"TF",name:"French Southern Territories"},{code:"GA",name:"Gabon"},{code:"GM",name:"Gambia"},{code:"GE",name:"Georgia"},{code:"DE",name:"Germany"},{code:"GH",name:"Ghana"},{code:"GI",name:"Gibraltar"},{code:"GR",name:"Greece"},{code:"GL",name:"Greenland"},{code:"GD",name:"Grenada"},{code:"GP",name:"Guadeloupe"},{code:"GU",name:"Guam"},{code:"GT",name:"Guatemala"},{code:"GG",name:"Guernsey"},{code:"GN",name:"Guinea"},{code:"GW",name:"Guinea-Bissau"},{code:"GY",name:"Guyana"},{code:"HT",name:"Haiti"},{code:"HM",name:"Heard & McDonald Islands"},{code:"HN",name:"Honduras"},{code:"HK",name:"Hong Kong"},{code:"HU",name:"Hungary"},{code:"IS",name:"Iceland"},{code:"IN",name:"India"},{code:"ID",name:"Indonesia"},{code:"IR",name:"Iran"},{code:"IQ",name:"Iraq"},{code:"IE",name:"Ireland"},{code:"IM",name:"Isle of Man"},{code:"IL",name:"Israel"},{code:"IT",name:"Italy"},{code:"JM",name:"Jamaica"},{code:"JP",name:"Japan"},{code:"JE",name:"Jersey"},{code:"JO",name:"Jordan"},{code:"KZ",name:"Kazakhstan"},{code:"KE",name:"Kenya"},{code:"KI",name:"Kiribati"},{code:"KW",name:"Kuwait"},{code:"KG",name:"Kyrgyzstan"},{code:"LA",name:"Laos"},{code:"LV",name:"Latvia"},{code:"LB",name:"Lebanon"},{code:"LS",name:"Lesotho"},{code:"LR",name:"Liberia"},{code:"LY",name:"Libya"},{code:"LI",name:"Liechtenstein"},{code:"LT",name:"Lithuania"},{code:"LU",name:"Luxembourg"},{code:"MO",name:"Macao"},{code:"MG",name:"Madagascar"},{code:"MW",name:"Malawi"},{code:"MY",name:"Malaysia"},{code:"MV",name:"Maldives"},{code:"ML",name:"Mali"},{code:"MT",name:"Malta"},{code:"MH",name:"Marshall Islands"},{code:"MQ",name:"Martinique"},{code:"MR",name:"Mauritania"},{code:"MU",name:"Mauritius"},{code:"YT",name:"Mayotte"},{code:"MX",name:"Mexico"},{code:"FM",name:"Micronesia"},{code:"MD",name:"Moldova"},{code:"MC",name:"Monaco"},{code:"MN",name:"Mongolia"},{code:"ME",name:"Montenegro"},{code:"MS",name:"Montserrat"},{code:"MA",name:"Morocco"},{code:"MZ",name:"Mozambique"},{code:"MM",name:"Myanmar"},{code:"NA",name:"Namibia"},{code:"NR",name:"Nauru"},{code:"NP",name:"Nepal"},{code:"NL",name:"Netherlands"},{code:"NC",name:"New Caledonia"},{code:"NZ",name:"New Zealand"},{code:"NI",name:"Nicaragua"},{code:"NE",name:"Niger"},{code:"NG",name:"Nigeria"},{code:"NU",name:"Niue"},{code:"NF",name:"Norfolk Island"},{code:"KP",name:"North Korea"},{code:"MK",name:"North Macedonia"},{code:"MP",name:"Northern Mariana Islands"},{code:"NO",name:"Norway"},{code:"OM",name:"Oman"},{code:"PK",name:"Pakistan"},{code:"PW",name:"Palau"},{code:"PS",name:"Palestinian Territories"},{code:"PA",name:"Panama"},{code:"PG",name:"Papua New Guinea"},{code:"PY",name:"Paraguay"},{code:"PE",name:"Peru"},{code:"PH",name:"Philippines"},{code:"PN",name:"Pitcairn Islands"},{code:"PL",name:"Poland"},{code:"PT",name:"Portugal"},{code:"PR",name:"Puerto Rico"},{code:"QA",name:"Qatar"},{code:"RO",name:"Romania"},{code:"RU",name:"Russia"},{code:"RW",name:"Rwanda"},{code:"RE",name:"R\xe9union"},{code:"BL",name:"Saint Barth\xe9lemy"},{code:"WS",name:"Samoa"},{code:"SM",name:"San Marino"},{code:"ST",name:"Sao Tome and Principe"},{code:"SA",name:"Saudi Arabia"},{code:"SN",name:"Senegal"},{code:"RS",name:"Serbia"},{code:"SC",name:"Seychelles"},{code:"SL",name:"Sierra Leone"},{code:"SG",name:"Singapore"},{code:"SX",name:"Sint Maarten"},{code:"SK",name:"Slovakia"},{code:"SI",name:"Slovenia"},{code:"SB",name:"Solomon Islands"},{code:"SO",name:"Somalia"},{code:"ZA",name:"South Africa"},{code:"GS",name:"South Georgia and the South Sandwich Islands"},{code:"KR",name:"South Korea"},{code:"SS",name:"South Sudan"},{code:"ES",name:"Spain"},{code:"LK",name:"Sri Lanka"},{code:"SH",name:"St Helena"},{code:"KN",name:"St Kitts and Nevis"},{code:"LC",name:"St Lucia"},{code:"MF",name:"St Martin"},{code:"PM",name:"St Pierre and Miquelon"},{code:"VC",name:"St Vincent and the Grenadines"},{code:"SD",name:"Sudan"},{code:"SR",name:"Suriname"},{code:"SJ",name:"Svalbard & Jan Mayen"},{code:"SE",name:"Sweden"},{code:"CH",name:"Switzerland"},{code:"SY",name:"Syria"},{code:"TW",name:"Taiwan"},{code:"TJ",name:"Tajikistan"},{code:"TZ",name:"Tanzania"},{code:"TH",name:"Thailand"},{code:"TL",name:"Timor-Leste"},{code:"TG",name:"Togo"},{code:"TK",name:"Tokelau"},{code:"TO",name:"Tonga"},{code:"TT",name:"Trinidad & Tobago"},{code:"TN",name:"Tunisia"},{code:"TR",name:"Turkey"},{code:"TM",name:"Turkmenistan"},{code:"TC",name:"Turks & Caicos Islands"},{code:"TV",name:"Tuvalu"},{code:"VI",name:"US Virgin Islands"},{code:"UG",name:"Uganda"},{code:"UA",name:"Ukraine"},{code:"AE",name:"United Arab Emirates"},{code:"GB",name:"United Kingdom"},{code:"US",name:"United States of America"},{code:"UY",name:"Uruguay"},{code:"UZ",name:"Uzbekistan"},{code:"VU",name:"Vanuatu"},{code:"VA",name:"Vatican City"},{code:"VE",name:"Venezuela"},{code:"VN",name:"Vietnam"},{code:"WF",name:"Wallis & Futuna"},{code:"EH",name:"Western Sahara"},{code:"YE",name:"Yemen"},{code:"ZM",name:"Zambia"},{code:"ZW",name:"Zimbabwe"},{code:"AX",name:"\xc5land Islands"}];var O=()=>{var e;let{slug:a}=(0,r.UO)(),t=(0,z.l)(),s=(0,N.Xo)(c.KA.BILLING_READ,"stripe.customer"),n=(0,N.Xo)(c.KA.BILLING_WRITE,"stripe.customer"),{data:o,error:d,isLoading:y,isSuccess:b,isError:w}=S({slug:a},{enabled:s}),{mutate:_,isLoading:C}=Z(),I="billing-address-form",{city:A,country:O,line1:R,line2:D,postal_code:L,state:M}=null!==(e=null==o?void 0:o.address)&&void 0!==e?e:{},U=async(e,t)=>{let{resetForm:s}=t;if(!a)return console.error("Slug is required");_({slug:a,address:e.line1?e:null},{onSuccess:()=>{m.Am.success("Successfully updated billing address"),s({values:e,initialValues:e})}})};return(0,i.jsxs)(l.jX,{children:[(0,i.jsx)(l.g$,{children:(0,i.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,i.jsx)("p",{className:"text-foreground text-base m-0",children:"Billing Address"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"This will be reflected in every upcoming invoice, past invoices are not affected"})]})}),(0,i.jsx)(l.Lc,{children:(null==t?void 0:t.managed_by)!==void 0&&(null==t?void 0:t.managed_by)!=="supabase"?(0,i.jsx)(v.Z,{partner:null==t?void 0:t.managed_by,resource:"Billing Addresses",cta:{installationId:null==t?void 0:t.partner_id}}):s?(0,i.jsxs)(i.Fragment,{children:[y&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(f.Z,{}),(0,i.jsx)(f.Z,{className:"w-3/4"}),(0,i.jsx)(f.Z,{className:"w-1/2"})]}),w&&(0,i.jsx)(p.Z,{subject:"Failed to retrieve organization customer profile",error:d}),b&&(0,i.jsx)(E.Z,{validateOnBlur:!0,id:I,initialValues:{city:A,country:O,line1:R,line2:D,postal_code:L,state:M},validate:e=>{let a={};return(e.line1||e.line2||e.postal_code||e.state||e.city)&&!e.country&&(a.country="Please select a country"),(e.country||e.line2||e.postal_code||e.state||e.city)&&!e.line1&&(a.line1="Please provide an address line"),a},onSubmit:U,children:e=>{let{values:a,initialValues:t,handleReset:s,resetForm:r}=e,l=JSON.stringify(a)!==JSON.stringify(t);return(0,u.useEffect)(()=>{if(b&&void 0!==o){var e;let{city:a,country:t,line1:s,line2:n,postal_code:i,state:l}=null!==(e=null==o?void 0:o.address)&&void 0!==e?e:{},d={city:a,country:t,line1:s,line2:n,postal_code:i,state:l};r({values:d,initialValues:d})}},[b]),(0,i.jsx)(x.by,{footer:(0,i.jsx)("div",{className:"flex py-4 px-8",children:(0,i.jsx)(h.i,{form:I,isSubmitting:C,hasChanges:l,handleReset:s,helper:n?void 0:"You need additional permissions to manage this organization's billing address"})}),children:(0,i.jsx)(g.hj,{children:(0,i.jsxs)(g.B4,{fullWidth:!0,loading:!1,className:"!gap-2",children:[(0,i.jsx)(k.Z,{id:"line1",name:"line1",placeholder:"Address line 1",disabled:!n}),(0,i.jsx)(k.Z,{id:"line2",name:"line2",placeholder:"Address line 2",disabled:!n}),(0,i.jsxs)("div",{className:"flex space-x-2",children:[(0,i.jsxs)(T.Z,{className:"w-full",id:"country",name:"country",placeholder:"Country",disabled:!n,children:[(0,i.jsx)(T.Z.Option,{label:"---",value:"",children:"---"},"empty"),P.map(e=>(0,i.jsx)(T.Z.Option,{label:e.name,value:e.code,children:e.name},e.code))]}),(0,i.jsx)(k.Z,{className:"w-full",id:"postal_code",name:"postal_code",placeholder:"Postal code",disabled:!n})]}),(0,i.jsxs)("div",{className:"flex space-x-2",children:[(0,i.jsx)(k.Z,{className:"w-full",id:"city",name:"city",placeholder:"City",disabled:!n}),(0,i.jsx)(k.Z,{className:"w-full",id:"state",name:"state",placeholder:"State",disabled:!n})]})]})})})}})]}):(0,i.jsx)(j.Z,{resourceText:"view this organization's billing address"})})]})},R=t(28879),D=t.n(R),L=t(39097),M=t.n(L),U=t(6277),F=t(24990),Y=t(17436);async function G(e,a){let{orgSlug:t}=e;if(!t)throw Error("orgSlug is required");let{data:s,error:n}=await (0,b.U2)("/platform/organizations/{slug}/billing/invoices/upcoming",{params:{path:{slug:t}},headers:{Version:"2"},signal:a});return n&&(0,b.S3)(n),s}let B=function(e){let{orgSlug:a}=e,{enabled:t=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,y.a)(Y.Y.orgUpcomingPreview(a),e=>{let{signal:t}=e;return G({orgSlug:a},t)},{enabled:t&&void 0!==a,...s})};var V=t(82955),W=t(32079),q=t(11992),H=t(86418);let X=[H.tk.DATABASE_SIZE,H.tk.EGRESS,H.tk.STORAGE_SIZE],K=(e,a)=>{if(a.hours)return a.usage.toLocaleString()+" ("+Math.round(a.usage/a.hours).toLocaleString()+"x"+a.hours.toLocaleString()+" hours)";if(!X.includes(e))return a.usage.toLocaleString();{let e=+(a.usage/1e9).toFixed(2).toLocaleString();return a.usage>0&&0===e?"<0.01":e}},Q=e=>X.includes(e)?"GB":e.startsWith("COMPUTE_HOURS")||[H.tk.CUSTOM_DOMAIN,H.tk.IPV4,H.tk.PITR_7,H.tk.PITR_14,H.tk.PITR_28].includes(e)?"Hours":null,J=(e,a)=>{let t=["Current plan limits are not enough for me","I want better customer support from Supabase","I am migrating from a previous project"];return void 0===e||void 0===a||("free"===e&&"pro"===a?(t.push("Need more compute"),t.push("I want access to additional features like branching, daily backups, custom domain and PITR")):"team"===a&&t.push("I want access to SOC2 and HIPAA compliance")),t.push("None of the above"),t};var $=t(91179),ee=t(82137);let ea=[{identifier:"COMPUTE",text:"Every project is a dedicated server and database. For every hour your project is active, it incurs compute costs based on the compute size of your project. Paused projects do not incur compute costs.",linkRef:"https://supabase.com/docs/guides/platform/org-based-billing#billing-for-compute-compute-hours"}],et=e=>{let{text:a,linkRef:t}=e;return(0,i.jsxs)(F.fC,{delayDuration:0,children:[(0,i.jsx)(F.xz,{children:(0,i.jsx)(ee.Z,{size:12,strokeWidth:2})}),(0,i.jsx)(F.h_,{children:(0,i.jsxs)(F.VY,{side:"bottom",children:[(0,i.jsx)(F.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background min-w-[300px] max-w-[450px] max-h-[300px] overflow-y-auto",children:(0,i.jsx)("span",{className:"text-xs text-foreground",children:(0,i.jsxs)("p",{children:[a," ",t&&(0,i.jsx)(M(),{href:t,target:"_blank",className:"transition text-brand hover:text-brand-600 underline",children:"Read more"})]})})})]})})]})};var es=e=>{var a,t;let{slug:s}=e,{data:n,error:r,isLoading:l,isError:o,isSuccess:d}=B({orgSlug:s}),[c,m]=(0,u.useState)([]),h=(0,u.useMemo)(()=>((null==n?void 0:n.lines)||[]).find(e=>e.description.startsWith("Compute Credits")),[n]),x=(0,u.useMemo)(()=>((null==n?void 0:n.lines)||[]).filter(e=>e!==h&&(!e.breakdown||!e.breakdown.length)).sort((e,a)=>Number(e.proration)-Number(a.proration)),[n,h]),g=(0,u.useMemo)(()=>((null==n?void 0:n.lines)||[]).filter(e=>{var a;return null===(a=e.breakdown)||void 0===a?void 0:a.length}).sort((e,a)=>Number(e.usage_based)-Number(a.usage_based)||a.amount-e.amount),[n]),j=e=>{m([...c,e])},v=e=>{m(c.filter(a=>a!==e))},y=(0,u.useMemo)(()=>g.length===c.length,[g,c]);return(0,i.jsxs)(i.Fragment,{children:[l&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(f.Z,{}),(0,i.jsx)(f.Z,{className:"w-3/4"}),(0,i.jsx)(f.Z,{className:"w-1/2"})]}),o&&(0,i.jsx)(p.Z,{subject:"Failed to retrieve upcoming invoice",error:r}),d&&(0,i.jsxs)("div",{children:[g.length>0&&(0,i.jsx)("div",{className:"mb-2",children:(0,i.jsx)(W.z,{size:"tiny",type:"default",onClick:()=>{y?m([]):m(g.map(e=>e.description))},children:y?"Collapse All":"Expand All"})}),(0,i.jsxs)("table",{className:"w-full",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{className:"border-b",children:[(0,i.jsx)("th",{className:"py-2 font-medium text-left text-sm text-foreground-light max-w-[200px]",children:"Item"}),(0,i.jsx)("th",{className:"py-2 font-medium text-right text-sm text-foreground-light pr-4",children:"Usage"}),(0,i.jsx)("th",{className:"py-2 font-medium text-left text-sm text-foreground-light",children:"Unit price"}),(0,i.jsx)("th",{className:"py-2 font-medium text-right text-sm text-foreground-light",children:"Cost"})]})}),(0,i.jsx)("tbody",{children:x.map(e=>{var a,t;return(0,i.jsxs)("tr",{className:"border-b",children:[(0,i.jsx)("td",{className:"py-2 text-sm max-w-[200px]",colSpan:e.proration?3:1,children:null!==(t=e.description)&&void 0!==t?t:"Unknown"}),!e.proration&&(0,i.jsx)("td",{className:"py-2 text-sm text-right pr-4",children:null===(a=e.quantity)||void 0===a?void 0:a.toLocaleString()}),!e.proration&&(0,i.jsx)("td",{className:"py-2 text-sm",children:0===e.unit_price?"FREE":e.unit_price?(0,V.xG)(e.unit_price):null}),(0,i.jsx)("td",{className:"py-2 text-sm text-right",children:(0,V.xG)(e.amount)})]},e.description)})}),g.length>0&&g.map(e=>{var a,t;return(0,i.jsx)(q.ZP,{asChild:!0,open:c.includes(e.description),onOpenChange:a=>a?j(e.description):v(e.description),children:(0,i.jsxs)("tbody",{children:[(0,i.jsx)(q.ZP.Trigger,{asChild:!0,children:(0,i.jsxs)("tr",{className:c.includes(e.description)?"":"border-b",style:{WebkitAppearance:"initial"},children:[(0,i.jsxs)("td",{className:"py-2 text-sm max-w-[200px]",children:[(0,i.jsx)(W.z,{type:"text",className:"!px-1",icon:(0,i.jsx)($.Z,{className:(0,U.default)("transition",c.includes(e.description)&&"rotate-90")})})," ",(0,i.jsxs)("span",{className:"mr-2",children:[e.description,e.usage_metric&&Q(e.usage_metric)&&" (".concat(Q(e.usage_metric),")")]}),(()=>{let a=ea.find(a=>{var t;return null===(t=e.usage_metric)||void 0===t?void 0:t.startsWith(a.identifier)});return a?(0,i.jsx)(et,{text:a.text,linkRef:a.linkRef}):null})()]}),(0,i.jsx)("td",{className:"py-2 pr-4 text-sm text-right tabular-nums max-w-[100px]",children:e.usage_original?"".concat(K(e.usage_metric,{usage:e.usage_original})):e.quantity?e.quantity:null}),(0,i.jsx)("td",{className:"py-2 text-sm",children:e.unit_price_desc?"".concat(e.unit_price_desc):e.unit_price?(0,V.xG)(e.unit_price):null}),(0,i.jsx)("td",{className:"py-2 text-sm text-right max-w-[70px]",children:null!==(t=(0,V.xG)(e.amount))&&void 0!==t?t:(0,V.xG)(0)})]},e.description)}),(0,i.jsx)(q.ZP.Content,{asChild:!0,children:(0,i.jsx)(i.Fragment,{children:null===(a=e.breakdown)||void 0===a?void 0:a.map(a=>(0,i.jsxs)("tr",{className:"last:border-b cursor-pointer",style:{WebkitAppearance:"initial"},children:[(0,i.jsx)("td",{className:"pb-1 text-xs pl-8 max-w-[200px]",children:a.project_name}),(0,i.jsx)("td",{className:"pb-1 text-xs tabular-nums text-right pr-4",children:K(e.usage_metric,a)}),(0,i.jsx)("td",{}),(0,i.jsx)("td",{})]},a.project_ref))})})]})},e.description)}),h&&(0,i.jsx)("tbody",{children:(0,i.jsxs)("tr",{className:"border-b",children:[(0,i.jsxs)("td",{className:"py-2 text-sm max-w-[200px]",children:[(0,i.jsx)("span",{className:"mr-2",children:h.description}),(0,i.jsx)(et,{text:"Paid plans come with $10 in Compute Credits to cover one Micro instance or parts of any other instance. Compute Credits are given to you every month and do not stack up while you are on a paid plan.",linkRef:"https://supabase.com/docs/guides/platform/org-based-billing#compute-credits"})]}),(0,i.jsx)("td",{className:"py-2 text-sm text-right",colSpan:3,children:(0,V.xG)(h.amount)})]})}),(0,i.jsxs)("tfoot",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsxs)("td",{className:"py-4 text-sm font-medium",children:[(0,i.jsx)("span",{className:"mr-2",children:"Current Costs"}),(0,i.jsx)(et,{text:"Costs accumulated from the beginning of the billing cycle up to now."})]}),(0,i.jsx)("td",{className:"py-4 text-sm text-right font-medium",colSpan:3,children:null!==(a=(0,V.xG)(null==n?void 0:n.amount_total))&&void 0!==a?a:"-"})]}),(0,i.jsxs)("tr",{children:[(0,i.jsxs)("td",{className:"text-sm font-medium",children:[(0,i.jsx)("span",{className:"mr-2",children:"Projected Costs"}),(0,i.jsx)(et,{text:"Projected costs at the end of the billing cycle. Includes predictable costs for Compute Hours, IPv4, Custom Domain and Point-In-Time-Recovery, but no costs for metrics like MAU, storage or function invocations. Final amounts may vary depending on your usage."})]}),(0,i.jsx)("td",{className:"text-sm text-right font-medium",colSpan:3,children:null!==(t=(0,V.xG)(null==n?void 0:n.amount_projected))&&void 0!==t?t:"-"})]})]})]})]})]})},en=()=>{var e,a;let{slug:t}=(0,r.UO)(),s=(0,N.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),{data:n,error:u,isLoading:m,isError:h}=(0,d.Gl)({orgSlug:t},{enabled:s}),x=(0,o.N)("billing:invoices"),g=D().unix(null!==(e=null==n?void 0:n.current_period_start)&&void 0!==e?e:0).utc(),v=D().unix(null!==(a=null==n?void 0:n.current_period_end)&&void 0!==a?a:0).utc();return(0,i.jsxs)(l.jX,{children:[(0,i.jsx)(l.g$,{children:(0,i.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,i.jsx)("p",{className:"text-foreground text-base m-0",children:"Billing Breakdown"}),(0,i.jsxs)("p",{className:"text-sm text-foreground-light m-0",children:["Current billing cycle: ",g.format("MMM DD")," -"," ",v.format("MMM DD")]}),(0,i.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"It may take up to an hour for addon changes or new projects to show up."})]})}),(0,i.jsx)(l.Lc,{children:s?(0,i.jsxs)(i.Fragment,{children:[m&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(f.Z,{}),(0,i.jsx)(f.Z,{className:"w-3/4"}),(0,i.jsx)(f.Z,{className:"w-1/2"})]}),h&&(0,i.jsx)(p.Z,{subject:"Failed to retrieve subscription",error:u}),x&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("p",{className:"text-sm text-foreground-light",children:["The table shows your upcoming invoice, excluding credits. This invoice will continue updating until the end of your billing period on"," ",v.format("MMMM DD"),". See"," ",(0,i.jsx)(M(),{className:"text-green-900 transition hover:text-green-1000",href:"/org/".concat(t,"/usage"),children:"usage page"})," ","for a more detailed usage breakdown."]}),(0,i.jsx)(es,{slug:t})]})]}):(0,i.jsx)(j.Z,{resourceText:"view this organization's billing breakdown"})})]})},ei=t(6654),er=t(31310),el=()=>{let{slug:e}=(0,r.UO)(),a=(0,C.NL)(),t=(0,z.l)(),{name:s,billing_email:n}=null!=t?t:{},o="org-billing-email",d=(0,N.Xo)(c.KA.UPDATE,"organizations"),p=(0,N.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),{mutate:j,isLoading:v}=(0,ei.k)(),f=async(t,n)=>{let{resetForm:i}=n;return d?e?s?void j({slug:e,name:s,billing_email:t.billing_email},{onSuccess:e=>{let{billing_email:t}=e;i({values:{billing_email:t},initialValues:{billing_email:t}}),(0,er.aL)(a),m.Am.success("Successfully saved settings")}}):console.error("Organization name is required"):console.error("Slug is required"):m.Am.error("You do not have the required permissions to update this organization")};return p?(0,i.jsxs)(l.jX,{children:[(0,i.jsx)(l.g$,{children:(0,i.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,i.jsx)("p",{className:"text-foreground text-base m-0",children:"Email Recipient"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"All billing correspondence will go to this email"})]})}),(0,i.jsx)(l.Lc,{children:(0,i.jsx)(E.Z,{id:o,initialValues:{billing_email:null!=n?n:""},onSubmit:f,children:a=>{let{handleReset:t,values:s,initialValues:r,resetForm:l}=a,c=JSON.stringify(s)!==JSON.stringify(r);return(0,u.useEffect)(()=>{let e={billing_email:null!=n?n:""};l({values:e,initialValues:e})},[e]),(0,i.jsx)(x.by,{footer:(0,i.jsx)("div",{className:"flex py-4 px-8",children:(0,i.jsx)(h.i,{form:o,isSubmitting:v,hasChanges:c,handleReset:t,helper:d?void 0:"You need additional permissions to manage this organization's settings"})}),children:(0,i.jsx)(g.hj,{children:(0,i.jsx)(g.B4,{fullWidth:!0,loading:!1,children:(0,i.jsx)(k.Z,{id:"billing_email",size:"small",label:"Email address",type:"text",disabled:!d})})})})}})})]}):null},eo=t(17172),ed=t(46529),ec=t(6659),eu=t(96577),em=t.n(eu),ep=t(94896);async function eh(e){let{slug:a}=e,{data:t,error:s}=await (0,b.IV)("/platform/organizations/{slug}/billing/subscription/schedule",{params:{path:{slug:a}}});return s&&(0,b.S3)(s),t}let ex=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,I.D)(e=>eh(e),{async onSuccess(a,t,n){await s.invalidateQueries(ep.U.orgSubscription(t.slug)),await (null==e?void 0:e(a,t,n))},async onError(e,t,s){void 0===a?m.Am.error("Failed to cancel subscription schedule: ".concat(e.message)):a(e,t,s)},...t})};var eg=t(75939),ej=t(99248),ev=t(11774),ef=t(48869),ey=t(95492),eb=t(2320),eN=t(15735),ew=t(99445);async function e_(e){let{slug:a,tier:t,paymentMethod:s}=e;if(!a)throw Error("slug is required");if(!t)throw Error("tier is required");let n={tier:t};void 0!==s&&(n.payment_method=s);let{error:i,data:r}=await (0,b.gz)("/platform/organizations/{slug}/billing/subscription",{body:{payment_method:n.payment_method,tier:n.tier},params:{path:{slug:a}}});return i&&(0,b.S3)(i),r}let eS=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,I.D)(e=>e_(e),{async onSuccess(a,t,n){let{slug:i}=t;await new Promise(e=>setTimeout(e,2e3)),await Promise.all([s.invalidateQueries(ep.U.orgSubscription(i)),s.invalidateQueries(ep.U.orgPlans(i)),s.invalidateQueries(ew.Z.orgUsage(i)),s.invalidateQueries(Y.Y.orgUpcomingPreview(i))]),await (null==e?void 0:e(a,t,n))},async onError(e,t,s){void 0===a?m.Am.error("Failed to update subscription: ".concat(e.message)):a(e,t,s)},...t})};var eC=t(11682),eI=t(49251),eA=t(54383);let eZ=[{name:"Spend cap enabled",value:"on",imageUrl:"".concat(ej.GW,"/img/spend-cap-on.png"),imageUrlLight:"".concat(ej.GW,"/img/spend-cap-on--light.png")},{name:"Spend cap disabled",value:"off",imageUrl:"".concat(ej.GW,"/img/spend-cap-off.png"),imageUrlLight:"".concat(ej.GW,"/img/spend-cap-off--light.png")}];var ez=()=>{var e;let{slug:a}=(0,r.UO)(),{resolvedTheme:t}=(0,ec.F)(),[s,n]=(0,u.useState)(!1),[l,o]=(0,u.useState)(),p=(0,N.Xo)(c.KA.BILLING_WRITE,"stripe.subscriptions"),h=(0,ev.Wu)(),x="costControl"===h.panelKey,g=()=>h.setPanelKey(void 0),{data:j,isLoading:v}=(0,d.Gl)({orgSlug:a}),{mutate:f,isLoading:y}=eS({onSuccess:()=>{m.Am.success("Successfully ".concat(_?"enabled":"disabled"," spend cap")),g()},onError:e=>{m.Am.error("Failed to toggle spend cap: ".concat(e.message))}}),b=(null==j?void 0:null===(e=j.plan)||void 0===e?void 0:e.id)==="free",w=!(null==j?void 0:j.usage_billing_enabled),_=!w&&"on"===l,S=l!==(w?"on":"off");(0,u.useEffect)(()=>{x&&void 0!==j&&o(w?"on":"off")},[x,v,j,w]);let C=async()=>{if(!a)return console.error("Org slug is required");f({slug:a,tier:"on"===l?ej.ev.PRO:ej.ev.PAYG})};return(0,i.jsx)(eI.ZP,{size:"large",loading:v||y,disabled:b||v||!S||y||!p,visible:x,onCancel:g,onConfirm:C,header:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("h4",{children:"Spend cap"}),(0,i.jsx)(W.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{strokeWidth:1.5}),children:(0,i.jsx)(M(),{href:"https://supabase.com/docs/guides/platform/spend-cap",target:"_blank",rel:"noreferrer",children:"About spend cap"})})]}),tooltip:p?void 0:"You do not have permission to update spend cap",children:(0,i.jsx)(eI.ZP.Content,{children:(0,i.jsxs)("div",{className:"py-6 space-y-4",children:[(0,i.jsx)("p",{className:"text-sm",children:"Use the spend cap to manage project usage and costs, and control whether the project can exceed the included quota allowance of any billed line item in a billing cycle"}),(0,i.jsxs)(q.ZP,{open:s,onOpenChange:n,children:[(0,i.jsx)(q.ZP.Trigger,{asChild:!0,children:(0,i.jsxs)("div",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,i.jsx)($.Z,{strokeWidth:1.5,size:16,className:s?"rotate-90":""}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"How are each resource charged after exceeding the included quota?"})]})}),(0,i.jsx)(q.ZP.Content,{asChild:!0,children:(0,i.jsx)(eN.Z,{className:"mt-4",head:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eN.Z.th,{children:(0,i.jsx)("p",{className:"text-xs",children:"Item"})}),(0,i.jsx)(eN.Z.th,{children:(0,i.jsx)("p",{className:"text-xs",children:"Rate"})})]}),body:["database","auth","storage","realtime","edge_functions"].map(e=>{let a=eC.D[e],t=a.features.filter(e=>e.usage_based);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(eN.Z.tr,{children:[(0,i.jsx)(eN.Z.td,{children:(0,i.jsx)("p",{className:"text-xs text-foreground",children:a.title})}),(0,i.jsx)(eN.Z.td,{children:null})]},e),t.map(e=>(0,i.jsxs)(eN.Z.tr,{children:[(0,i.jsx)(eN.Z.td,{children:(0,i.jsx)("p",{className:"text-xs pl-4",children:e.title})}),(0,i.jsx)(eN.Z.td,{children:(0,i.jsx)("p",{className:"text-xs pl-4",children:e.plans.pro})})]},e.title))]})})})})]}),b&&(0,i.jsx)(ef.b,{withIcon:!0,variant:"info",title:"Toggling of the spend cap is only available on the Pro Plan",actions:(0,i.jsx)(W.z,{type:"default",onClick:()=>h.setPanelKey("subscriptionPlan"),children:"View available plans"}),children:"Upgrade your plan to disable the spend cap"}),(0,i.jsx)("div",{className:"!mt-8 pb-4",children:(0,i.jsx)("div",{className:"flex gap-3",children:eZ.map(e=>{let a=l===e.value;return(0,i.jsxs)("div",{className:(0,eA.cn)("col-span-4 group space-y-1",b&&"opacity-75"),onClick:()=>!b&&o(e.value),children:[(0,i.jsx)(em(),{alt:"Spend Cap",className:(0,eA.cn)("relative rounded-xl transition border bg-no-repeat bg-center bg-cover w-[160px] h-[96px]",a?"border-foreground":"border-foreground-muted opacity-50 group-hover:border-foreground-lighter group-hover:opacity-100",!b&&"cursor-pointer",!b&&!a&&"group-hover:border-foreground-light"),width:160,height:96,src:(null==t?void 0:t.includes("dark"))?e.imageUrl:e.imageUrlLight}),(0,i.jsx)("p",{className:(0,eA.cn)("text-sm transition",!b&&"group-hover:text-foreground",a?"text-foreground":"text-foreground-light"),children:e.name})]},e.value)})})}),"on"===l?(0,i.jsx)(ef.b,{withIcon:!0,variant:"warning",title:"Your projects could become unresponsive or enter read only mode",children:"Exceeding the included quota allowance with spend cap enabled can cause your projects to become unresponsive or enter read only mode."}):(0,i.jsx)(ef.b,{withIcon:!0,variant:"info",title:"Charges apply for usage beyond included quota allowance",children:"Your projects will always remain responsive and active, and charges only apply when exceeding the included quota limit."}),S&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("p",{className:"text-sm",children:"on"===l?"Upon clicking confirm, spend cap will be enabled for your organization and you will no longer be charged any extra for usage.":"Upon clicking confirm, spend cap will be disabled for your organization and you will be charged for any usage beyond the included quota."})})]})})})},eE=e=>{var a,t,s,n;let{}=e,{slug:o}=(0,r.UO)(),{resolvedTheme:u}=(0,ec.F)(),m=(0,N.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),h=(0,ev.Wu)(),x=(0,eg.P)("disableProjectCreationAndUpdate"),{data:g,error:v,isLoading:y,isSuccess:b,isError:w}=(0,d.Gl)({orgSlug:o},{enabled:m}),_=null==g?void 0:g.plan,S=null!==(n=null==g?void 0:g.usage_billing_enabled)&&void 0!==n&&n,C=!x&&!["team","enterprise"].includes((null==_?void 0:_.id)||""),{mutate:I,isLoading:A}=ex();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(l.jX,{children:[(0,i.jsx)(l.g$,{children:(0,i.jsxs)("div",{className:"sticky space-y-6 top-12",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("p",{className:"text-foreground text-base m-0",children:"Cost Control"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"Control whether to use beyond your plans included quota"})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"More information"}),(0,i.jsx)("div",{children:(0,i.jsx)(M(),{href:"https://supabase.com/docs/guides/platform/spend-cap",target:"_blank",rel:"noreferrer",children:(0,i.jsxs)("div",{className:"flex items-center space-x-2 opacity-50 hover:opacity-100 transition",children:[(0,i.jsx)("p",{className:"text-sm m-0",children:"Spend cap"}),(0,i.jsx)(eo.Z,{size:16,strokeWidth:1.5})]})})})]})]})}),(0,i.jsx)(l.Lc,{children:m?(0,i.jsxs)(i.Fragment,{children:[y&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(f.Z,{}),(0,i.jsx)(f.Z,{className:"w-3/4"}),(0,i.jsx)(f.Z,{className:"w-1/2"})]}),w&&(0,i.jsx)(p.Z,{subject:"Failed to retrieve subscription",error:v}),b&&(0,i.jsxs)("div",{className:"space-y-6",children:[["team","enterprise"].includes((null==_?void 0:_.id)||"")?(0,i.jsxs)(ef.b,{withIcon:!0,variant:"info",title:"You will be charged for any additional usage on the ".concat((null==_?void 0:_.name)||""," plan"),children:[(null==_?void 0:_.name)||""," plan requires you to have spend cap off at all times. Your projects will never become unresponsive. Only when your"," ",(0,i.jsx)(M(),{href:"/org/".concat(o,"/usage"),className:"text-green-900 transition hover:text-green-1000",children:"included usage"})," ","is exceeded will you be charged for any additional usage."]}):(0,i.jsxs)("p",{className:"text-sm text-foreground-light",children:["You can control whether your organization is charged for additional usage beyond the"," ",(0,i.jsx)(M(),{href:"/org/".concat(o,"/usage"),className:"text-green-900 transition hover:text-green-1000",children:"included quota"})," ","of your subscription plan. If you need to go beyond the included quota, simply switch off your spend cap to pay for additional usage."]}),(null==g?void 0:null===(a=g.scheduled_plan_change)||void 0===a?void 0:a.target_plan)==="pro"&&(null==g?void 0:null===(t=g.scheduled_plan_change)||void 0===t?void 0:t.usage_billing_enabled)===!1&&(null==g?void 0:g.plan.id)==="pro"&&(0,i.jsxs)(ey.bZ,{className:"mb-2",title:"Scheduled downgrade",children:[(0,i.jsx)(ed.Z,{className:"h-4 w-4"}),(0,i.jsx)(ey.Cd,{children:"Scheduled change"}),(0,i.jsxs)(ey.X,{className:"flex flex-col gap-3",children:[(0,i.jsxs)("div",{children:["Your spend cap will be enabled on"," ",D()(null==g?void 0:null===(s=g.scheduled_plan_change)||void 0===s?void 0:s.at).format("MMMM D, YYYY"),". You will not be charged for any over-usage moving on. If you would like to keep the spend cap disabled and scale as you go, you may still cancel the scheduled change."]}),(0,i.jsx)("div",{children:(0,i.jsx)(W.z,{type:"default",loading:A,onClick:()=>I({slug:o}),children:"Cancel"})})]})]}),(0,i.jsxs)("div",{className:"flex space-x-6",children:[(0,i.jsx)("div",{children:(0,i.jsx)("div",{className:"rounded-md bg-surface-200 w-[160px] h-[96px] shadow",children:(0,i.jsx)(em(),{alt:"Spend Cap",width:160,height:96,src:S?"".concat(ej.GW,"/img/spend-cap-off").concat((null==u?void 0:u.includes("dark"))?"":"--light",".png?v=3"):"".concat(ej.GW,"/img/spend-cap-on").concat((null==u?void 0:u.includes("dark"))?"":"--light",".png?v=3")})})}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{className:"mb-1",children:["Spend cap is ",S?"disabled":"enabled"]}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:S?(0,i.jsx)("span",{children:"You will be charged for any usage above the included quota."}):(0,i.jsx)("span",{children:"You won't be charged any extra for usage. However, your projects could become unresponsive or enter read only mode if you exceed the included quota."})}),S&&(0,i.jsx)("p",{className:"text-sm text-foreground-light mt-1",children:"Your projects will never become unresponsive. Only when your usage reaches the quota limit will you be charged for any excess usage."}),(0,i.jsx)(eb.Z,{projectUpdateDisabled:x,children:(0,i.jsx)(W.z,{type:"default",className:"mt-4 pointer-events-auto",disabled:!C,onClick:()=>h.setPanelKey("costControl"),children:"Change spend cap"})})]})]})]})]}):(0,i.jsx)(j.Z,{resourceText:"update this organization's cost control"})})]}),(0,i.jsx)(ez,{})]})},ek=t(81076),eT=()=>{var e;let{slug:a}=(0,r.UO)(),t=(0,N.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),{data:s,error:n,isLoading:o,isError:u,isSuccess:m}=(0,d.Gl)({orgSlug:a},{enabled:t}),h=(null!==(e=null==s?void 0:s.customer_balance)&&void 0!==e?e:0)/100,x=h<0,g=h>0,v=x&&0!==h?h.toFixed(2).toString().replace("-",""):h.toFixed(2);return(0,i.jsxs)(l.jX,{children:[(0,i.jsx)(l.g$,{children:(0,i.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("p",{className:"text-foreground text-base m-0",children:"Credit Balance"}),x&&(0,i.jsx)(ek.C,{children:"You have credits available"}),g&&(0,i.jsx)(ek.C,{variant:"destructive",children:"Outstanding payments"})]}),(0,i.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"Charges will be deducted from your balance first"})]})}),(0,i.jsx)(l.Lc,{children:t?(0,i.jsxs)(i.Fragment,{children:[o&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(f.Z,{}),(0,i.jsx)(f.Z,{className:"w-3/4"}),(0,i.jsx)(f.Z,{className:"w-1/2"})]}),u&&(0,i.jsx)(p.Z,{subject:"Failed to retrieve organization customer profile",error:n}),m&&(0,i.jsxs)("div",{className:"flex items-end space-x-1",children:[g&&(0,i.jsx)("h4",{className:"opacity-50",children:"-"}),(0,i.jsx)("h4",{className:"opacity-50",children:"$"}),(0,i.jsx)("h2",{className:"text-4xl relative top-[2px]",children:v}),x&&(0,i.jsx)("h4",{className:"opacity-50",children:"/credits"})]})]}):(0,i.jsx)(j.Z,{resourceText:"view this organization's credits"})})]})},eP=t(12333),eO=t(66432),eR=t(83765),eD=t(83690);async function eL(e){let{slug:a,hcaptchaToken:t}=e,{data:s,error:n}=await (0,b.v_)("/platform/organizations/{slug}/payments/setup-intent",{params:{path:{slug:a}},body:{hcaptchaToken:t}});return n&&(0,b.S3)(n),s}let eM=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,I.D)(e=>eL(e),{async onSuccess(a,t,s){await (null==e?void 0:e(a,t,s))},async onError(e,t,s){void 0===a?m.Am.error("Failed to setup intent: ".concat(e.message)):a(e,t,s)},...t})};var eU=t(30242);async function eF(e){let{slug:a,paymentMethodId:t}=e;if(!a)throw Error("Slug is required");let{data:s,error:n}=await (0,b.gz)("/platform/organizations/{slug}/payments/default",{body:{payment_method_id:t},params:{path:{slug:a}}});if(n)throw(0,b.S3)(n);return s}let eY=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,I.D)(e=>eF(e),{async onSuccess(a,t,n){let{slug:i,paymentMethodId:r}=t;s.setQueriesData(w.O.paymentMethods(i),e=>e?{...e,defaultPaymentMethodId:r,data:e.data.map(e=>({...e,is_default:e.id===r}))}:e),await (null==e?void 0:e(a,t,n))},async onError(e,t,s){void 0===a?m.Am.error("Failed to mark payment method as default: ".concat(e.message)):a(e,t,s)},...t})};var eG=t(71640),eB=t(6112),eV=e=>{let{returnUrl:a,onCancel:t,onConfirm:s,showSetDefaultCheckbox:n=!1}=e,r=(0,eO.useStripe)(),l=(0,eO.useElements)(),o=(0,z.l)(),[d,c]=(0,u.useState)(!1),[p,h]=(0,u.useState)(n),x=(0,C.NL)(),{mutateAsync:g}=eY(),j=async e=>{if(e.preventDefault(),!r||!l){console.error("Stripe.js has not loaded");return}c(!0),void 0!==document&&document.body.classList.add("!pointer-events-auto");let{error:t,setupIntent:n}=await r.confirmSetup({elements:l,redirect:"if_required",confirmParams:{return_url:a}});if(t){var i;c(!1),m.Am.error(null!==(i=null==t?void 0:t.message)&&void 0!==i?i:" Failed to save card details")}else{if(p&&o&&"string"==typeof(null==n?void 0:n.payment_method))try{await g({slug:o.slug,paymentMethodId:n.payment_method}),await x.invalidateQueries(w.O.paymentMethods(o.slug)),x.setQueriesData(w.O.paymentMethods(o.slug),e=>e?{...e,defaultPaymentMethodId:n.payment_method,data:e.data.map(e=>({...e,is_default:e.id===n.payment_method}))}:e)}catch(e){m.Am.error("Failed to set payment method as default")}else o&&await x.invalidateQueries(w.O.paymentMethods(o.slug));c(!1),s()}void 0!==document&&document.body.classList.remove("!pointer-events-auto")};return(0,i.jsxs)("form",{onSubmit:j,children:[(0,i.jsxs)(eD.Z.Content,{className:"transition ".concat(d?"pointer-events-none opacity-75":"opacity-100"),children:[(0,i.jsx)(eO.PaymentElement,{className:"[.p-LinkAutofillPrompt]:pt-0"}),n&&(0,i.jsxs)("div",{className:"flex items-center gap-x-2 mt-4 mb-2",children:[(0,i.jsx)(eG.X,{id:"save-as-default",checked:p,onCheckedChange:e=>{"boolean"==typeof e&&h(e)}}),(0,i.jsx)(eB._,{htmlFor:"save-as-default",className:"text-foreground-light",children:"Save as default payment method"})]})]}),(0,i.jsx)(eD.Z.Separator,{}),(0,i.jsxs)(eD.Z.Content,{className:"flex items-center space-x-2",children:[(0,i.jsx)(W.z,{htmlType:"button",size:"small",type:"default",onClick:t,block:!0,disabled:d,children:"Cancel"}),(0,i.jsx)(W.z,{block:!0,htmlType:"submit",size:"small",type:"primary",loading:d,disabled:d,children:"Add payment method"})]})]})};let eW=(0,eR.J)(ej.Yw);var eq=e=>{let{visible:a,returnUrl:t,onCancel:s,onConfirm:n,showSetDefaultCheckbox:r}=e,{resolvedTheme:l}=(0,ec.F)(),[o,d]=(0,u.useState)(),c=(0,z.l)(),p=(0,eU.Y)(),[h,x]=(0,u.useState)(null),[g,j]=(0,u.useState)(null),{mutate:v}=eM({onSuccess:e=>{d(e)},onError:e=>{m.Am.error("Failed to setup intent: ".concat(e.message))}}),f=(0,u.useCallback)(e=>{j(e)},[]);(0,u.useEffect)(()=>{let e=async e=>{let a=null==c?void 0:c.slug;return a?e?void(d(void 0),v({slug:a,hcaptchaToken:e})):console.error("HCaptcha token required"):console.error("Slug is required")};(async()=>{if(a&&g&&p){let a=h;try{if(!a){var t;let e=await g.execute({async:!0});a=null!==(t=null==e?void 0:e.response)&&void 0!==t?t:null}}catch(e){return}await e(null!=a?a:void 0),y()}})()},[a,g,p]);let y=()=>{x(null),null==g||g.resetCaptcha()},b={clientSecret:o?o.client_secret:"",appearance:{theme:(null==l?void 0:l.includes("dark"))?"night":"flat",labels:"floating"}},N=()=>(d(void 0),s());return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eP.Z,{ref:f,sitekey:"4ca1fdb9-c9c9-4495-ba50-c85fc0e7ec1f",size:"invisible",onOpen:()=>{void 0!==document&&document.body.classList.add("!pointer-events-auto")},onClose:()=>{N(),void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onVerify:e=>{x(e),void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onExpire:()=>{x(null)}}),(0,i.jsx)(eD.Z,{hideFooter:!0,size:"medium",visible:a&&void 0!==o,header:"Add new payment method",onCancel:N,className:"PAYMENT",children:(0,i.jsx)(eO.Elements,{stripe:eW,options:b,children:(0,i.jsx)(eV,{returnUrl:t,onCancel:N,onConfirm:()=>(d(void 0),n()),showSetDefaultCheckbox:r})})})]})};async function eH(e,a){let{slug:t}=e;if(!t)throw Error("slug is required");let{data:s,error:n}=await (0,b.U2)("/platform/organizations/{slug}/payments",{params:{path:{slug:t}},headers:{Version:"2"},signal:a});return n&&(0,b.S3)(n),s}let eX=function(e){let{slug:a}=e,{enabled:t=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,y.a)(w.O.paymentMethods(a),e=>{let{signal:t}=e;return eH({slug:a},t)},{enabled:t,...s})};var eK=t(89404),eQ=t(6614),eJ=e=>{var a,t;let{selectedPaymentMethod:s,onClose:n}=e,{slug:l}=(0,r.UO)(),{mutate:o,isLoading:d}=eY({onSuccess:()=>{m.Am.success("Successfully changed payment method to the card ending with ".concat(s.card.last4)),n()},onError:e=>{m.Am.error("Failed to change payment method: ".concat(e.message))}}),c=async()=>l?s?void o({slug:l,paymentMethodId:s.id}):console.error("Card ID is required"):console.error("Slug is required");return(0,i.jsx)(eD.Z,{visible:void 0!==s,size:"medium",header:"Confirm to use payment method ending with ".concat(null==s?void 0:null===(a=s.card)||void 0===a?void 0:a.last4),onCancel:()=>n(),customFooter:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(W.z,{type:"default",disabled:d,onClick:()=>n(),children:"Cancel"}),(0,i.jsx)(W.z,{type:"primary",disabled:d,loading:d,onClick:c,children:"Confirm"})]}),children:(0,i.jsx)(eD.Z.Content,{children:(0,i.jsxs)("p",{className:"text-sm",children:["Upon clicking confirm, all future charges will be deducted from the card ending with"," ",null==s?void 0:null===(t=s.card)||void 0===t?void 0:t.last4,". There are no immediate charges."]})})})},e$=t(67767),e0=t(34503),e2=e=>{var a,t,s,n;let{paymentMethod:r,canUpdatePaymentMethods:l=!0,paymentMethodType:o,setSelectedMethodForUse:d,setSelectedMethodToDelete:c}=e,u=r.is_default,m=null!==(s=null===(a=r.card)||void 0===a?void 0:a.exp_year)&&void 0!==s?s:0,p=null!==(n=null===(t=r.card)||void 0===t?void 0:t.exp_month)&&void 0!==n?n:0,h=new Date().getMonth()+1,x=new Date().getFullYear();return r.card?(0,i.jsxs)("div",{className:"flex items-center justify-between gap-8",children:[(0,i.jsxs)("div",{className:"flex items-center gap-8",children:[(0,i.jsx)("img",{alt:"Credit card brand",src:"".concat(ej.GW,"/img/payment-methods/").concat(r.card.brand.replace(" ","-").toLowerCase(),".png"),width:"32"}),(0,i.jsxs)("p",{className:"prose text-sm font-mono",children:["**** **** **** ",r.card.last4]}),(0,i.jsxs)("p",{className:"text-sm tabular-nums",children:["Expires: ",r.card.exp_month,"/",r.card.exp_year]})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[m===x&&p===h&&(0,i.jsx)(ek.C,{variant:"warning",children:"Expiring soon"}),(m<x||m===x&&p<h)&&(0,i.jsx)(ek.C,{variant:"destructive",children:"Expired"}),u&&(0,i.jsx)(ek.C,{variant:"brand",children:"Active"}),l&&!u&&(0,i.jsxs)(e0.h_,{children:[(0,i.jsx)(e0.$F,{asChild:!0,children:(0,i.jsx)(W.z,{type:"outline",className:"hover:border-muted px-1",icon:(0,i.jsx)(e$.Z,{}),"aria-label":"More options"})}),(0,i.jsxs)(e0.AW,{align:"end",children:["card"===o&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e0.Xi,{onClick:()=>null==d?void 0:d(r),children:(0,i.jsx)("p",{children:"Use this card"})},"make-default"),(0,i.jsx)(e0.VD,{})]}),(0,i.jsx)(e0.Xi,{onClick:()=>null==c?void 0:c(r),children:(0,i.jsx)("p",{children:"Delete card"})},"delete-method")]})]})]})]},r.id):null};async function e1(e){let{slug:a,cardId:t}=e,{data:s,error:n}=await (0,b.IV)("/platform/organizations/{slug}/payments",{body:{card_id:t},params:{path:{slug:a}}});return n&&(0,b.S3)(n),s}let e4=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,I.D)(e=>e1(e),{async onSuccess(a,t,n){let{slug:i}=t;await s.invalidateQueries(w.O.paymentMethods(i)),await (null==e?void 0:e(a,t,n))},async onError(e,t,s){void 0===a?m.Am.error("Failed to delete payment method: ".concat(e.message)):a(e,t,s)},...t})};var e3=e=>{var a;let{selectedPaymentMethod:t,onClose:s}=e,{slug:n}=(0,r.UO)(),{mutate:l,isLoading:o}=e4({onSuccess:()=>{var e;m.Am.success("Successfully removed payment method ending with ".concat(null==t?void 0:null===(e=t.card)||void 0===e?void 0:e.last4)),s()}}),d=async()=>n?t?void l({slug:n,cardId:t.id}):console.error("Card ID is required"):console.error("Slug is required");return(0,i.jsx)(eD.Z,{visible:void 0!==t,size:"medium",header:"Confirm to delete payment method ending with ".concat(null==t?void 0:null===(a=t.card)||void 0===a?void 0:a.last4),onCancel:()=>s(),customFooter:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(W.z,{type:"default",disabled:o,onClick:()=>s(),children:"Cancel"}),(0,i.jsx)(W.z,{type:"primary",disabled:o,loading:o,onClick:d,children:"Confirm"})]}),children:(0,i.jsx)(eD.Z.Content,{children:(0,i.jsx)(ef.b,{withIcon:!0,variant:"info",title:"This will permanently delete your payment method.",children:(0,i.jsx)("p",{children:"You can re-add the payment method any time."})})})})},e5=()=>{var e,a,t;let{slug:s}=(0,r.UO)(),n=(0,z.l)(),[o,h]=(0,u.useState)(),[y,b]=(0,u.useState)(),[w,_]=(0,u.useState)(!1),{data:S}=(0,d.Gl)({orgSlug:s}),{data:C,error:I,isLoading:A,isError:Z,isSuccess:E}=eX({slug:s}),k=(0,N.Xo)(c.KA.BILLING_READ,"stripe.payment_methods"),T=(0,N.Xo)(c.KA.BILLING_WRITE,"stripe.payment_methods");return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(l.jX,{children:[(0,i.jsx)(l.g$,{children:(0,i.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,i.jsx)("p",{className:"text-foreground text-base m-0",children:"Payment Methods"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light mb-2 pr-4 m-0",children:"Payments for your subscription are made using the default card."})]})}),(0,i.jsx)(l.Lc,{children:(null==n?void 0:n.managed_by)!==void 0&&(null==n?void 0:n.managed_by)!=="supabase"?(0,i.jsx)(v.Z,{partner:null==n?void 0:n.managed_by,resource:"Payment Methods",cta:{installationId:null==n?void 0:n.partner_id}}):k?(0,i.jsxs)(i.Fragment,{children:[A&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(f.Z,{}),(0,i.jsx)(f.Z,{className:"w-3/4"}),(0,i.jsx)(f.Z,{className:"w-1/2"})]}),Z&&(0,i.jsx)(p.Z,{subject:"Failed to retrieve payment methods",error:I}),E&&(0,i.jsxs)(i.Fragment,{children:[(null==S?void 0:S.payment_method_type)==="invoice"&&(0,i.jsx)(ef.b,{withIcon:!0,variant:"info",title:"Payment is currently by invoice",actions:[(0,i.jsx)(W.z,{asChild:!0,type:"default",children:(0,i.jsx)(M(),{href:"/support/new?category=billing&subject=Request%20to%20change%20payment%20method",target:"_blank",rel:"noreferrer",className:"ml-3",children:"Contact support"})},"payment-method-support")],children:"You get a monthly invoice and payment link via email. To change your payment method, please contact us via our support form."}),(0,i.jsx)(x.by,{footer:(0,i.jsxs)("div",{className:"flex items-center justify-between py-4 px-8",children:[T?(0,i.jsx)("div",{}):(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"You need additional permissions to manage payment methods"}),(0,i.jsx)(W.z,{type:"default",icon:(0,i.jsx)(eK.Z,{}),disabled:!T,onClick:()=>_(!0),children:"Add new card"})]}),children:(0,i.jsx)(g.hj,{children:(0,i.jsx)(g.B4,{fullWidth:!0,loading:!1,children:(null!==(t=null==C?void 0:null===(e=C.data)||void 0===e?void 0:e.length)&&void 0!==t?t:0)===0?(0,i.jsxs)("div",{className:"flex items-center gap-2 opacity-50",children:[(0,i.jsx)(eQ.Z,{size:16,strokeWidth:1.5}),(0,i.jsx)("p",{className:"text-sm",children:"No payment methods"})]}):(0,i.jsx)("div",{className:"space-y-3",children:null==C?void 0:null===(a=C.data)||void 0===a?void 0:a.map(e=>(0,i.jsx)(e2,{paymentMethod:e,canUpdatePaymentMethods:T,paymentMethodType:null==S?void 0:S.payment_method_type,setSelectedMethodForUse:h,setSelectedMethodToDelete:b},e.id))})})})})]})]}):(0,i.jsx)(j.Z,{resourceText:"view this organization's payment methods"})})]}),(0,i.jsx)(eq,{visible:w,returnUrl:"".concat((0,V.Ax)(),"/org/").concat(s,"/billing"),onCancel:()=>_(!1),onConfirm:()=>{_(!1),m.Am.success("Successfully added new payment method")},showSetDefaultCheckbox:!0}),(0,i.jsx)(eJ,{selectedPaymentMethod:o,onClose:()=>h(void 0)}),(0,i.jsx)(e3,{selectedPaymentMethod:y,onClose:()=>b(void 0)})]})},e6=t(48699),e8=t(82718),e7=t(37970);let e9=()=>{let e=(0,z.l)(),{data:a,isSuccess:t}=(0,e8.v)({orgSlug:null==e?void 0:e.slug}),{data:s,isSuccess:n}=(0,d.Gl)({orgSlug:null==e?void 0:e.slug}),r=!!(null==a?void 0:a.usages.find(e=>{var a;return!e.unlimited&&e.capped&&e.usage>(null!==(a=null==e?void 0:e.pricing_free_units)&&void 0!==a?a:0)}));if(!t||!n||!e)return null;let l=null;return(s&&r&&!(null==e?void 0:e.restriction_status)?l="exceededLimits":(null==e?void 0:e.restriction_status)==="grace_period"?l="gracePeriod":(null==e?void 0:e.restriction_status)==="grace_period_over"?l="gracePeriodOver":(null==e?void 0:e.restriction_status)==="restricted"&&(l="restricted"),null===l)?null:(0,i.jsxs)(i.Fragment,{children:["exceededLimits"===l&&(0,i.jsxs)(ey.bZ,{variant:"destructive",children:[(0,i.jsx)(e7.ku,{}),(0,i.jsx)(ey.Cd,{children:"Your organization's usage has exceeded its included quota"}),(0,i.jsxs)(ey.X,{children:[(0,i.jsxs)("p",{children:["Your projects can become unresponsive or enter read-only mode."," ","free"===s.plan.id?"Please upgrade to the Pro Plan to ensure that your projects remain available.":"Please disable spend cap to ensure that your projects remain available."]}),(0,i.jsxs)("div",{className:"flex items-center gap-x-2 mt-3",children:[(0,i.jsx)(W.z,{asChild:!0,type:"default",children:(0,i.jsx)(M(),{href:"/org/".concat(null==e?void 0:e.slug,"/billing?panel=").concat("free"===s.plan.id?"subscriptionPlan":"costControl"),children:"free"===s.plan.id?"Upgrade plan":"Change spend cap"})},"upgrade-button"),(0,i.jsx)(W.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{}),children:(0,i.jsx)("a",{href:"https://supabase.com/docs/guides/platform/spend-cap",children:"About spend cap"})})]})]})]}),"gracePeriod"===l&&(0,i.jsxs)(ey.bZ,{variant:"warning",children:[(0,i.jsx)(e7.aN,{}),(0,i.jsx)(ey.Cd,{children:"Your grace period has started."}),(0,i.jsxs)(ey.X,{children:[(0,i.jsxs)("p",{className:"leading-tight",children:["Your organization is over its quota. You can continue with your projects until your grace period ends on"," ",(0,i.jsx)("span",{className:"text-foreground",children:D()(e.restriction_data.grace_period_end).format("DD MMM, YYYY")}),". After that, the Fair Use Policy will apply. If you plan to maintain this level of usage, upgrade your plan to avoid any restrictions. If restrictions are applied, requests to your projects will return a 402 status code."]}),(0,i.jsxs)("div",{className:"flex items-center gap-x-2 mt-3",children:[(0,i.jsx)(W.z,{asChild:!0,type:"default",children:(0,i.jsx)(M(),{href:"/org/".concat(null==e?void 0:e.slug,"/billing?panel=subscriptionPlan"),children:"Upgrade plan"})},"upgrade-button"),(0,i.jsx)(W.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{}),children:(0,i.jsx)("a",{href:"https://supabase.com/docs/guides/platform/billing-faq#fair-use-policy",children:"About Fair Use Policy"})})]})]})]}),"gracePeriodOver"===l&&(0,i.jsxs)(ey.bZ,{variant:"warning",children:[(0,i.jsx)(e7.aN,{}),(0,i.jsx)(ey.Cd,{children:"Your grace period is over."}),(0,i.jsxs)(ey.X,{children:[(0,i.jsxs)("p",{children:["Your grace period ended on"," ",(0,i.jsx)("span",{className:"text-foreground",children:D()(e.restriction_data.grace_period_end).format("DD MMM, YYYY")}),". Fair Use Policy applies now. Stay below your plans quota or upgrade your plan if you expect to exceed it. If you exceed your quota, requests will respond with a 402 status code."]}),(0,i.jsxs)("div",{className:"flex items-center gap-x-2 mt-3",children:[(0,i.jsx)(W.z,{asChild:!0,type:"default",children:(0,i.jsx)(M(),{href:"/org/".concat(null==e?void 0:e.slug,"/billing?panel=subscriptionPlan"),children:"Upgrade plan"})},"upgrade-button"),(0,i.jsx)(W.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{}),children:(0,i.jsx)("a",{href:"https://supabase.com/docs/guides/platform/billing-faq#fair-use-policy",children:"About Fair Use Policy"})})]})]})]}),"restricted"===l&&(0,i.jsxs)(ey.bZ,{variant:"destructive",children:[(0,i.jsx)(e7.ku,{}),(0,i.jsx)(ey.Cd,{children:"All services are restricted."}),(0,i.jsxs)(ey.X,{children:[(0,i.jsxs)("p",{children:["Fair Use Policy applies and your service is restricted. Your projects are not able to serve requests and will respond with a 402 status code. You have exceeded your plans quota and your grace period ended on"," ",(0,i.jsx)("span",{className:"text-foreground",children:D()(e.restriction_data.grace_period_end).format("DDMMM,YYYY")}),". Upgrade to lift restrictions or wait until your quota refills."]}),(0,i.jsxs)("div",{className:"flex items-center gap-x-2 mt-3",children:[(0,i.jsx)(W.z,{asChild:!0,type:"default",children:(0,i.jsx)(M(),{href:"/org/".concat(null==e?void 0:e.slug,"/billing?panel=subscriptionPlan"),children:"Upgrade plan"})},"upgrade-button"),(0,i.jsx)(W.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{}),children:(0,i.jsx)("a",{href:"https://supabase.com/docs/guides/platform/billing-faq#fair-use-policy",children:"About Fair Use Policy"})})]})]})]})]})};var ae=t(86152),aa=t.n(ae),at=t(76141),as=t(5632),an=t(34750),ai=t(44778),ar=t(61531),al=t(28119);async function ao(e){let{organizationSlug:a,tier:t}=e;if(!a)throw Error("organizationSlug is required");if(!t)throw Error("tier is required");let{data:s,error:n}=await (0,b.v_)("/platform/organizations/{slug}/billing/subscription/preview",{params:{path:{slug:a}},body:{tier:t},headers:{Version:"2"}});return n&&(0,b.S3)(n),s}let ad=function(e){let{organizationSlug:a,tier:t}=e,{enabled:s=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,y.a)(w.O.subscriptionPreview(a,t),()=>ao({organizationSlug:a,tier:t}),{enabled:s&&void 0!==a&&void 0!==t,...n,retry:(e,a)=>("object"!=typeof a||null===a||!("code"in a)||400!==a.code)&&e<3})};var ac=t(26198);async function au(e,a){let{orgSlug:t}=e;if(!t)throw Error("orgSlug is required");let{error:s,data:n}=await (0,b.U2)("/platform/organizations/{slug}/billing/plans",{params:{path:{slug:t}},signal:a});return s&&(0,b.S3)(s),n}let am=function(e){let{orgSlug:a}=e,{enabled:t=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,y.a)(ep.U.orgPlans(a),e=>{let{signal:t}=e;return au({orgSlug:a},t)},{enabled:t&&void 0!==a,...s})};var ap=t(46988),ah=t(71007),ax=t(30002),ag=t(85563);let aj=e=>{let{projectAddon:a}=e,t=a.addons.find(e=>"compute_instance"===e.type),s=a.addons.filter(e=>!["log_drain","auth_mfa_phone"].includes(e.type)).map(e=>"compute_instance"===e.type?"".concat(e.variant.name," Compute Instance"):e.variant.name);return(0,i.jsxs)("li",{className:"list-disc ml-6",children:[a.name,": ",s.join(", ")," will be removed.",t?(0,i.jsxs)(i.Fragment,{children:[" ","Project will also ",(0,i.jsx)("span",{className:"font-bold",children:"need to be restarted"})," due to change in compute instance"]}):""]})};var av=e=>{var a;let{visible:t,selectedPlan:s,subscription:n,onClose:r,onConfirm:l,projects:o}=e,d=(null==n?void 0:n.project_addons.flatMap(e=>{let a=e.addons.filter(e=>"ci_micro"!==e.variant.identifier);return a.length?{...e,addons:a}:[]}))||[],c=o.some(e=>"micro"===e.infra_compute_size),u=(null==n?void 0:n.nano_enabled)===!0;return(0,i.jsx)(eD.Z,{size:"large",alignFooter:"right",visible:t,onCancel:r,onConfirm:l,header:"Confirm to downgrade to ".concat(null==s?void 0:s.name," plan"),children:(0,i.jsxs)(eD.Z.Content,{children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(ef.b,{withIcon:!0,variant:"warning",title:"Downgrading to the Free Plan will lead to reductions in your organization's quota",children:(0,i.jsx)("p",{children:"If you're already past the limits of the Free Plan, your projects could become unresponsive or enter read only mode."})}),((null!==(a=d.length)&&void 0!==a?a:0)>0||c&&u)&&(0,i.jsx)(ef.b,{title:"Projects affected by the downgrade",variant:"warning",withIcon:!0,children:(0,i.jsxs)("ul",{className:"space-y-1 max-h-[100px] overflow-y-auto",children:[d.map(e=>(0,i.jsx)(aj,{projectAddon:e},e.ref)),o.filter(e=>"micro"===e.infra_compute_size).map(e=>(0,i.jsxs)("li",{className:"list-disc ml-6",children:[e.name,": Compute will be downgraded. Project will also"," ",(0,i.jsx)("span",{className:"font-bold",children:"need to be restarted"}),"."]},e.ref))]})})]}),(0,i.jsxs)("ul",{className:"mt-4 space-y-5 text-sm",children:[(0,i.jsxs)("li",{className:"flex gap-3",children:[(0,i.jsx)("div",{children:(0,i.jsx)(ah.Z,{})}),(0,i.jsx)("span",{children:"Projects will be paused after a week of inactivity"})]}),(0,i.jsx)("li",{children:(0,i.jsxs)("div",{className:"flex gap-3 mb-2",children:[(0,i.jsx)("div",{children:(0,i.jsx)(ax.Z,{})}),(0,i.jsx)("span",{children:"Add ons from all projects under this organization will be removed."})]})}),(0,i.jsxs)("li",{className:"flex gap-3",children:[(0,i.jsx)(ag.Z,{size:14,className:"flex-shrink-0"}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("strong",{children:["Before you downgrade to the ",null==s?void 0:s.name," plan, consider:"]}),(0,i.jsxs)("ul",{className:"space-y-2 mt-2",children:[(0,i.jsx)("li",{className:"list-disc ml-4",children:"Your projects no longer require their respective add ons."}),(0,i.jsxs)("li",{className:"list-disc ml-4",children:["Your resource consumption are well within the ",null==s?void 0:s.name," plan's quota."]}),(0,i.jsx)("li",{className:"list-disc ml-4",children:"Alternatively, you may also transfer projects across organizations."})]})]})]})]}),(null==n?void 0:n.billing_via_partner)===!0&&"fly"===n.billing_partner&&(0,i.jsx)("p",{className:"mt-4 text-sm",children:"Your organization will be downgraded at the end of your current billing cycle."})]})})},af=e=>{let{plan:a,isCurrentPlan:t,billingPartner:s}=e,n=(0,ap.g_)(a,s);return(0,i.jsxs)("div",{className:(0,U.default)("grid grid-cols-1 md:grid-cols-3 border rounded-md bg-studio","py-4 col-span-12 justify-between gap-x-8"),children:[(0,i.jsxs)("div",{className:"flex flex-col justify-center px-4",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("p",{className:(0,U.default)("text-brand text-sm uppercase"),children:a.name}),t?(0,i.jsx)("div",{className:"text-xs bg-surface-300 text-foreground-light rounded px-2 py-0.5",children:"Current plan"}):a.nameBadge?(0,i.jsx)("div",{className:"text-xs bg-surface-200 text-brand rounded px-2 py-0.5",children:a.nameBadge}):null]}),(0,i.jsx)("p",{className:"text-sm mt-2 mb-4",children:a.description}),(0,i.jsx)("a",{href:a.href,className:"hidden md:block",target:"_blank",children:(0,i.jsx)(W.z,{block:!0,type:"default",size:"tiny",children:a.cta})})]}),(0,i.jsxs)("div",{className:"flex flex-col justify-center col-span-2 px-4 md:px-0",children:[(0,i.jsx)("ul",{role:"list",className:"text-xs text-foreground-light md:grid md:grid-cols-2 md:gap-x-10",children:n.map(e=>(0,i.jsxs)("li",{className:"flex items-center py-2 first:mt-0",children:[(0,i.jsx)(at.Z,{className:"text-brand h-4 w-4","aria-hidden":"true",strokeWidth:3}),(0,i.jsx)("span",{className:"text-foreground mb-0 ml-3 ",children:"string"==typeof e?e:e[0]})]},"string"==typeof e?e:e[0]))}),(0,i.jsx)("a",{href:a.href,className:"visible md:hidden mt-8",target:"_blank",children:(0,i.jsx)(W.z,{block:!0,type:"default",size:"tiny",children:a.cta})})]})]},a.id)},ay=t(11886),ab=t.n(ay),aN=t(67304),aw=t.n(aN),a_=t(29887);let aS=["Pricing","My project isn't getting traction","Poor customer service","Missing feature","I didn't see the value","Supabase didn't meet my needs","Dashboard is too complicated","Postgres is too complicated","Problem not solved","Too many bugs/issues","I decided to use something else","My work has finished/discontinued","Im migrating to/starting a new project","None of the above"];var aC=e=>{let{visible:a,subscription:t,projects:s,onClose:n}=e,{slug:l}=(0,r.UO)(),o=(0,u.useRef)(null),[d,c]=(0,u.useState)(""),[p,h]=(0,u.useState)(null),[x,g]=(0,u.useReducer)(function(e,a){return ab()(e,a.target.value)?aw()(e,a.target.value):[...e,a.target.value]},[]),j=(0,eg.P)("disableProjectCreationAndUpdate"),{mutate:v,isLoading:f}=eS({onError:e=>{C(),m.Am.error("Failed to downgrade project: ".concat(e.message))}}),{mutateAsync:y,isLoading:b}=(0,a_.S)(),N=f||b,w=s.filter(e=>{let a=["nano"];return(null==t?void 0:t.nano_enabled)===!1&&a.push("micro"),!a.includes(e.infra_compute_size)}),_=w.length>0,S=(null==t?void 0:t.billing_via_partner)===!1||(null==t?void 0:t.billing_partner)!=="fly",C=()=>{var e;h(null),null===(e=o.current)||void 0===e||e.resetCaptcha()},I=async()=>{if(0===x.length)return m.Am.error("Please select at least one reason for canceling your subscription");let e=p;if(!e){var a,t;let s=await (null===(a=o.current)||void 0===a?void 0:a.execute({async:!0}));e=null!==(t=null==s?void 0:s.response)&&void 0!==t?t:null,await A()}},A=async()=>{if(!l)return console.error("Slug is required");v({slug:l,tier:"tier_free"},{onSuccess:async()=>{C();try{await y({orgSlug:l,reasons:x.reduce((e,a)=>"".concat(e,"- ").concat(a,"\n"),""),message:d,exitAction:"downgrade"})}catch(e){}finally{m.Am.success(S?_?"Successfully downgraded organization to the Free Plan. Your projects are currently restarting to update their compute instances.":"Successfully downgraded organization to the Free Plan":"Your organization is scheduled for the downgrade at the end of your current billing cycle",{duration:_?8e3:4e3}),n(!0),window.scrollTo({top:0,left:0,behavior:"smooth"})}}})};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"self-center",children:(0,i.jsx)(eP.Z,{ref:o,sitekey:"4ca1fdb9-c9c9-4495-ba50-c85fc0e7ec1f",size:"invisible",onVerify:e=>{h(e),void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onExpire:()=>h(null),onOpen:()=>{void 0!==document&&document.body.classList.add("!pointer-events-auto")},onClose:()=>{void 0!==document&&document.body.classList.remove("!pointer-events-auto")}})}),(0,i.jsxs)(eD.Z,{hideFooter:!0,size:"xlarge",visible:a,onCancel:n,header:"Help us improve.",children:[(0,i.jsx)(eD.Z.Content,{children:(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"We always strive to improve Supabase as much as we can. Please let us know the reasons you are canceling your subscription so that we can improve in the future."}),(0,i.jsxs)("div",{className:"space-y-8 mt-6",children:[(0,i.jsx)("div",{className:"flex flex-wrap gap-2","data-toggle":"buttons",children:aS.map(e=>{let a=x.find(a=>a===e);return(0,i.jsxs)("label",{className:"\n                      flex cursor-pointer items-center space-x-2 rounded-md py-1 \n                      pl-2 pr-3 text-center text-sm\n                      shadow-sm transition-all duration-100\n                      ".concat(a?" bg-foreground text-background opacity-100 hover:bg-opacity-75":" bg-border-strong text-foreground opacity-25 hover:opacity-50","\n                  "),children:[(0,i.jsx)("input",{type:"checkbox",name:"options",value:e,className:"hidden",onClick:g}),(0,i.jsx)("div",{children:e})]},e)})}),(0,i.jsx)("div",{className:"text-area-text-sm",children:(0,i.jsx)(k.Z.TextArea,{id:"message",name:"message",value:d,onChange:e=>c(e.target.value),label:"Anything else that we can improve on?"})})]}),_&&(0,i.jsxs)(ef.b,{withIcon:!0,variant:"warning",title:"".concat(w.length," of your projects will be restarted ").concat(S?"upon clicking confirm":"once the downgrade takes effect at the end of your current billing cycle"),children:["This is due to changes in compute instances from the downgrade. Affected projects include ",w.map(e=>e.name).join(", "),"."]})]})}),(0,i.jsxs)("div",{className:"flex items-center justify-between border-t px-4 py-4",children:[S&&(0,i.jsx)("p",{className:"text-xs text-foreground-lighter",children:"The unused amount for the remaining of your billing cycle will be refunded as credits"}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(W.z,{type:"default",onClick:()=>n(),children:"Cancel"}),(0,i.jsx)(eb.Z,{projectUpdateDisabled:j,children:(0,i.jsx)(W.z,{type:"danger",className:"pointer-events-auto",loading:N,disabled:j||N,onClick:I,children:"Confirm downgrade"})})]})]})]})]})},aI=e=>{let{visible:a,onClose:t}=e,s=(0,z.l)(),n=null==s?void 0:s.slug,{data:r}=(0,al.u)({slug:n});return(0,i.jsxs)(eD.Z,{hideFooter:!0,visible:a,size:"medium",header:"Your organization has members who have exceeded their free project limits",onCancel:t,children:[(0,i.jsx)(eD.Z.Content,{children:(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"The following members have reached their maximum limits for the number of active free plan projects within organizations where they are an administrator or owner:"}),(0,i.jsx)("ul",{className:"pl-5 text-sm list-disc text-foreground-light",children:(r||[]).map((e,a)=>(0,i.jsxs)("li",{children:[e.username||e.primary_email," (Limit: ",e.free_project_limit," free projects)"]},"member-".concat(a)))}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"These members will need to either delete, pause, or upgrade one or more of these projects before you're able to downgrade this project."})]})}),(0,i.jsx)(eD.Z.Separator,{}),(0,i.jsx)(eD.Z.Content,{className:"flex items-center gap-2",children:(0,i.jsx)(W.z,{htmlType:"button",type:"default",onClick:t,block:!0,children:"Understood"})})]})},aA=t(6838),aZ=t(52006),az=e=>{let{selectedPaymentMethod:a,onSelectPaymentMethod:t,layout:s="vertical"}=e,n=(0,z.l)(),r=null==n?void 0:n.slug,[l,o]=(0,u.useState)(!1),{data:d,isLoading:p,refetch:h}=eX({slug:r}),x=(0,N.Xo)(c.KA.BILLING_WRITE,"stripe.payment_methods");return(0,u.useEffect)(()=>{if((null==d?void 0:d.data)&&d.data.length>0){let e=d.data.some(e=>e.id===a);if(!a||!e){let e=d.data.find(e=>e.is_default);void 0!==e?t(e.id):t(d.data[0].id)}}},[a,d,t]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{children:p?(0,i.jsxs)("div",{className:"flex items-center px-4 py-2 space-x-4 border rounded-md border-strong bg-surface-200",children:[(0,i.jsx)(aA.Z,{className:"animate-spin",size:14}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"Retrieving payment methods"})]}):(null==d?void 0:d.data.length)===0?(0,i.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 border border-dashed rounded-md bg-alternative",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-4 text-foreground-light",children:[(0,i.jsx)(aZ.Z,{size:16,strokeWidth:1.5}),(0,i.jsx)("p",{className:"text-sm",children:"No saved payment methods"})]}),(0,i.jsxs)(F.fC,{delayDuration:0,children:[(0,i.jsx)(F.xz,{asChild:!0,children:(0,i.jsx)(W.z,{type:"default",disabled:!x,icon:(0,i.jsx)(eQ.Z,{}),onClick:()=>o(!0),htmlType:"button",children:"Add new"})}),!x&&(0,i.jsx)(F.h_,{children:(0,i.jsxs)(F.VY,{side:"bottom",children:[(0,i.jsx)(F.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow w-48 border border-background text-center",children:(0,i.jsx)("span",{className:"text-xs text-foreground",children:"You need additional permissions to add new payment methods to this organization"})})]})})]})]}):(0,i.jsxs)(T.Z,{layout:s,label:"Payment method",value:a,onChange:t,className:"flex items-center",children:[null==d?void 0:d.data.map(e=>{let a="   ".concat(e.card.last4);return(0,i.jsx)(T.Z.Option,{label:a,value:e.id,addOnBefore:()=>(0,i.jsx)("img",{alt:"Credit Card Brand",src:"".concat(ej.GW,"/img/payment-methods/").concat(e.card.brand.replace(" ","-").toLowerCase(),".png"),width:"32"}),children:(0,i.jsx)("div",{children:a})},e.id)}),(0,i.jsxs)("div",{className:"flex items-center px-3 py-2 space-x-2 transition cursor-pointer group hover:bg-surface-300",onClick:()=>o(!0),children:[(0,i.jsx)(eK.Z,{size:16}),(0,i.jsx)("p",{className:"transition text-foreground-light group-hover:text-foreground",children:"Add new payment method"})]})]})}),(0,i.jsx)(eq,{visible:l,returnUrl:"".concat((0,V.Ax)(),"/org/").concat(null==n?void 0:n.slug,"/billing?panel=subscriptionPlan"),onCancel:()=>o(!1),onConfirm:async()=>{var e;o(!1),m.Am.success("Successfully added new payment method");let{data:a}=await h();(null==a?void 0:null===(e=a.data)||void 0===e?void 0:e.length)&&t((null==a?void 0:a.data.reduce((e,a)=>e.created>a.created?e:a,a.data[0])).id)}})]})};async function aE(e){let{orgSlug:a,prevPlan:t,currentPlan:s,reasons:n,message:i}=e,{data:r,error:l}=await (0,b.v_)("/platform/feedback/upgrade",{body:{...void 0!==a&&{orgSlug:a},...void 0!==t&&{prevPlan:t},...void 0!==s&&{currentPlan:s},reasons:n,...void 0!==i&&{additionalFeedback:i}}});return l&&(0,b.S3)(l),r}let ak=function(){let{onError:e,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,I.D)(e=>aE(e),{async onError(a,t,s){void 0===e?m.Am.error("Failed to submit upgrade survey: ".concat(a.message)):e(a,t,s)},...a})};var aT=e=>{let{visible:a,originalPlan:t,subscription:s,onClose:n}=e,{slug:l}=(0,r.UO)(),[o,d]=(0,u.useState)(""),[c,p]=(0,u.useReducer)(function(e,a){return ab()(e,a.target.value)?aw()(e,a.target.value):[...e,a.target.value]},[]),h=J(t,null==s?void 0:s.plan.id),{mutate:x,isLoading:g}=ak({onError:e=>{m.Am.error("Failed to submit survey: ".concat(e.message))},onSuccess:()=>{n(!0),window.scrollTo({top:0,left:0,behavior:"smooth"})}}),j=async()=>{var e;if(0===c.length)return m.Am.error("Please select at least one reason for upgrading your subscription");x({orgSlug:l,prevPlan:t,currentPlan:null==s?void 0:null===(e=s.plan)||void 0===e?void 0:e.id,reasons:c,message:o.trim()||void 0})};return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(eD.Z,{alignFooter:"right",size:"xlarge",loading:g,visible:a,onCancel:n,onConfirm:j,cancelText:"Skip",header:"We're excited for your upgrade",children:(0,i.jsxs)(eD.Z.Content,{className:"space-y-4",children:[(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"What reasons motivated your decision to upgrade? Your feedback helps us improve Supabase as much as we can."}),(0,i.jsxs)("div",{className:"space-y-8 mt-6",children:[(0,i.jsx)("div",{className:"flex flex-wrap gap-2","data-toggle":"buttons",children:h.map(e=>{let a=c.find(a=>a===e);return(0,i.jsxs)("label",{className:"\n                      flex cursor-pointer items-center space-x-2 rounded-md py-1 \n                      pl-2 pr-3 text-center text-sm\n                      shadow-sm transition-all duration-100\n                      ".concat(a?" bg-foreground text-background opacity-100 hover:bg-opacity-75":" bg-border-strong text-foreground opacity-25 hover:opacity-50","\n                  "),children:[(0,i.jsx)("input",{type:"checkbox",name:"options",value:e,className:"hidden",onClick:p}),(0,i.jsx)("div",{children:e})]},e)})}),(0,i.jsx)("div",{className:"text-area-text-sm",children:(0,i.jsx)(k.Z.TextArea,{id:"message",name:"message",value:o,onChange:e=>d(e.target.value),label:"Anything else that we can improve on?"})})]})]})})})},aP=()=>{var e,a,t,s;let n=(0,as.useRouter)(),r=(0,z.l)(),l=null==r?void 0:r.slug,o=(0,C.NL)(),h=(0,u.useRef)(),[x,g]=(0,u.useState)(!1),[j,v]=(0,u.useState)(!1),[y,b]=(0,u.useState)(),[_,S]=(0,u.useState)(!1),[I,A]=(0,u.useState)(),[Z,E]=(0,u.useState)([]),k=(0,N.Xo)(c.KA.BILLING_WRITE,"stripe.subscriptions"),{data:T}=(0,ac.Sy)(),P=(T||[]).filter(e=>e.organization_id===(null==r?void 0:r.id)),O=(0,ev.Wu)(),R="subscriptionPlan"===O.panelKey,D=()=>{let{panel:e,...a}=n.query;n.push({pathname:n.pathname,query:a},void 0,{shallow:!0}),O.setPanelKey(void 0)},{data:L,isSuccess:U}=(0,d.Gl)({orgSlug:l}),{data:F,isLoading:Y}=am({orgSlug:l}),{data:G}=(0,al.u)({slug:l}),{mutate:B,isLoading:q}=eS({onSuccess:()=>{m.Am.success("Successfully updated subscription to ".concat(null==ei?void 0:ei.name,"!")),A(void 0),D(),window.scrollTo({top:0,left:0,behavior:"smooth"}),v(!0)},onError:e=>{m.Am.error("Unable to update subscription: ".concat(e.message))}}),H=(null==L?void 0:L.billing_via_partner)===!0,X=null==L?void 0:L.billing_partner,K=(null==L?void 0:L.payment_method_type)==="invoice",{data:Q,error:J,isLoading:ea,isSuccess:et}=ad({tier:I,organizationSlug:l}),es=null!==(t=null==F?void 0:F.plans)&&void 0!==t?t:[],en=(G||[]).length>0,ei=ap.z5.find(e=>e.id===I),er=e=>{E([...Z,e])},el=e=>{E(Z.filter(a=>a!==e))};(0,u.useEffect)(()=>{R&&A(void 0)},[R]),(0,u.useEffect)(()=>{R&&U&&(h.current=L.plan.id)},[R,U]);let ed=async()=>{var e;return l?I?y||K?void(y&&o.setQueriesData(w.O.paymentMethods(l),e=>e?{...e,defaultPaymentMethodId:y,data:e.data.map(e=>({...e,is_default:e.id===y}))}:e),B({slug:l,tier:(null==L?void 0:null===(e=L.plan)||void 0===e?void 0:e.id)==="team"&&I===ej.ev.PRO?ej.ev.PAYG:I,paymentMethod:y})):m.Am.error("Please select a payment method"):console.error("Selected plan is required"):console.error("org slug is required")},ec=I?es.find(e=>e.id===I.split("tier_")[1]):null;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eI.ZP,{hideFooter:!0,size:"xxlarge",visible:R,onCancel:()=>D(),header:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("h4",{children:["Change subscription plan for ",null==r?void 0:r.name]}),(0,i.jsx)(W.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{strokeWidth:1.5}),children:(0,i.jsx)(M(),{href:"https://supabase.com/pricing",target:"_blank",rel:"noreferrer",children:"Pricing"})})]}),children:(0,i.jsx)(eI.ZP.Content,{children:(0,i.jsx)("div",{className:"py-6 grid grid-cols-12 gap-3",children:ap.z5.map(e=>{var a,t,s,n;let r=es.find(a=>a.id===e.id.split("tier_")[1]),l=null!==(n=null==r?void 0:r.price)&&void 0!==n?n:0,o=(null==r?void 0:r.change_type)==="downgrade",d=(null==r?void 0:r.id)===(null==L?void 0:null===(a=L.plan)||void 0===a?void 0:a.id),c=(0,ap.g_)(e,X),u=(0,ap.nq)(e,X);return"tier_enterprise"===e.id?(0,i.jsx)(af,{plan:e,isCurrentPlan:d,billingPartner:X},e.id):(0,i.jsxs)("div",{className:"border rounded-md px-4 py-4 flex flex-col items-start justify-between col-span-12 md:col-span-4 bg-surface-200",children:[(0,i.jsxs)("div",{className:"w-full",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("p",{className:(0,eA.cn)("text-brand text-sm uppercase"),children:e.name}),d?(0,i.jsx)("div",{className:"text-xs bg-surface-300 text-foreground-light rounded px-2 py-0.5",children:"Current plan"}):e.nameBadge?(0,i.jsx)("div",{className:"text-xs bg-brand-400 text-brand-600 rounded px-2 py-0.5",children:e.nameBadge}):(0,i.jsx)(i.Fragment,{})]}),(0,i.jsxs)("div",{className:"mt-4 flex items-center space-x-1 mb-4",children:[(null!=l?l:0)>0&&(0,i.jsx)("p",{className:"text-foreground-light text-sm",children:"From"}),Y?(0,i.jsx)("div",{className:"h-[28px] flex items-center justify-center",children:(0,i.jsx)(f.Z,{className:"w-[30px] h-[24px]"})}):(0,i.jsx)("p",{className:"text-foreground text-lg",children:(0,V.xG)(l)}),(0,i.jsx)("p",{className:"text-foreground-light text-sm",children:e.costUnit})]}),d?(0,i.jsx)(W.z,{block:!0,disabled:!0,type:"default",children:"Current plan"}):(0,i.jsxs)(ai.u,{block:!0,type:o?"default":"primary",disabled:(null==L?void 0:null===(t=L.plan)||void 0===t?void 0:t.id)==="enterprise"||!k,onClick:()=>A(e.id),tooltip:{content:{side:"bottom",text:(null==L?void 0:null===(s=L.plan)||void 0===s?void 0:s.id)==="enterprise"?"Reach out to us via support to update your plan from Enterprise":k?void 0:"You do not have permission to change the subscription plan"}},children:[o?"Downgrade":"Upgrade"," to ",e.name]}),(0,i.jsx)("div",{className:"border-t my-4"}),(0,i.jsx)("ul",{role:"list",children:c.map(e=>(0,i.jsxs)("li",{className:"flex py-2",children:[(0,i.jsx)("div",{className:"w-[12px]",children:(0,i.jsx)(at.Z,{className:"h-3 w-3 text-brand translate-y-[2.5px]","aria-hidden":"true",strokeWidth:3})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"ml-3 text-xs text-foreground-light",children:"string"==typeof e?e:e[0]}),aa()(e)&&(0,i.jsx)("p",{className:"ml-3 text-xs text-foreground-lighter",children:e[1]})]})]},"string"==typeof e?e:e[0]))})]}),u&&(0,i.jsx)("div",{className:"border-t pt-4 mt-4",children:(0,i.jsx)("p",{className:"text-foreground-light text-xs",children:u})})]},e.id)})})})}),(0,i.jsx)(av,{visible:"tier_free"===I,selectedPlan:ei,subscription:L,onClose:()=>A(void 0),onConfirm:()=>{A(void 0),en?S(!0):g(!0)},projects:P}),(0,i.jsxs)(eD.Z,{loading:q,alignFooter:"right",size:"xlarge",visible:void 0!==I&&"tier_free"!==I,onCancel:()=>A(void 0),onConfirm:ed,dialogOverlayProps:{className:"pointer-events-none"},header:"Confirm ".concat((null==ec?void 0:ec.change_type)==="downgrade"?"downgrade":"upgrade"," to ").concat(null==ei?void 0:ei.name),children:[(0,i.jsxs)(eD.Z.Content,{children:[J&&(0,i.jsx)(p.Z,{error:J,subject:"Failed to preview subscription."}),ea&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("span",{className:"text-sm",children:"Estimating monthly costs..."}),(0,i.jsx)(f.Z,{}),(0,i.jsx)(f.Z,{className:"w-3/4"}),(0,i.jsx)(f.Z,{className:"w-1/2"})]}),et&&(0,i.jsxs)("div",{children:[(0,i.jsx)(eN.Z,{className:"mt-2",borderless:!0,head:[(0,i.jsx)(eN.Z.th,{children:"Item"},"header-item"),(0,i.jsx)(eN.Z.th,{className:"text-right pr-4",children:"Usage"},"header-count"),(0,i.jsx)(eN.Z.th,{children:"Unit Price"},"header-unit-price"),(0,i.jsx)(eN.Z.th,{className:"text-right",children:"Cost"},"header-price")],body:(0,i.jsxs)(i.Fragment,{children:[Q.breakdown.map(e=>{var a,t;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(eN.Z.tr,{children:[(0,i.jsxs)(eN.Z.td,{children:[e.breakdown&&e.breakdown.length>0&&(0,i.jsx)(W.z,{type:"text",className:"!pl-0 !pr-1",icon:(0,i.jsx)($.Z,{className:(0,eA.cn)("transition",Z.includes(e.description)&&"rotate-90")}),onClick:()=>Z.includes(e.description)?el(e.description):er(e.description)}),null!==(t=e.description)&&void 0!==t?t:"Unknown"," ",e.description.endsWith("Compute")&&" (Hours)"]}),(0,i.jsx)(eN.Z.td,{className:"text-right pr-4 tabular-nums",children:null===(a=e.quantity)||void 0===a?void 0:a.toLocaleString()}),(0,i.jsx)(eN.Z.td,{children:e.unit_price_desc?e.unit_price_desc:0===e.unit_price?"FREE":e.unit_price?"".concat((0,V.xG)(e.unit_price)):""}),(0,i.jsx)(eN.Z.td,{className:"text-right",children:(0,V.xG)(e.total_price)})]},e.description),Z.includes(e.description)&&e.breakdown&&e.breakdown.length>0&&e.breakdown.map(e=>(0,i.jsxs)(eN.Z.tr,{children:[(0,i.jsx)(eN.Z.td,{className:"!pl-12",children:e.project_name}),(0,i.jsx)(eN.Z.td,{className:"text-right pr-4 tabular-nums",children:e.usage}),(0,i.jsx)(eN.Z.td,{}),(0,i.jsx)(eN.Z.td,{})]},e.project_ref))]})}),(0,i.jsxs)(eN.Z.tr,{children:[(0,i.jsx)(eN.Z.td,{className:"font-medium",children:"Monthly Costs (excluding over-usage and credits)"}),(0,i.jsx)(eN.Z.td,{}),(0,i.jsx)(eN.Z.td,{}),(0,i.jsx)(eN.Z.td,{className:"text-right font-medium",children:(0,V.xG)(null!==(s=Math.round(Q.breakdown.reduce((e,a)=>e+a.total_price,0)))&&void 0!==s?s:0)})]})]})}),(0,i.jsx)(ar.Z,{className:"mt-4",title:"Usage-billing for Compute",icon:(0,i.jsx)(ee.Z,{}),defaultVisibility:!0,hideCollapse:!0,description:(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm mt-2",children:"Each project is a dedicated server and database. Paid plans come with $10 of Compute Credits to cover one project on the default Micro Compute size or parts of any compute addon. Additional unpaused projects on paid plans will incur compute usage costs starting at $10 per month, billed hourly."}),(null==L?void 0:null===(e=L.plan)||void 0===e?void 0:e.id)==="free"&&(0,i.jsx)("p",{className:"text-sm mt-2",children:"Mixing paid and non-paid projects in a single organization is not possible. If you want projects to be on the Free Plan, use self-serve project transfers."}),(0,i.jsxs)("div",{className:"space-x-3 mt-2",children:[(0,i.jsx)(W.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{strokeWidth:1.5}),children:(0,i.jsx)(M(),{href:"https://supabase.com/docs/guides/platform/org-based-billing",target:"_blank",rel:"noreferrer",children:"How billing works"})}),(null==L?void 0:null===(a=L.plan)||void 0===a?void 0:a.id)==="free"&&(0,i.jsx)(W.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{strokeWidth:1.5}),children:(0,i.jsx)(M(),{href:"https://supabase.com/docs/guides/platform/project-transfer",target:"_blank",rel:"noreferrer",children:"Project transfers"})})]})]})})]})]}),(0,i.jsx)(eD.Z.Content,{children:H?(0,i.jsxs)("div",{className:"py-4 space-y-2",children:[(0,i.jsxs)("p",{className:"text-sm",children:["This organization is billed through our partner"," ",(0,an.Gh)(X),"."," ","aws"===X?(0,i.jsx)(i.Fragment,{children:"The organization's credit balance will be decreased accordingly."}):(0,i.jsx)(i.Fragment,{children:"You will be charged by them directly."})]}),H&&"fly"===X&&(null==Q?void 0:Q.plan_change_type)==="downgrade"&&(0,i.jsx)("p",{className:"text-sm",children:"Your organization will be downgraded at the end of your current billing cycle."})]}):(0,i.jsxs)("div",{className:"py-4 space-y-2",children:[(0,i.jsx)("p",{className:"text-sm",children:"Upon clicking confirm, your monthly invoice will be adjusted and your credit card will be charged immediately. Changing the plan resets your billing cycle and may result in a prorated charge for previous usage."}),(0,i.jsx)("div",{className:"!mt-4",children:(0,i.jsx)(az,{selectedPaymentMethod:y,onSelectPaymentMethod:b})})]})})]}),(0,i.jsx)(aI,{visible:_,onClose:()=>S(!1)}),(0,i.jsx)(aC,{visible:x,subscription:L,projects:P,onClose:e=>{g(!1),e&&D()}}),(0,i.jsx)(aT,{visible:j,originalPlan:h.current,subscription:L,onClose:e=>{v(!1),e&&D()}})]})},aO=()=>{var e,a,t,s,n,o,u,m;let{slug:h}=(0,r.UO)(),x=(0,ev.Wu)(),g=(0,eg.P)("disableProjectCreationAndUpdate"),v=(0,N.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),{data:y,error:b,isLoading:w,isError:_,isSuccess:S}=(0,d.Gl)({orgSlug:h},{enabled:v}),{mutate:C,isLoading:I}=ex(),A=null==y?void 0:y.plan,Z=null!==(s=null==A?void 0:A.name)&&void 0!==s?s:"Unknown",z=D().unix(null!==(n=null==y?void 0:y.current_period_start)&&void 0!==n?n:0).utc(),E=D().unix(null!==(o=null==y?void 0:y.current_period_end)&&void 0!==o?o:0).utc(),k=E.diff(D()(),"days"),T=E.diff(z,"days"),P=!g&&!["enterprise"].includes(null!==(u=null==A?void 0:A.id)&&void 0!==u?u:"");return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(l.jX,{children:[(0,i.jsx)("div",{className:"col-span-12 pb-2",children:(0,i.jsx)(e9,{})}),(0,i.jsx)(l.g$,{children:(0,i.jsxs)("div",{className:"sticky space-y-6 top-12",children:[(0,i.jsx)("p",{className:"text-foreground text-base m-0",children:"Subscription Plan"}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"More information"}),(0,i.jsx)("div",{children:(0,i.jsx)(M(),{href:"https://supabase.com/pricing",target:"_blank",rel:"noreferrer",children:(0,i.jsxs)("div",{className:"flex items-center space-x-2 opacity-50 hover:opacity-100 transition",children:[(0,i.jsx)("p",{className:"text-sm m-0",children:"Pricing"}),(0,i.jsx)(eo.Z,{size:16,strokeWidth:1.5})]})})})]})]})}),(0,i.jsx)(l.Lc,{children:v?(0,i.jsxs)(i.Fragment,{children:[w&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(f.Z,{}),(0,i.jsx)(f.Z,{className:"w-3/4"}),(0,i.jsx)(f.Z,{className:"w-1/2"})]}),_&&(0,i.jsx)(p.Z,{subject:"Failed to retrieve subscription",error:b}),S&&(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-sm",children:"This organization is currently on the plan:"}),(0,i.jsx)("p",{className:"text-2xl text-brand uppercase",children:null!==(m=null==A?void 0:A.name)&&void 0!==m?m:"Unknown"})]}),(null==y?void 0:y.scheduled_plan_change)&&(null==y?void 0:null===(e=y.scheduled_plan_change)||void 0===e?void 0:e.target_plan)!==y.plan.id&&(0,i.jsxs)(ey.bZ,{className:"mb-2",title:"Scheduled downgrade",children:[(0,i.jsx)(ed.Z,{className:"h-4 w-4"}),(0,i.jsx)(ey.Cd,{children:"Scheduled downgrade"}),(0,i.jsxs)(ey.X,{className:"flex flex-col gap-3",children:[(0,i.jsxs)("div",{children:["Your organization will automatically be downgraded from the"," ",(0,i.jsx)("span",{children:y.plan.name})," plan to the"," ",(0,i.jsx)("span",{className:"capitalize",children:null==y?void 0:null===(a=y.scheduled_plan_change)||void 0===a?void 0:a.target_plan})," ","plan on"," ",D()(null==y?void 0:null===(t=y.scheduled_plan_change)||void 0===t?void 0:t.at).format("MMMM D, YYYY"),". If you would like to stay on the ",(0,i.jsx)("span",{children:y.plan.name})," ","plan, cancel the scheduled downgrade."]}),(0,i.jsx)("div",{children:(0,i.jsx)(W.z,{type:"default",loading:I,onClick:()=>C({slug:h}),children:"Cancel downgrade"})})]})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)(eb.Z,{projectUpdateDisabled:g,children:(0,i.jsx)(W.z,{type:"default",className:"pointer-events-auto",disabled:!P,onClick:()=>x.setPanelKey("subscriptionPlan"),children:"Change subscription plan"})}),!P&&(g?(0,i.jsx)(ef.b,{className:"mt-2",withIcon:!0,variant:"info",title:"Unable to update plan from ".concat(Z),children:"We have temporarily disabled project and subscription changes - our engineers are working on a fix."}):(0,i.jsx)(ef.b,{withIcon:!0,className:"mt-2",variant:"info",title:"Unable to update plan from ".concat(Z),actions:[(0,i.jsx)("div",{children:(0,i.jsx)(W.z,{asChild:!0,type:"default",children:(0,i.jsx)(M(),{href:"/support/new?category=sales&subject=Change%20plan%20away%20from%20".concat(Z),children:"Contact support"})})},"contact-support")],children:"Please contact us if you'd like to change your plan."}))]}),!(null==y?void 0:y.usage_billing_enabled)&&(0,i.jsx)(ef.b,{withIcon:!0,variant:"info",title:"This organization is limited by the included usage",actions:(null==A?void 0:A.id)==="free"?(0,i.jsx)(W.z,{type:"default",onClick:()=>x.setPanelKey("subscriptionPlan"),children:"Upgrade Plan"}):(0,i.jsx)(W.z,{type:"default",onClick:()=>x.setPanelKey("costControl"),children:"Adjust Spend Cap"}),children:(0,i.jsxs)("div",{className:"text-sm text-foreground-light mr-2",children:["When this organization exceeds its"," ",(0,i.jsx)(M(),{href:"/org/".concat(h,"/usage"),className:"text-sm text-green-900 transition hover:text-green-1000",children:"included usage quotas"}),", its projects may become unresponsive."," ",(null==A?void 0:A.id)==="free"?(0,i.jsx)("p",{className:"pr-4 mt-1",children:"If you wish to exceed the included usage, you should upgrade to a paid plan."}):(0,i.jsx)("p",{className:"pr-4 mt-1",children:"You currently have Spend Cap enabled - when you exceed your plan's limit, you will experience restrictions. To scale seamlessly and pay for over-usage, you can adjust your Cost Control settings."})]})}),(0,i.jsx)(e6.Z,{type:"horizontal",value:T-k,max:T,barClass:"bg-foreground",labelBottom:"Current billing cycle (".concat(z.format("MMM DD")," - ").concat(E.format("MMM DD"),")"),bgClass:"bg-surface-300",labelBottomClass:"!text-foreground-light pb-1",labelTop:"".concat(k," days remaining")})]})]}):(0,i.jsx)(j.Z,{resourceText:"view this organization's subscription"})})]}),(0,i.jsx)(aP,{})]})},aR=t(88883),aD=t(63955),aL=t(30195),aM=t(64306);async function aU(e,a){let{slug:t}=e;if(!t)throw Error("slug is required");let{data:s,error:n}=await (0,b.U2)("/platform/organizations/{slug}/tax-ids",{params:{path:{slug:t}},signal:a,headers:{Version:"2"}});if(n)throw(0,b.S3)(n);return s.tax_id}let aF=function(e){let{slug:a}=e,{enabled:t=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,y.a)(w.O.taxId(a),e=>{let{signal:t}=e;return aU({slug:a},t)},{enabled:t&&void 0!==a,...s})};async function aY(e){let{slug:a,taxId:t}=e;if(!a)throw Error("Slug is required");if(null!=t){let{data:e,error:s}=await (0,b.gz)("/platform/organizations/{slug}/tax-ids",{params:{path:{slug:a}},body:{type:t.type,value:t.value,country:t.country}});return s&&(0,b.S3)(s),e}{let{data:e,error:t}=await (0,b.IV)("/platform/organizations/{slug}/tax-ids",{params:{path:{slug:a}},headers:{Version:"2"}});return t&&(0,b.S3)(t),e}}let aG=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,I.D)(e=>aY(e),{async onSuccess(a,t,n){let{slug:i}=t;s.setQueryData(w.O.taxId(i),a.tax_id),await (null==e?void 0:e(a,t,n))},async onError(e,t,s){void 0===a?m.Am.error("Failed to update tax id: ".concat(e.message)):a(e,t,s)},...t})};var aB=t(22574),aV=t(62949),aW=t(42070);let aq=[{name:"AE TRN",type:"ae_trn",country:"United Arab Emirates",placeholder:"123456789012345",countryIso2:"AE"},{name:"AT VAT",type:"eu_vat",country:"Austria",placeholder:"ATU12345678",vatPrefix:"ATU",countryIso2:"AT"},{name:"AD NRT",type:"ad_nrt",country:"Andorra",placeholder:"A-123456-Z",countryIso2:"AD"},{name:"AR CUIT",type:"ar_cuit",country:"Argentina",placeholder:"12-3456789-01",countryIso2:"AR"},{name:"AU ABN",type:"au_abn",country:"Australia",placeholder:"12345678912",countryIso2:"AU"},{name:"AU ARN",type:"au_arn",country:"Australia",placeholder:"123456789123",countryIso2:"AU"},{name:"BE VAT",type:"eu_vat",country:"Belgium",placeholder:"BE0123456789",vatPrefix:"BE",countryIso2:"BE"},{name:"BO TIN",type:"bo_tin",country:"Bolivia",placeholder:"123456789",countryIso2:"BO"},{name:"BG VAT",type:"eu_vat",country:"Bulgaria",placeholder:"BG0123456789",vatPrefix:"BG",countryIso2:"BG"},{name:"BR CNPJ",type:"br_cnpj",country:"Brazil",placeholder:"01.234.456/5432-10",countryIso2:"BR"},{name:"BR CPF",type:"br_cpf",country:"Brazil",placeholder:"123.456.789-87",countryIso2:"BR"},{name:"CA BN",type:"ca_bn",country:"Canada",placeholder:"123456789",countryIso2:"CA"},{name:"CA GST/HST",type:"ca_gst_hst",country:"Canada",placeholder:"123456789RT0002",countryIso2:"CA"},{name:"CA PST-BC",type:"ca_pst_bc",country:"Canada",placeholder:"PST-1234-5678",countryIso2:"CA"},{name:"CA PST-MB",type:"ca_pst_mb",country:"Canada",placeholder:"123456-7",countryIso2:"CA"},{name:"CA PST-SK",type:"ca_pst_mb",country:"Canada",placeholder:"1234567",countryIso2:"CA"},{name:"CA QST",type:"ca_qst",country:"Canada",placeholder:"1234567890TQ1234",countryIso2:"CA"},{name:"CH VAT",type:"ch_vat",country:"Switzerland",placeholder:"CHE-123.456.789 MWST",vatPrefix:"CHE",countryIso2:"CH"},{name:"CL TIN",type:"cl_tin",country:"Chile",placeholder:"12.345.678-K",countryIso2:"CL"},{name:"CN TIN",type:"cn_tin",country:"China",placeholder:"123456789012345678",countryIso2:"CN"},{name:"CO NIT",type:"co_nit",country:"Colombia",placeholder:"123.456.789-0",countryIso2:"CO"},{name:"CR TIN",type:"cr_tin",country:"Costa Rica",placeholder:"1-234-567890",countryIso2:"CR"},{name:"CY VAT",type:"eu_vat",country:"Cyprus",placeholder:"CY12345678Z",vatPrefix:"CY",countryIso2:"CY"},{name:"CZ VAT",type:"eu_vat",country:"Czech Republic",placeholder:"CZ1234567890",vatPrefix:"CZ",countryIso2:"CZ"},{name:"DE VAT",type:"eu_vat",country:"Germany",placeholder:"DE123456789",vatPrefix:"DE",countryIso2:"DE"},{name:"DK VAT",type:"eu_vat",country:"Denmark",placeholder:"DK12345678",vatPrefix:"DK",countryIso2:"DK"},{name:"DO RCN",type:"do_rcn",country:"Dominican Republic",placeholder:"123-4567890-1",countryIso2:"DO"},{name:"EE VAT",type:"eu_vat",country:"Estonia",placeholder:"EE123456789",vatPrefix:"EE",countryIso2:"EE"},{name:"ES CIF",type:"es_cif",country:"Spain",placeholder:"A12345678",countryIso2:"ES"},{name:"ES VAT",type:"eu_vat",country:"Spain",placeholder:"ESX1234567Z",vatPrefix:"ES",countryIso2:"ES"},{name:"FI VAT",type:"eu_vat",country:"Finland",placeholder:"FI12345678",vatPrefix:"FI",countryIso2:"FI"},{name:"FR VAT",type:"eu_vat",country:"France",placeholder:"FRAB123456789",vatPrefix:"FR",countryIso2:"FR"},{name:"GB VAT",type:"eu_vat",country:"United Kingdom",placeholder:"GB123456789",vatPrefix:"GB",countryIso2:"GB"},{name:"GE VAT",type:"ge_vat",country:"Georgia",placeholder:"123456789",countryIso2:"GE"},{name:"EL VAT",type:"eu_vat",country:"Greece",countryIso2:"GR",placeholder:"EL123456789",vatPrefix:"EL"},{name:"HK BR",type:"hk_br",country:"Hong Kong SAR China",placeholder:"12345678",countryIso2:"HK"},{name:"HR VAT",type:"eu_vat",country:"Croatia",placeholder:"HR12345678912",vatPrefix:"HR",countryIso2:"HR"},{name:"HU VAT",type:"eu_vat",country:"Hungary",placeholder:"HU12345678912",vatPrefix:"HU",countryIso2:"HU"},{name:"ID NPWP",type:"id_npwp",country:"Indonesia",placeholder:"12.345.678.9-012.345",countryIso2:"ID"},{name:"IE VAT",type:"eu_vat",country:"Ireland",placeholder:"IE1234567AB",vatPrefix:"IE",countryIso2:"IE"},{name:"IL VAT",type:"il_vat",country:"Israel",placeholder:"000012345",countryIso2:"IL"},{name:"IN GST",type:"in_gst",country:"India",placeholder:"12ABCDE3456FGZH",countryIso2:"IN"},{name:"IS VAT",type:"is_vat",country:"Iceland",placeholder:"123456",countryIso2:"IS"},{name:"IT VAT",type:"eu_vat",country:"Italy",placeholder:"IT12345678912",vatPrefix:"IT",countryIso2:"IT"},{name:"JP CN",type:"jp_cn",country:"Japan",placeholder:"1234567891234",countryIso2:"JP"},{name:"KE PIN",type:"ke_pin",country:"Kenya",placeholder:"P000111111A",countryIso2:"KE"},{name:"JP RN",type:"jp_rn",country:"Japan",placeholder:"12345",countryIso2:"JP"},{name:"KR BRN",type:"kr_brn",country:"Korea",placeholder:"123-45-67890",countryIso2:"Kr"},{name:"LI UID",type:"li_uid",country:"Liechtenstein",placeholder:"CHE123456789",countryIso2:"LI"},{name:"LT VAT",type:"eu_vat",country:"Lithuania",placeholder:"LT123456789123",vatPrefix:"LT",countryIso2:"LT"},{name:"LU VAT",type:"eu_vat",country:"Luxembourg",placeholder:"LU12345678",vatPrefix:"LU",countryIso2:"LU"},{name:"LV VAT",type:"eu_vat",country:"Latvia",placeholder:"LV12345678912",vatPrefix:"LV",countryIso2:"LV"},{name:"MT VAT",type:"eu_vat",country:"Malta",placeholder:"MT12345678",vatPrefix:"MT",countryIso2:"MT"},{name:"MX RFC",type:"mx_rfc",country:"Mexico",placeholder:"ABC010203AB9",countryIso2:"MX"},{name:"MY FRP",type:"my_frp",country:"Malaysia",placeholder:"12345678",countryIso2:"MY"},{name:"MY ITN",type:"my_itn",country:"Malaysia",placeholder:"C 1234567890",countryIso2:"MY"},{name:"MY SST",type:"my_sst",country:"Malaysia",placeholder:"A12-3456-78912345",countryIso2:"MY"},{name:"NL VAT",type:"eu_vat",country:"Netherlands",placeholder:"NL123456789B12",vatPrefix:"NL",countryIso2:"NL"},{name:"NO VAT",type:"no_vat",country:"Norway",placeholder:"123456789MVA",countryIso2:"NO"},{name:"PE RUC",type:"pe_ruc",country:"Peru",placeholder:"12345678901",countryIso2:"PE"},{name:"PH TIN",type:"ph_tin",country:"Philippines",placeholder:"123456789012",countryIso2:"PH"},{name:"NZ GST",type:"nz_gst",country:"New Zealand",placeholder:"123456789",countryIso2:"NZ"},{name:"PL VAT",type:"eu_vat",country:"Poland",placeholder:"PL1234567890",vatPrefix:"PL",countryIso2:"PL"},{name:"PT VAT",type:"eu_vat",country:"Portugal",placeholder:"PT123456789",vatPrefix:"PT",countryIso2:"PT"},{name:"RO VAT",type:"eu_vat",country:"Romania",placeholder:"RO1234567891",vatPrefix:"RO",countryIso2:"RO"},{name:"RU INN",type:"ru_inn",country:"Russia",placeholder:"1234567891",countryIso2:"RU"},{name:"RU KPP",type:"ru_kpp",country:"Russia",placeholder:"123456789",countryIso2:"RU"},{name:"SA VAT",type:"sa_vat",country:"Saudi Arabia",placeholder:"123456789012345",countryIso2:"SA"},{name:"RS PIB",type:"rs_pib",country:"Serbia",placeholder:"123456789",countryIso2:"RS"},{name:"SE VAT",type:"eu_vat",country:"Sweden",placeholder:"SE123456789123",vatPrefix:"SE",countryIso2:"SE"},{name:"SG GST",type:"sg_gst",country:"Singapore",placeholder:"M12345678X",countryIso2:"SG"},{name:"SG UEN",type:"sg_uen",country:"Singapore",placeholder:"123456789F",countryIso2:"SG"},{name:"SI VAT",type:"eu_vat",country:"Slovenia",placeholder:"SI12345678",vatPrefix:"SI",countryIso2:"SI"},{name:"SK VAT",type:"eu_vat",country:"Slovakia",placeholder:"SK1234567891",vatPrefix:"SK",countryIso2:"SK"},{name:"TH VAT",type:"th_vat",country:"Thailand",placeholder:"1234567891234",countryIso2:"TH"},{name:"TR TIN",type:"tr_tin",country:"Turkey",placeholder:"0123456789",countryIso2:"TR"},{name:"TW VAT",type:"tw_vat",country:"Taiwan",placeholder:"12345678",countryIso2:"TW"},{name:"UA VAT",type:"ua_vat",country:"Ukraine",placeholder:"123456789",countryIso2:"UA"},{name:"US EIN",type:"us_ein",country:"United States",placeholder:"12-3456789",countryIso2:"US"},{name:"XI VAT",type:"eu_vat",country:"United Kingdom (Northern Ireland)",placeholder:"XI123456789",vatPrefix:"XI",countryIso2:"GB"},{name:"ZA VAT",type:"za_vat",country:"South Africa",placeholder:"4123456789",countryIso2:"ZA"},{name:"UY RUC",type:"uy_ruc",country:"Uruguay",placeholder:"123456789012",countryIso2:"UY"},{name:"VE RIF",type:"ve_rif",country:"Venezuela",placeholder:"A-12345678-9",countryIso2:"VE"},{name:"VN TIN",type:"vn_tin",country:"Vietnam",placeholder:"1234567890",countryIso2:"VN"}],aH=e=>{let a=aq.find(a=>a.name===e.name),t=null==a?void 0:a.vatPrefix;return t&&!e.value.startsWith(t)?"".concat(t).concat(e.value):e.value},aX=(e,a)=>(null==e?void 0:e.type)===(null==a?void 0:a.type)&&(null==e?void 0:e.value)===(null==a?void 0:a.value);var aK=t(8609),aQ=()=>{var e,a;let{slug:t}=(0,r.UO)(),s=(0,z.l)(),{data:n,error:o,isLoading:d,isSuccess:x,isError:g}=aF({slug:t}),{mutate:y,isLoading:b}=aG({onSuccess:()=>{m.Am.success("Successfully updated tax id")}}),w=aL.Ry({type:aL.Z_(),value:aL.Z_(),name:aL.Z_()}),_=(0,aD.cI)({mode:"onBlur",reValidateMode:"onBlur",resolver:(0,aR.F)(w),defaultValues:{type:"",value:"",name:""}}),S=n?{type:n.type,value:n.value,name:null!==(a=null===(e=aq.find(e=>e.type===n.type&&e.countryIso2===n.country))||void 0===e?void 0:e.name)&&void 0!==a?a:""}:{type:"",value:"",name:""},C=!aX(_.getValues(),S),I=(0,N.Xo)(c.KA.BILLING_READ,"stripe.tax_ids"),A=(0,N.Xo)(c.KA.BILLING_WRITE,"stripe.tax_ids");(0,u.useEffect)(()=>{x&&S&&(_.setValue("type",S.type),_.setValue("value",S.value),_.setValue("name",S.name))},[x]);let Z=async()=>{if(!t)return console.error("Slug is required");let{type:e,value:a}=_.getValues();if((null==e?void 0:e.length)&&!(null==a?void 0:a.length)){_.setError("value",{message:"Value is required"});return}y({slug:t,taxId:(null==e?void 0:e.length)&&(null==a?void 0:a.length)?{type:e,value:aH({value:a,name:_.getValues().name}),country:null==O?void 0:O.countryIso2}:null})},E=()=>{_.setValue("type",S.type),_.setValue("value",S.value),_.setValue("name",S.name)},k=e=>{let a=aq.find(a=>a.name===e);a&&(_.setValue("type",a.type),_.setValue("value",""),_.setValue("name",e))},T=()=>{_.reset()},{name:P}=_.watch(),O=aq.find(e=>e.name===P);return(0,i.jsxs)(l.jX,{children:[(0,i.jsx)(l.g$,{children:(0,i.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,i.jsx)("p",{className:"text-foreground text-base m-0",children:"Tax ID"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light pr-4 m-0",children:"Add a tax ID to your invoices. Changes only apply to future invoices."}),(0,i.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"Make sure the tax ID looks exactly like the placeholder text."})]})}),(0,i.jsx)(l.Lc,{children:(null==s?void 0:s.managed_by)!==void 0&&(null==s?void 0:s.managed_by)!=="supabase"?(0,i.jsx)(v.Z,{partner:null==s?void 0:s.managed_by,resource:"Tax IDs",cta:{installationId:null==s?void 0:s.partner_id}}):I?(0,i.jsxs)(i.Fragment,{children:[d&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(f.Z,{}),(0,i.jsx)(f.Z,{className:"w-3/4"}),(0,i.jsx)(f.Z,{className:"w-1/2"})]}),g&&(0,i.jsx)(p.Z,{error:o,subject:"Failed to retrieve organization tax Id"}),x&&(0,i.jsx)(aM.Z,{className:"mb-8",footer:(0,i.jsx)(h.i,{form:"tax-id-form",isSubmitting:b,hasChanges:C,handleReset:()=>E(),helper:A?void 0:"You need additional permissions to manage this organization's tax ID"}),children:(0,i.jsx)(aB.l0,{..._,children:(0,i.jsxs)("form",{id:"tax-id-form",className:"grid grid-cols-2 gap-2 w-full py-8 px-8 items-center",onSubmit:_.handleSubmit(()=>Z()),children:[(0,i.jsx)(aB.Wi,{name:"name",control:_.control,render:e=>{let{field:a}=e;return(0,i.jsx)(aB.xJ,{children:(0,i.jsx)(aB.NI,{children:(0,i.jsxs)(aV.Ph,{...a,disabled:!A,value:a.value,onValueChange:e=>k(e),children:[(0,i.jsx)(aV.i4,{children:(0,i.jsx)(aV.ki,{placeholder:"None"})}),(0,i.jsx)(aV.Bw,{children:(0,i.jsx)(aV.DI,{children:aq.sort((e,a)=>e.country.localeCompare(a.country)).map(e=>(0,i.jsxs)(aV.Ql,{value:e.name,children:[e.country," - ",e.name]},e.name))})})]})})})}}),O&&(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(aB.Wi,{name:"value",control:_.control,render:e=>{let{field:a}=e;return(0,i.jsx)(aB.xJ,{className:"w-full",children:(0,i.jsx)(aB.NI,{children:(0,i.jsx)(aW.I,{...a,placeholder:null==O?void 0:O.placeholder,disabled:!A})})})}}),(0,i.jsx)(W.z,{type:"text",className:"px-1",icon:(0,i.jsx)(aK.Z,{}),onClick:()=>T()})]})]})})})]}):(0,i.jsx)(j.Z,{resourceText:"view this organization's tax ID"})})]})},aJ=()=>{var e;let{billingAccountData:a,billingPaymentMethods:t,billingCredits:s}=(0,o.N)(["billing:account_data","billing:payment_methods","billing:credits"]),{slug:n}=(0,r.UO)(),{data:c}=(0,d.Gl)({orgSlug:n}),u=!(null==c?void 0:c.billing_via_partner),m=a&&u,p=t&&u;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l._S,{id:"subscription",children:(0,i.jsx)(aO,{})}),(0,i.jsx)(l.I7,{}),(0,i.jsx)(l._S,{id:"cost-control",children:(0,i.jsx)(eE,{})}),(0,i.jsx)(l.I7,{}),(0,i.jsx)(l._S,{id:"breakdown",children:(0,i.jsx)(en,{})}),s&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.I7,{}),(0,i.jsx)(l._S,{id:"credits-balance",children:(0,i.jsx)(eT,{})})]}),p&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.I7,{}),(0,i.jsx)(l._S,{id:"payment-methods",children:(0,i.jsx)(e5,{})})]}),m&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.I7,{}),(0,i.jsx)(l._S,{id:"email",children:(0,i.jsx)(el,{})}),(0,i.jsx)(l.I7,{}),(0,i.jsx)(l._S,{id:"address",children:(0,i.jsx)(O,{})}),(0,i.jsx)(l.I7,{}),(0,i.jsx)(l._S,{id:"taxId",children:(0,i.jsx)(aQ,{})})]})]})},a$=t(46216),a0=t(22150),a2=t(22854),a1=t(28043),a4=t(28414);async function a3(e){let{slug:a}=e,{data:t,error:s}=await (0,b.IV)("/platform/organizations/{slug}",{params:{path:{slug:a}}});return s&&(0,b.S3)(s),t}let a5=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,I.D)(e=>a3(e),{async onSuccess(a,t,n){await Promise.all([s.invalidateQueries(w.O.list()),s.invalidateQueries(a4.F.list())]),await (null==e?void 0:e(a,t,n))},async onError(e,t,s){void 0===a?m.Am.error("Failed to delete organization: ".concat(e.message)):a(e,t,s)},...t})};var a6=()=>{let e=(0,as.useRouter)(),a=(0,z.l)(),{slug:t,name:s}=null!=a?a:{},[n,r]=(0,u.useState)(!1),[l,o]=(0,u.useState)(""),d=(0,N.Xo)(c.KA.UPDATE,"organizations"),{mutate:p,isLoading:h}=a5({onSuccess:()=>{m.Am.success("Successfully deleted ".concat(s)),e.push("/projects")}}),x=async e=>d?t?void p({slug:t}):console.error("Org slug is required"):m.Am.error("You do not have the required permissions to delete this organization");return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"mt-2",children:(0,i.jsx)(W.z,{loading:!t,onClick:()=>r(!0),type:"danger",children:"Delete organization"})}),(0,i.jsx)(eD.Z,{closable:!0,hideFooter:!0,size:"small",visible:n,onCancel:()=>r(!1),header:(0,i.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,i.jsx)("span",{children:"Delete organization"}),(0,i.jsx)("span",{className:"text-xs text-foreground-lighter",children:"Are you sure?"})]}),children:(0,i.jsx)(E.Z,{validateOnBlur:!0,initialValues:{orgName:""},onSubmit:x,validate:e=>{let a={};return e.orgName||(a.orgName="Enter the name of the organization."),e.orgName!==t&&(a.orgName="Value entered does not match the value above."),a},children:()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eD.Z.Content,{children:(0,i.jsxs)("p",{className:"text-sm text-foreground-lighter",children:["This action ",(0,i.jsx)("span",{className:"text-foreground",children:"cannot"})," be undone. This will permanently delete the ",(0,i.jsx)("span",{className:"text-foreground",children:s})," ","organization and remove all of its projects."]})}),(0,i.jsx)(eD.Z.Separator,{}),(0,i.jsx)(eD.Z.Content,{children:(0,i.jsx)(k.Z,{id:"orgName",label:(0,i.jsxs)("span",{children:["Please type ",(0,i.jsx)("span",{className:"font-bold",children:t})," to confirm"]}),onChange:e=>o(e.target.value),value:l,placeholder:"Enter the string above",className:"w-full"})}),(0,i.jsx)(eD.Z.Separator,{}),(0,i.jsx)(eD.Z.Content,{children:(0,i.jsx)(W.z,{block:!0,size:"small",type:"danger",htmlType:"submit",loading:h,disabled:h,children:"I understand, delete this organization"})})]})})})]})},a8=()=>{let e=(0,z.l)();return(0,i.jsx)(aM.Z,{title:(0,i.jsx)("p",{className:"uppercase",children:"Danger Zone"},"panel-title"),children:(0,i.jsx)(aM.Z.Content,{children:(null==e?void 0:e.managed_by)!=="vercel-marketplace"?(0,i.jsxs)(ey.bZ,{variant:"destructive",children:[(0,i.jsx)(e7.ku,{}),(0,i.jsx)(ey.Cd,{children:"Deleting this organization will also remove its projects"}),(0,i.jsx)(ey.X,{children:"Make sure you have made a backup if you want to keep your data"}),(0,i.jsx)(a6,{})]}):(0,i.jsx)(v.Z,{partner:"vercel-marketplace",resource:"Organizations",cta:{installationId:null==e?void 0:e.partner_id,path:"/settings",message:"Delete organization in Vercel Marketplace"}})})})},a7=()=>{let{slug:e}=(0,r.UO)(),a=(0,C.NL)(),t=(0,z.l)(),{name:s}=null!=t?t:{},n="org-general-settings",d=(0,a0.C)(),p=(0,o.N)("organizations:delete"),j=(0,N.Xo)(c.KA.UPDATE,"organizations"),v=(0,N.Xo)(c.KA.UPDATE,"organizations"),{mutate:f,isLoading:y}=(0,ei.k)(),b=async(s,n)=>{var i;let{resetForm:r}=n;if(!j)return m.Am.error("You do not have the required permissions to update this organization");if(!e)return console.error("Slug is required");let l=null!==(i=null==t?void 0:t.opt_in_tags)&&void 0!==i?i:[],o=s.isOptedIntoAi&&!l.includes(ej.PV.AI_SQL)?l.concat([ej.PV.AI_SQL]):!s.isOptedIntoAi&&l.includes(ej.PV.AI_SQL)?l.filter(e=>e!==ej.PV.AI_SQL):l;f({slug:e,name:s.name,opt_in_tags:o},{onSuccess:()=>{r({values:s,initialValues:s}),(0,er.aL)(a),m.Am.success("Successfully saved settings")}})};return(0,i.jsxs)(l.gW,{children:[(0,i.jsx)(a$.Z,{organization:t}),(0,i.jsx)(E.Z,{id:n,initialValues:{name:null!=s?s:"",isOptedIntoAi:d},onSubmit:b,children:e=>{let{handleReset:a,values:r,initialValues:l,resetForm:o}=e,c=JSON.stringify(r)!==JSON.stringify(l);return(0,u.useEffect)(()=>{let e={name:null!=s?s:"",isOptedIntoAi:d};o({values:e,initialValues:e})},[null==t?void 0:t.slug]),(0,i.jsx)(x.by,{footer:(0,i.jsx)("div",{className:"flex py-4 px-8",children:(0,i.jsx)(h.i,{form:n,isSubmitting:y,hasChanges:c,handleReset:a,helper:j?void 0:"You need additional permissions to manage this organization's settings"})}),children:(0,i.jsx)(g.hj,{header:(0,i.jsx)(g.S0,{children:"General settings"}),children:(0,i.jsxs)(g.B4,{loading:!1,children:[(0,i.jsx)(k.Z,{id:"name",size:"small",label:"Organization name",disabled:!j}),(0,i.jsx)(k.Z,{copy:!0,disabled:!0,id:"slug",size:"small",label:"Organization slug",value:null==t?void 0:t.slug}),(0,i.jsxs)("div",{className:"mt-4",children:[(0,i.jsx)(a2.Z,{id:"isOptedIntoAi",name:"isOptedIntoAi",disabled:!j,size:"small",label:"Opt-in to sending anonymous data to OpenAI",descriptionText:"By opting into sending anonymous data, Supabase AI can improve the answers it shows you. This is an organization-wide setting."}),(0,i.jsx)(a1.Z,{className:"ml-16"})]})]})})})}}),p&&v&&(0,i.jsx)(a8,{})]})},a9=t(84247),te=t(80435),ta=t(55579),tt=t(40624),ts=t(16014),tn=t(61660),ti=t(11881),tr=t(26205),tl=t(47342),to=t(36660),td=t(78855);let tc=e=>{let{title:a}=e;return(0,i.jsx)("img",{className:"border rounded-lg shadow w-48 mt-6 border-body",src:"".concat(ej.GW,"/img/integrations/covers/").concat(a,"-cover.png"),alt:"".concat(a," cover")})};var tu=()=>{let e=(0,z.l)(),a=(0,eg.P)("branchManagement"),t=(0,N.Xo)(c.KA.READ,"integrations.github_connections"),s=(0,N.Xo)(c.KA.CREATE,"integrations.github_connections"),n=(0,N.Xo)(c.KA.UPDATE,"integrations.github_connections"),{data:r}=(0,tt.x)(),{data:o}=(0,tn.q)({organizationId:null==e?void 0:e.id}),{mutate:d}=(0,ts.n)({onSuccess:()=>{m.Am.success("Successfully deleted Github connection")}}),p=(0,tr.x5)(),h=(0,u.useCallback)(()=>{p.setGithubConnectionsOpen(!0)},[p]),x=(0,u.useCallback)(async a=>{if(!(null==e?void 0:e.id)){m.Am.error("Organization not found");return}d({connectionId:a.id,organizationId:e.id})},[d,null==e?void 0:e.id]),g=r?"You are authorized with Supabase GitHub App. You can configure your GitHub App installations and repository access [here](".concat(ti.Xw,"). You can revoke your authorization [here](").concat(ti.H4,")."):"";return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(()=>(0,i.jsx)(l._S,{children:(0,i.jsxs)(l.jX,{children:[(0,i.jsxs)(l.g$,{title:"GitHub Connections",children:[(0,i.jsx)(te.U,{content:"\nConnect any of your GitHub repositories to a project.\n"}),(0,i.jsx)(tc,{title:"github"})]}),(0,i.jsx)(l.Lc,{children:t?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(te.U,{content:"\n\n### How will GitHub connections work?\n\nYou will be able to connect a GitHub repository to a Supabase project.\nThe GitHub app will watch for changes in your repository such as file changes, branch changes as well as pull request activity.\n"}),(0,i.jsx)("ul",{className:"flex flex-col gap-y-2",children:null==o?void 0:o.map(e=>{var a,t,s,r,l;return(0,i.jsx)(tl.z,{disabled:!n,connection:{id:String(e.id),added_by:{id:String(null===(a=e.user)||void 0===a?void 0:a.id),primary_email:null!==(r=null===(t=e.user)||void 0===t?void 0:t.primary_email)&&void 0!==r?r:"",username:null!==(l=null===(s=e.user)||void 0===s?void 0:s.username)&&void 0!==l?l:""},foreign_project_id:String(e.repository.id),supabase_project_ref:e.project.ref,organization_integration_id:"unused",inserted_at:e.inserted_at,updated_at:e.updated_at,metadata:{name:e.repository.name}},type:"GitHub",onDeleteConnection:x},e.id)})}),a?(0,i.jsx)(a9.FP,{onClick:h,orgSlug:null==e?void 0:e.slug,showNode:!1,disabled:!s,children:"Add new project connection"}):(0,i.jsxs)("p",{className:"text-sm text-foreground-light",children:["Access to"," ",(0,i.jsx)("a",{href:"https://supabase.com/docs/guides/platform/branching",target:"_blank",rel:"noreferrer",className:"text-foreground",children:"branching"})," ","is required to add GitHub connections."]}),g&&(0,i.jsx)(te.U,{extLinks:!0,content:g,className:"text-foreground-lighter"})]}):(0,i.jsx)(j.Z,{resourceText:"view this organization's GitHub connections"})})]})}),{}),(0,i.jsx)(l.I7,{}),(0,i.jsx)(ta.Z,{isProjectScoped:!1}),(0,i.jsx)(td.Z,{}),(0,i.jsx)(to.Z,{})]})};(s=n||(n={})).DRAFT="draft",s.PAID="paid",s.VOID="void",s.UNCOLLECTIBLE="uncollectible",s.OPEN="open",s.ISSUED="issued";let tm={[n.DRAFT]:{label:"Upcoming",badgeVariant:"warning"},[n.PAID]:{label:"Paid",badgeVariant:"brand"},[n.VOID]:{label:"Forgiven",badgeVariant:"brand"},[n.UNCOLLECTIBLE]:{label:"Outstanding",badgeVariant:"destructive"},[n.OPEN]:{label:"Outstanding",badgeVariant:"destructive"},[n.ISSUED]:{label:"Outstanding",badgeVariant:"destructive"}};var tp=e=>{let{status:a,paymentAttempted:t}=e,s=tm[a];return(0,i.jsxs)(F.fC,{delayDuration:0,children:[(0,i.jsx)(F.xz,{children:(0,i.jsx)(ek.C,{size:"small",className:"capitalize",variant:(null==s?void 0:s.badgeVariant)||"default",children:(null==s?void 0:s.label)||a})}),(0,i.jsx)(F.h_,{children:(0,i.jsxs)(F.VY,{side:"bottom",children:[(0,i.jsx)(F.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsxs)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow w-[300px] space-y-2 border border-background",children:[[n.OPEN,n.ISSUED,n.UNCOLLECTIBLE].includes(a)&&(t?(0,i.jsx)("p",{className:"text-xs text-foreground",children:'We were not able to collect the payment. Make sure you have a valid payment method and enough funds. Outstanding invoices may cause restrictions. You can manually pay the invoice using the "Pay Now" button.'}):(0,i.jsx)("p",{className:"text-xs text-foreground",children:'The invoice will soon be charged for. In case you pay via invoice instead of card, please make sure to make the payment in a timely manner. You can also pay the invoice using your card now using the "Pay Now" button.'})),a===n.DRAFT&&(0,i.jsx)("p",{className:"text-xs text-foreground",children:"The invoice will soon be finalized and charged for."}),a===n.PAID&&(0,i.jsx)("p",{className:"text-xs text-foreground",children:"The invoice has been paid successfully. No action is required on your side."}),a===n.VOID&&(0,i.jsx)("p",{className:"text-xs text-foreground",children:"This invoice has been forgiven. No action is required on your side."})]})]})})]})};async function th(e,a){let{invoiceId:t,slug:s}=e;if(!t)throw Error("Invoice ID is required");if(!s)throw Error("Slug is required");let{data:n,error:i}=await (0,b.U2)("/platform/organizations/{slug}/billing/invoices/{invoiceId}",{params:{path:{invoiceId:t,slug:s}},signal:a});return i&&(0,b.S3)(i),n}async function tx(e,a){let{slug:t}=e;if(!t)throw Error("Slug is required");let s=await (0,b.YM)("/platform/organizations/{slug}/billing/invoices",{params:{path:{slug:t}},signal:a,parseAs:"text"});if(s.error)throw s.error;return Number(s.response.headers.get("X-Total-Count"))}let tg=function(e){let{slug:a}=e,{enabled:t=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,y.a)(Y.Y.count(a),e=>{let{signal:t}=e;return tx({slug:a},t)},{enabled:t&&void 0!==a,...s})};async function tj(e,a){let{slug:t,offset:s=0,limit:n=10}=e;if(!t)throw Error("Org slug is required");let{data:i,error:r}=await (0,b.U2)("/platform/organizations/{slug}/billing/invoices",{params:{path:{slug:t},query:{offset:s.toString(),limit:n.toString()}},signal:a});return r&&(0,b.S3)(r),i}let tv=function(e){let{slug:a,offset:t,limit:s}=e,{enabled:n=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,y.a)(Y.Y.list(a,t),e=>{let{signal:n}=e;return tj({slug:a,offset:t,limit:s},n)},{enabled:n&&void 0!==a,...i})};var tf=()=>{let{slug:e}=(0,r.UO)(),{data:a,isLoading:t,isError:s}=(0,d.Gl)({orgSlug:e}),{data:n,isLoading:l,isError:o}=eX({slug:e}),u=null==n?void 0:n.data.find(e=>e.is_default);return!(0,N.Xo)(c.KA.BILLING_READ,"stripe.payment_methods")||s||o?null:(0,i.jsxs)("div",{className:"flex justify-between items-center gap-4 w-full text-sm rounded-lg p-4 text-foreground bg-alternative border",children:[t||l?(0,i.jsx)(f.Z,{className:"flex-1"}):(null==a?void 0:a.payment_method_type)==="invoice"?(0,i.jsx)("p",{className:"flex-1 text-sm",children:"You get a monthly invoice and payment link via email. To change your payment method, please contact us via our support form."}):u?(0,i.jsx)(e2,{paymentMethod:u,paymentMethodType:null==a?void 0:a.payment_method_type,canUpdatePaymentMethods:!1}):(0,i.jsxs)("div",{className:"flex-1 flex items-center gap-2 opacity-50",children:[(0,i.jsx)(eQ.Z,{size:16,strokeWidth:1.5}),(0,i.jsx)("p",{className:"text-sm",children:"No payment methods"})]}),(0,i.jsx)(W.z,{type:"outline",asChild:!0,children:(null==a?void 0:a.payment_method_type)==="invoice"?(0,i.jsx)(M(),{href:"/support/new?slug=".concat(e,"&ref=no-project&message=").concat(encodeURIComponent("I would like to change my payment method"),"&category=").concat(c.DH.BILLING),children:"Contact support"}):(0,i.jsx)(M(),{href:"/org/".concat(e,"/billing#payment-methods"),children:"Manage payment methods"})})]})},ty=t(53020),tb=t(17913),tN=t(78645),tw=()=>{let[e,a]=(0,u.useState)(1),t=(0,z.l)(),{slug:s}=null!=t?t:{},r=(e-1)*10,o=(0,N.Xo)(c.KA.READ,"invoices"),{data:d,isError:h}=tg({slug:s},{enabled:(null==t?void 0:t.managed_by)==="supabase"}),{data:x,error:g,isLoading:y,isError:b,isSuccess:w}=tv({slug:s,offset:r,limit:10},{enabled:(null==t?void 0:t.managed_by)==="supabase"}),_=x||[];(0,u.useEffect)(()=>{a(1)},[s]);let S=async e=>{try{let a=await th({invoiceId:e,slug:s});(null==a?void 0:a.invoice_pdf)&&window.open(a.invoice_pdf,"_blank")}catch(e){m.Am.error("Failed to fetch the selected invoice: ".concat(e.message))}};return o?(null==t?void 0:t.managed_by)!==void 0&&(null==t?void 0:t.managed_by)!=="supabase"?(0,i.jsx)(l.gW,{children:(0,i.jsx)(v.Z,{partner:null==t?void 0:t.managed_by,resource:"Invoices",cta:{installationId:null==t?void 0:t.partner_id,path:"/invoices"}})}):(0,i.jsxs)(l.gW,{children:[y&&(0,i.jsx)(f.A,{}),b&&(0,i.jsx)(p.Z,{error:g,subject:"Failed to retrieve invoices"}),w&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tf,{}),(0,i.jsx)(eN.Z,{head:[(0,i.jsx)(eN.Z.th,{},"header-icon"),(0,i.jsx)(eN.Z.th,{children:"Date"},"header-date"),(0,i.jsx)(eN.Z.th,{children:"Amount"},"header-amount"),(0,i.jsx)(eN.Z.th,{children:"Invoice number"},"header-invoice"),(0,i.jsx)(eN.Z.th,{className:"flex items-center",children:"Status"},"header-status"),(0,i.jsx)(eN.Z.th,{className:"text-right"},"header-download")],body:0===_.length?(0,i.jsx)(eN.Z.tr,{children:(0,i.jsx)(eN.Z.td,{colSpan:6,className:"p-3 py-12 text-center",children:(0,i.jsx)("p",{className:"text-foreground-light",children:y?"Checking for invoices":"No invoices for this organization yet"})})}):(0,i.jsxs)(i.Fragment,{children:[_.map(e=>(0,i.jsxs)(eN.Z.tr,{children:[(0,i.jsx)(eN.Z.td,{children:(0,i.jsx)(ty.Z,{size:"24"})}),(0,i.jsx)(eN.Z.td,{children:(0,i.jsx)("p",{children:D()(1e3*e.period_end).format("MMM DD, YYYY")})}),(0,i.jsx)(eN.Z.td,{children:(0,i.jsx)("p",{children:(0,V.xG)(e.subtotal/100)})}),(0,i.jsx)(eN.Z.td,{children:(0,i.jsx)("p",{children:e.number})}),(0,i.jsx)(eN.Z.td,{children:(0,i.jsx)(tp,{status:e.status,paymentAttempted:e.payment_attempted})}),(0,i.jsx)(eN.Z.td,{className:"align-right",children:(0,i.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[e.subtotal>0&&[n.UNCOLLECTIBLE,n.OPEN,n.ISSUED].includes(e.status)&&(0,i.jsx)(W.z,{asChild:!0,children:(0,i.jsx)(M(),{href:"https://redirect.revops.supabase.com/pay-invoice/".concat(e.id),target:"_blank",rel:"noreferrer",children:"Pay Now"})}),(0,i.jsx)(W.z,{type:"outline",icon:(0,i.jsx)(tb.Z,{size:16,strokeWidth:1.5}),onClick:()=>S(e.id)})]})})]},e.id)),(0,i.jsx)(eN.Z.tr,{children:(0,i.jsx)(eN.Z.td,{colSpan:6,children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("p",{className:"text-sm opacity-50",children:h?"Failed to retrieve total number of invoices":"Showing ".concat(r+1," to ").concat(r+_.length," out of ").concat(d," invoices")}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(W.z,{icon:(0,i.jsx)(tN.Z,{}),type:"default",size:"tiny",disabled:1===e,onClick:async()=>a(e-1)}),(0,i.jsx)(W.z,{icon:(0,i.jsx)($.Z,{}),type:"default",size:"tiny",disabled:10*e>=(null!=d?d:0),onClick:async()=>a(e+1)})]})]})})},"navigation")]})})]})]}):(0,i.jsx)(l.gW,{children:(0,i.jsx)(j.Z,{resourceText:"view invoices"})})},t_=t(78976),tS=t(24213),tC=t(71863),tI=e=>{let{visible:a,onHide:t}=e;return(0,i.jsxs)(eD.Z,{hideFooter:!0,visible:a,size:"xlarge",header:(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsx)("span",{children:"Spend Cap"}),(0,i.jsx)(W.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{strokeWidth:1.5}),children:(0,i.jsx)("a",{target:"_blank",href:"https://supabase.com/docs/guides/platform/spend-cap",children:"Documentation"})})]}),showCloseButton:!1,onCancel:()=>t(),children:[(0,i.jsx)(eD.Z.Content,{children:(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)("p",{className:"text-sm",children:"Enabling the Spend Cap limits your usage to your plan's quota, which controls costs but can restrict your service. Disabling the spend cap removes these limits, but any extra usage beyond the plan's limit will be charged per usage."}),(0,i.jsx)("p",{className:"text-sm",children:"Launching additional projects or enabling project add-ons will incur additional monthly fees independent of your Spend Cap."}),(0,i.jsxs)(tC.iA,{children:[(0,i.jsx)(tC.xD,{className:"[&_th]:h-7",children:(0,i.jsxs)(tC.SC,{children:[(0,i.jsx)(tC.ss,{className:"w-[50%]",children:"Item"}),(0,i.jsx)(tC.ss,{className:"w-[25%]",children:"Limit"}),(0,i.jsx)(tC.ss,{className:"w-[25%]",children:"Rate"})]})}),(0,i.jsxs)(tC.RM,{className:"[&_td]:py-2",children:[(0,i.jsxs)(tC.SC,{children:[(0,i.jsx)(tC.pj,{children:"Disk Size"}),(0,i.jsx)(tC.pj,{children:"8 GB per project"}),(0,i.jsx)(tC.pj,{children:"$0.125 per GB"})]}),(0,i.jsxs)(tC.SC,{children:[(0,i.jsx)(tC.pj,{children:"Egress"}),(0,i.jsx)(tC.pj,{children:"250 GB"}),(0,i.jsx)(tC.pj,{children:"$0.09 per GB"})]}),(0,i.jsxs)(tC.SC,{children:[(0,i.jsx)(tC.pj,{children:"Auth MAUs"}),(0,i.jsx)(tC.pj,{children:"100,000"}),(0,i.jsx)(tC.pj,{children:"$0.00325 per user"})]}),(0,i.jsxs)(tC.SC,{children:[(0,i.jsx)(tC.pj,{children:"Auth Third-Party MAUs"}),(0,i.jsx)(tC.pj,{children:"50"}),(0,i.jsx)(tC.pj,{children:"$0.00325 per user"})]}),(0,i.jsxs)(tC.SC,{children:[(0,i.jsx)(tC.pj,{children:"Auth Single Sign-On MAUs"}),(0,i.jsx)(tC.pj,{children:"50"}),(0,i.jsx)(tC.pj,{children:"$0.015 per user"})]}),(0,i.jsxs)(tC.SC,{children:[(0,i.jsx)(tC.pj,{children:"Storage Size"}),(0,i.jsx)(tC.pj,{children:"100 GB"}),(0,i.jsx)(tC.pj,{children:"$0.021 per GB"})]}),(0,i.jsxs)(tC.SC,{children:[(0,i.jsx)(tC.pj,{children:"Storage Image Transformations"}),(0,i.jsx)(tC.pj,{children:"100 origin images"}),(0,i.jsx)(tC.pj,{children:"$5 per 1000 images"})]}),(0,i.jsxs)(tC.SC,{children:[(0,i.jsx)(tC.pj,{children:"Realtime Concurrent Peak Connections"}),(0,i.jsx)(tC.pj,{children:"500"}),(0,i.jsx)(tC.pj,{children:"$10 per 1000"})]}),(0,i.jsxs)(tC.SC,{children:[(0,i.jsx)(tC.pj,{children:"Realtime Messages"}),(0,i.jsx)(tC.pj,{children:"5 Million"}),(0,i.jsx)(tC.pj,{children:"$2.50 per Million"})]}),(0,i.jsxs)(tC.SC,{children:[(0,i.jsx)(tC.pj,{children:"Function Invocations"}),(0,i.jsx)(tC.pj,{children:"2 Million"}),(0,i.jsx)(tC.pj,{children:"$2 per Million"})]})]})]})]})}),(0,i.jsx)(eD.Z.Separator,{}),(0,i.jsx)(eD.Z.Content,{children:(0,i.jsx)("div",{className:"flex items-center gap-2",children:(0,i.jsx)(W.z,{block:!0,type:"primary",onClick:()=>t(),children:"Understood"})})})]})},tA=t(78388),tZ=t(74067);let tz={PERSONAL:"Personal",EDUCATIONAL:"Educational",STARTUP:"Startup",AGENCY:"Agency",COMPANY:"Company",UNDISCLOSED:"N/A"},tE={1:"1 - 10",10:"10 - 49",50:"50 - 99",100:"100 - 299",300:"More than 300"};var tk=e=>{let{onPaymentMethodReset:a}=e,t=(0,as.useRouter)(),s=(0,tZ.Un)(),{data:n,isSuccess:l}=(0,er.tl)(),o=(0,eO.useStripe)(),d=(0,eO.useElements)(),c=(0,C.NL)(),{plan:p,name:h,kind:x,size:g,spend_cap:j}=(0,r.UO)(),[v,f]=(0,u.useState)(h||""),[y,b]=(0,u.useState)(x&&Object.keys(tz).includes(x)?x:"PERSONAL"),[N,w]=(0,u.useState)(g||"1"),[_,S]=(0,u.useState)(!1),[I,A]=(0,u.useState)(),[Z,z]=(0,u.useState)(p&&["free","team","pro"].includes(p)?p.toUpperCase():"FREE"),[E,P]=(0,u.useState)(!1),[O,R]=(0,u.useState)(!j||!!j);(0,u.useEffect)(()=>{let e={};e.plan=Z.toLowerCase(),v&&(e.name=v),y&&(e.kind=y),N&&(e.size=N),O&&(e.spend_cap=O.toString()),t.push({query:e})},[Z,v,y,N,O]),(0,u.useEffect)(()=>{if(!v&&(null==n?void 0:n.length)===0&&!s.isLoading){var e;f((null===(e=s.profile)||void 0===e?void 0:e.username)?s.profile.username+"'s Org":"My Org")}},[l]);let{mutate:D}=(0,tA.T)({onSuccess:async e=>{var a;await (0,er.aL)(c);let n=(null===(a=s.profile)||void 0===a?void 0:a.username)?s.profile.username+"'s Project":"My Project";t.push("/new/".concat(e.slug,"?projectName=").concat(n))},onError:()=>{F(),S(!1)}});async function L(e){D({name:v,kind:y,tier:"tier_"+("PRO"!==Z||O?Z:"PAYG").toLowerCase(),..."COMPANY"==y?{size:N}:{},payment_method:e})}let U=async e=>{var a;if(e.preventDefault(),!((v?v.trim():"").length>=1))return m.Am.error("Organization name is empty");if(!o||!d)return console.error("Stripe.js has not loaded");if(S(!0),"FREE"===Z)await L();else if(I)L(I.id);else{let{error:e,setupIntent:t}=await o.confirmSetup({elements:d,redirect:"if_required",confirmParams:{return_url:"".concat((0,V.Ax)(),"/new"),expand:["payment_method"]}});if(e||!t.payment_method){m.Am.error(null!==(a=null==e?void 0:e.message)&&void 0!==a?a:" Failed to save card details"),S(!1);return}let s=t.payment_method;A(s),L(s.id)}},F=()=>(A(void 0),a());return(0,i.jsx)("form",{onSubmit:U,children:(0,i.jsxs)(aM.Z,{title:(0,i.jsx)("div",{children:(0,i.jsx)("h4",{children:"Create a new organization"})},"panel-title"),footer:(0,i.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,i.jsx)(W.z,{type:"default",disabled:_,onClick:()=>t.push("/projects"),children:"Cancel"}),(0,i.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,i.jsx)("p",{className:"text-xs text-foreground-lighter",children:"You can rename your organization later"}),(0,i.jsx)(W.z,{htmlType:"submit",type:"primary",loading:_,disabled:_,children:"Create organization"})]})]},"panel-footer"),children:[(0,i.jsxs)(aM.Z.Content,{children:[(0,i.jsx)("p",{className:"text-sm",children:"This is your organization within Supabase."}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"For example, you can use the name of your company or department."})]}),(0,i.jsx)(aM.Z.Content,{className:"Form section-block--body has-inputs-centered",children:(0,i.jsx)(k.Z,{autoFocus:!0,label:"Name",type:"text",layout:"horizontal",placeholder:"Organization name",descriptionText:"What's the name of your company or team?",value:v,onChange:function(e){f(e.target.value)}})}),(0,i.jsx)(aM.Z.Content,{className:"Form section-block--body has-inputs-centered",children:(0,i.jsx)(T.Z,{label:"Type of organization",layout:"horizontal",value:y,onChange:function(e){b(e)},descriptionText:"What would best describe your organization?",children:Object.entries(tz).map(e=>{let[a,t]=e;return(0,i.jsx)(T.Z.Option,{label:t,value:a,children:t},a)})})}),"COMPANY"==y?(0,i.jsx)(aM.Z.Content,{className:"Form section-block--body has-inputs-centered",children:(0,i.jsx)(T.Z,{label:"Company size",layout:"horizontal",value:N,onChange:function(e){w(e)},descriptionText:"How many people are in your company?",children:Object.entries(tE).map(e=>{let[a,t]=e;return(0,i.jsx)(T.Z.Option,{label:t,value:a,children:t},a)})})}):(0,i.jsx)(i.Fragment,{}),(0,i.jsx)(aM.Z.Content,{children:(0,i.jsx)(T.Z,{label:(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,i.jsx)("span",{children:"Plan"}),(0,i.jsxs)("a",{href:"https://supabase.com/pricing",target:"_blank",rel:"noreferrer noopener",className:"text-sm flex items-center gap-2 opacity-75 hover:opacity-100 transition",children:["Pricing",(0,i.jsx)(eo.Z,{size:16,strokeWidth:1.5})]})]}),layout:"horizontal",value:Z,onChange:function(e){z(e)},descriptionText:"FREE"!==Z?(0,i.jsxs)("p",{children:["The plan applies only to this new organization. To upgrade an existing organization,"," ",(0,i.jsx)(M(),{className:"underline",href:"/org/_/billing?panel=subscriptionPlan",children:"click here"}),"."]}):void 0,children:Object.entries(ej.f6).map(e=>{let[a,t]=e;return(0,i.jsx)(T.Z.Option,{label:t,value:a,children:t},a)})})}),"PRO"===Z&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(aM.Z.Content,{className:"border-b border-panel-border-interior-light dark:border-panel-border-interior-dark",children:(0,i.jsx)(a2.Z,{id:"spend-cap",layout:"horizontal",label:(0,i.jsxs)("div",{className:"flex space-x-4",children:[(0,i.jsx)("span",{children:"Spend Cap"}),(0,i.jsx)(t_.Z,{size:16,strokeWidth:1.5,className:"transition opacity-50 cursor-pointer hover:opacity-100",onClick:()=>P(!0)})]}),checked:O,onChange:()=>R(!O),descriptionText:(0,i.jsx)("div",{children:(0,i.jsx)("p",{children:"With Spend Cap enabled, usage is limited to the plan's quota, with restrictions when limits are exceeded. To scale beyond Pro Plan limits, disable the Spend Cap to pay over-usage."})})})}),(0,i.jsx)(tI,{visible:E,onHide:()=>P(!1)})]}),"FREE"!==Z&&(0,i.jsx)(aM.Z.Content,{children:(null==I?void 0:I.card)!==void 0?(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,i.jsx)("img",{alt:"Card",src:"".concat(ej.GW,"/img/payment-methods/").concat(I.card.brand.replace(" ","-").toLowerCase(),".png"),width:"32"}),(0,i.jsx)(k.Z,{readOnly:!0,className:"w-64",size:"small",value:"   ".concat(I.card.last4)}),(0,i.jsxs)("p",{className:"text-sm tabular-nums",children:["Expires: ",I.card.exp_month,"/",I.card.exp_year]})]}),(0,i.jsx)("div",{children:(0,i.jsx)(W.z,{type:"outline",icon:(0,i.jsx)(tS.Z,{}),onClick:()=>F(),disabled:_,className:"hover:border-muted"})})]},I.id):(0,i.jsx)(eO.PaymentElement,{})})]})})},tT=t(48472),tP=t(58995),tO=e=>{let{title:a,description:t}=e;return(0,i.jsx)("div",{className:"mx-auto flex flex-col gap-10 py-14",children:(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-xl",children:a}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:t})]})})},tR=t(97072),tD=e=>{let{section:a,includedInPlan:t,children:s}=e,{name:n,description:r,links:o}=a;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l._S,{children:(0,i.jsx)("div",{className:"mx-auto flex flex-col gap-10 py-16",children:(0,i.jsxs)("div",{className:"grid grid-cols-12 gap-6",children:[(0,i.jsx)("div",{className:"col-span-12 lg:col-span-5",children:(0,i.jsxs)("div",{className:"sticky top-32 space-y-6",children:[(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("p",{className:"text-base capitalize",children:n}),!1===t&&(0,i.jsx)(ek.C,{children:"Not included"})]}),(0,i.jsx)("div",{className:"grid gap-4",children:r.split("\n").map((e,a)=>(0,i.jsx)("p",{className:"text-sm text-foreground-light pr-8",children:e},"desc-".concat(a)))})]}),o&&o.length>0&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("p",{className:"text-sm text-foreground mb-2",children:"More information"}),o.map(e=>(0,i.jsx)("div",{children:(0,i.jsx)(M(),{href:e.url,target:"_blank",rel:"noreferrer",children:(0,i.jsxs)("div",{className:"flex items-center space-x-2 opacity-50 hover:opacity-100 transition",children:[(0,i.jsx)("p",{className:"text-sm",children:e.name}),(0,i.jsx)(eo.Z,{size:16,strokeWidth:1.5})]})})},e.url))]})]})}),(0,i.jsx)("div",{className:"col-span-12 lg:col-span-7 space-y-6",children:s})]})})}),(0,i.jsx)(l.I7,{})]})};let tL=(e,a)=>{var t;return a?(null==a?void 0:null===(t=a.plan)||void 0===t?void 0:t.id)==="pro"&&(null==a?void 0:a.usage_billing_enabled)===!1?"/org/".concat(e,"/billing#cost-control"):"/org/".concat(e,"/billing?panel=subscriptionPlan"):"/org/".concat(e,"/billing")},tM=new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short"}),tU=(e,a)=>{if("string"==typeof e)return e;if("bytes"===a){let a=tG(e).replace(/\s/g,"");return"0bytes"===a?"0":a}return"gigabytes"===a?tM.format(e)+"GB":tM.format(e)},tF=(e,a)=>{if("string"==typeof e)return e;if("bytes"===a){let a=tB(e).replace(/\s/g,"");return"0bytes"===a?"0":a}return"gigabytes"===a?tM.format(e)+"GB":tM.format(e)},tY=["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],tG=e=>{if(0===e||void 0===e)return"0 bytes";let a=Math.floor(Math.log(e)/Math.log(1024)),t=tY[a],s=2;return["bytes","KB","MB"].includes(t)?s=0:["GB"].includes(t)&&(s=1),parseFloat((e/Math.pow(1024,a)).toFixed(s))+" "+t},tB=e=>{if(0===e||void 0===e)return"0 bytes";let a=Math.floor(Math.log(e)/Math.log(1024)),t=tY[a];return parseFloat((e/Math.pow(1024,a)).toFixed(3))+" "+t};var tV=t(52683),tW=t(67815),tq=t(69767),tH=e=>{var a,t,s,n,r,l,o,d,c,m,h,x,g;let{slug:j,projectRef:v,attribute:y,usage:b,usageMeta:N,chartMeta:w,subscription:_,error:S,isLoading:C,isError:I,isSuccess:A,currentBillingCycleSelected:Z}=e,z=tL(null!=j?j:"",_),E=(null!==(s=null==N?void 0:N.usage)&&void 0!==s?s:0)/(null!==(n=null==N?void 0:N.pricing_free_units)&&void 0!==n?n:0),k=(null!==(r=null==N?void 0:N.usage)&&void 0!==r?r:0)-(null!==(l=null==N?void 0:N.pricing_free_units)&&void 0!==l?l:0),T=null==_?void 0:_.usage_billing_enabled,P=T?"text-amber-900":"text-red-900",O=(0,u.useMemo)(()=>{var e,a;return null!==(a=null===(e=w[y.key])||void 0===e?void 0:e.data)&&void 0!==a?a:[]},[y.key,w]),R=void 0===v&&Z&&!1===T&&E>=ej.wc,D=(0,u.useMemo)(()=>{var e,a;return null!==(a=null===(e=y.attributes)||void 0===e?void 0:e.map(e=>O.some(a=>0!==Number(a[e.key]))).some(e=>!!e))&&void 0!==a&&a},[y.attributes,O]);return(0,i.jsx)("div",{id:y.anchor,className:"scroll-my-12",children:(0,i.jsxs)(tD,{section:y,children:[C&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(f.Z,{}),(0,i.jsx)(f.Z,{className:"w-3/4"}),(0,i.jsx)(f.Z,{className:"w-1/2"})]}),I&&(0,i.jsx)(p.Z,{subject:"Failed to retrieve usage data",error:S}),A&&(0,i.jsx)(i.Fragment,{children:!N||(null==N?void 0:N.available_in_plan)?(0,i.jsxs)(i.Fragment,{children:[!v&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)("div",{className:"flex items-center justify-between",children:(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsxs)("p",{className:"text-sm",children:[y.name," usage"]}),R&&(0,i.jsxs)(F.fC,{delayDuration:0,children:[(0,i.jsx)(F.xz,{asChild:!0,children:E>=1?(0,i.jsxs)("div",{className:"flex items-center space-x-2 min-w-[115px] cursor-help",children:[(0,i.jsx)(tW.Z,{size:14,strokeWidth:2,className:P}),(0,i.jsx)("p",{className:"text-sm ".concat(P),children:"Exceeded limit"})]}):E>=ej.wc&&(0,i.jsxs)("div",{className:"flex items-center space-x-2 min-w-[115px] cursor-help",children:[(0,i.jsx)(tW.Z,{size:14,strokeWidth:2,className:"text-amber-900"}),(0,i.jsx)("p",{className:"text-sm text-amber-900",children:"Approaching limit"})]})}),(0,i.jsx)(F.h_,{children:(0,i.jsxs)(F.VY,{side:"bottom",children:[(0,i.jsx)(F.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsxs)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:[(0,i.jsx)("p",{className:"text-xs text-foreground",children:"Exceeding your plans included usage will lead to restrictions to your project."}),(0,i.jsx)("p",{className:"text-xs text-foreground",children:"Upgrade to a usage-based plan or disable the spend cap to avoid restrictions."})]})]})})]})]})}),Z&&N&&!N.unlimited&&(0,i.jsx)(e6.Z,{type:"horizontal",barClass:(0,U.default)(E>=1?T?"bg-foreground-light":"bg-red-900":!1===T&&E>=ej.wc?"bg-amber-900":"bg-foreground-light"),bgClass:"bg-surface-300",value:null!==(o=null==N?void 0:N.usage)&&void 0!==o?o:0,max:(null==N?void 0:N.pricing_free_units)||1}),(0,i.jsxs)("div",{children:[N&&(0,i.jsxs)("div",{className:"flex items-center justify-between border-b py-1",children:[(0,i.jsxs)("p",{className:"text-xs text-foreground-light",children:["Included in ",null==_?void 0:null===(a=_.plan)||void 0===a?void 0:a.name.toLowerCase()," plan"]}),N.unlimited?(0,i.jsx)("p",{className:"text-xs",children:"Unlimited"}):(0,i.jsx)("p",{className:"text-xs",children:"bytes"===y.unit||"gigabytes"===y.unit?"".concat(null!==(d=N.pricing_free_units)&&void 0!==d?d:0," GB"):(null!==(c=N.pricing_free_units)&&void 0!==c?c:0).toLocaleString()})]}),Z&&N&&(0,i.jsxs)("div",{className:"flex items-center justify-between py-1",children:[(0,i.jsxs)("p",{className:"text-xs text-foreground-light",children:[y.chartPrefix||"Used "," in period"]}),(0,i.jsx)("p",{className:"text-xs",children:"bytes"===y.unit||"gigabytes"===y.unit?"".concat((null!==(m=null==N?void 0:N.usage)&&void 0!==m?m:0).toFixed(2)," GB"):(null!==(h=null==N?void 0:N.usage)&&void 0!==h?h:0).toLocaleString()})]}),Z&&(null!==(x=null==N?void 0:N.pricing_free_units)&&void 0!==x?x:0)>0&&(0,i.jsxs)("div",{className:"flex items-center justify-between border-t py-1",children:[(0,i.jsx)("p",{className:"text-xs text-foreground-light",children:"Overage in period"}),(0,i.jsx)("p",{className:"text-xs",children:(null!==(g=null==N?void 0:N.pricing_free_units)&&void 0!==g?g:0)===-1||k<0?"0".concat("bytes"===y.unit||"gigabytes"===y.unit?" GB":""):"bytes"===y.unit||"gigabytes"===y.unit?"".concat(k.toFixed(2)," GB"):k.toLocaleString()})]})]})]}),null===(t=y.additionalInfo)||void 0===t?void 0:t.call(y,b),(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsxs)("p",{className:"text-sm",children:[y.chartPrefix||""," ",y.name," ",y.chartSuffix||"per day"]}),y.chartDescription.split("\n").map((e,a)=>(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:e},"para-".concat(a)))]}),w[y.key].isLoading?(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(f.Z,{}),(0,i.jsx)(f.Z,{className:"w-3/4"}),(0,i.jsx)(f.Z,{className:"w-1/2"})]}):O.length>0&&D?(0,i.jsx)(tV.Z,{name:"".concat(y.chartPrefix||"").concat(y.name),unit:y.unit,attributes:y.attributes,data:O,yLeftMargin:w[y.key].margin,yFormatter:e=>tU(e,y.unit),tooltipFormatter:e=>tF(e,y.unit)}):(0,i.jsx)(aM.Z,{children:(0,i.jsx)(aM.Z.Content,{children:(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,i.jsx)(tq.Z,{className:"text-foreground-light mb-2"}),(0,i.jsx)("p",{className:"text-sm",children:"No data in period"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"May take up to 24 hours to show"})]})})})]}):(0,i.jsx)(aM.Z,{children:(0,i.jsx)(aM.Z.Content,{children:(0,i.jsxs)("div",{className:"flex w-full items-center flex-col justify-center space-y-2 md:flex-row md:justify-between",children:[(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("p",{className:"text-sm",children:"Not included in plan"}),(0,i.jsx)("div",{children:(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"You need to be on a higher plan in order to use this feature."})})]}),(0,i.jsx)(W.z,{type:"primary",asChild:!0,children:(0,i.jsx)(M(),{href:z,children:"Upgrade plan"})})]})})})})]})})},tX=e=>{let{orgSlug:a,projectRef:t,categoryKey:s,chartMeta:n,subscription:r,currentBillingCycleSelected:o}=e,{data:d,error:c,isLoading:u,isError:m,isSuccess:p}=(0,e8.v)({orgSlug:a}),h=(0,tR.ty)(r).find(e=>e.key===s);return h?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l._S,{children:(0,i.jsx)(tO,{title:h.name,description:h.description})}),(0,i.jsx)(l.I7,{}),h.attributes.map(e=>(0,i.jsx)(tH,{slug:a,projectRef:t,attribute:e,usage:d,usageMeta:null==d?void 0:d.usages.find(a=>a.metric===e.key),chartMeta:n,subscription:r,error:c,isLoading:u,isError:m,isSuccess:p,currentBillingCycleSelected:o},e.name))]}):null},tK=e=>{var a,t,s,n,r,l;let{orgSlug:o,projectRef:d,subscription:c,startDate:u,endDate:m,currentBillingCycleSelected:p}=e,{data:h,isLoading:x}=(0,H.L6)({orgSlug:o,projectRef:d,metric:H.tk.MONTHLY_ACTIVE_USERS,interval:"1d",startDate:u,endDate:m}),{data:g,isLoading:j}=(0,H.L6)({orgSlug:o,projectRef:d,metric:H.tk.MONTHLY_ACTIVE_SSO_USERS,interval:"1d",startDate:u,endDate:m}),{data:v,isLoading:f}=(0,H.L6)({orgSlug:o,projectRef:d,metric:H.tk.STORAGE_IMAGES_TRANSFORMED,interval:"1d",startDate:u,endDate:m}),{data:y,isLoading:b}=(0,H.L6)({orgSlug:o,projectRef:d,metric:H.tk.FUNCTION_INVOCATIONS,interval:"1d",startDate:u,endDate:m}),{data:N,isLoading:w}=(0,H.L6)({orgSlug:o,projectRef:d,metric:H.tk.REALTIME_MESSAGE_COUNT,interval:"1d",startDate:u,endDate:m}),{data:_,isLoading:S}=(0,H.L6)({orgSlug:o,projectRef:d,metric:H.tk.REALTIME_PEAK_CONNECTIONS,interval:"1d",startDate:u,endDate:m}),C={[H.tk.MONTHLY_ACTIVE_USERS]:{data:null!==(a=null==h?void 0:h.data)&&void 0!==a?a:[],margin:18,isLoading:x},[H.tk.MONTHLY_ACTIVE_SSO_USERS]:{data:null!==(t=null==g?void 0:g.data)&&void 0!==t?t:[],margin:20,isLoading:j},[H.tk.STORAGE_IMAGES_TRANSFORMED]:{data:null!==(s=null==v?void 0:v.data)&&void 0!==s?s:[],margin:0,isLoading:f},[H.tk.FUNCTION_INVOCATIONS]:{data:null!==(n=null==y?void 0:y.data)&&void 0!==n?n:[],margin:26,isLoading:b},[H.tk.REALTIME_MESSAGE_COUNT]:{data:null!==(r=null==N?void 0:N.data)&&void 0!==r?r:[],margin:38,isLoading:w},[H.tk.REALTIME_PEAK_CONNECTIONS]:{data:null!==(l=null==_?void 0:_.data)&&void 0!==l?l:[],margin:0,isLoading:S}};return(0,i.jsx)(tX,{orgSlug:o,projectRef:d,categoryKey:"activity",chartMeta:C,subscription:c,currentBillingCycleSelected:p})},tQ=e=>{var a;let{orgSlug:t,projectRef:s,subscription:n,startDate:r,endDate:l,currentBillingCycleSelected:o}=e,{data:d,isLoading:c}=(0,H.L6)({orgSlug:t,projectRef:s,metric:H.tk.EGRESS,interval:"1d",startDate:r,endDate:l}),u={[H.tk.EGRESS]:{data:null!==(a=null==d?void 0:d.data)&&void 0!==a?a:[],margin:16,isLoading:c}};return(0,i.jsx)(tX,{orgSlug:t,projectRef:s,categoryKey:"bandwidth",chartMeta:u,subscription:n,currentBillingCycleSelected:o})},tJ=t(64883);async function t$(e,a){let{orgSlug:t,startDate:s,endDate:n,projectRef:i}=e;if(!t)throw Error("Org slug is required");if(!s)throw Error("Start date is required");if(!n)throw Error("End date is required");"/platform/organizations/{slug}/daily-stats/compute?&startDate=".concat(encodeURIComponent(s),"&endDate=").concat(encodeURIComponent(n));let{data:r,error:l}=await (0,b.U2)("/platform/organizations/{slug}/daily-stats/compute",{params:{path:{slug:t},query:{projectRef:i,startDate:s,endDate:n}},signal:a});return l&&(0,b.S3)(l),r}let t0=function(e){let{orgSlug:a,startDate:t,endDate:s,projectRef:n,dateFormat:i="DD MMM"}=e,{enabled:r=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,y.a)(tJ.d.orgDailyComputeStats(a,{startDate:t,endDate:s,projectRef:n}),e=>{let{signal:i}=e;return t$({orgSlug:a,startDate:t,endDate:s,projectRef:n},i)},{enabled:r&&void 0!==a&&void 0!==t&&void 0!==s,select:e=>({...e,data:e.data.map(e=>({...e,periodStartFormatted:D()(e.period_start).format(i)}))}),staleTime:36e5,...l})};var t2=e=>{var a;let{orgSlug:t,projectRef:s,startDate:n,endDate:r}=e,l=Object.values(H.Hz).map(e=>e.toLowerCase()),{data:o,isLoading:d,error:c,isSuccess:m}=t0({orgSlug:t,projectRef:s,startDate:n,endDate:r}),h=null!==(a=null==o?void 0:o.data)&&void 0!==a?a:[],x={[H.Hz.COMPUTE_HOURS_BRANCH]:"blue",[H.Hz.COMPUTE_HOURS_XS]:"white",[H.Hz.COMPUTE_HOURS_SM]:"green",[H.Hz.COMPUTE_HOURS_MD]:"dark-green",[H.Hz.COMPUTE_HOURS_L]:"yellow",[H.Hz.COMPUTE_HOURS_XL]:"dark-yellow",[H.Hz.COMPUTE_HOURS_2XL]:"orange",[H.Hz.COMPUTE_HOURS_4XL]:"dark-orange",[H.Hz.COMPUTE_HOURS_8XL]:"red",[H.Hz.COMPUTE_HOURS_12XL]:"dark-red",[H.Hz.COMPUTE_HOURS_16XL]:"purple"},g=Object.keys(H.Hz).map(e=>({key:e.toLowerCase(),color:x[e]||"white",name:(0,H.p5)(e)})),j=(0,u.useMemo)(()=>l.filter(e=>h.some(a=>a[e])),[h]),v=(0,u.useMemo)(()=>j.length>0,[j]);return(0,i.jsx)("div",{id:"compute",className:"scroll-my-12",children:(0,i.jsxs)(tD,{section:{name:"Compute Hours",description:"Amount of hours your projects were active. Each project is a dedicated server and database.\nPaid plans come with $10 in Compute Credits to cover one project running on Micro Compute or parts of any compute add-on.\nBilling is based on the sum of Compute Hours used. Paused projects do not count towards usage.",links:[{name:"Compute Add-ons",url:"https://supabase.com/docs/guides/platform/compute-add-ons"},{name:"Usage-billing for Compute",url:"https://supabase.com/docs/guides/platform/org-based-billing#billing-for-compute-compute-hours"}]},children:[d&&(0,i.jsx)(f.A,{}),null!=c&&(0,i.jsx)(p.Z,{subject:"Failed to retrieve usage data",error:c}),m&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"space-y-1",children:[h.length>0&&(0,i.jsx)("div",{className:"flex items-center justify-between",children:(0,i.jsx)("div",{className:"flex items-center space-x-4",children:(0,i.jsx)("p",{className:"text-sm",children:"Compute Hours usage"})})}),j.map(e=>(0,i.jsxs)("div",{className:"flex items-center justify-between border-b last:border-b-0 py-1 last:py-0",children:[(0,i.jsxs)("p",{className:"text-sm text-foreground-light",children:[(0,i.jsx)("span",{className:"font-medium",children:(0,H.p5)(e.toUpperCase())})," ","Compute Hours usage in period"]}),(0,i.jsxs)("p",{className:"text-sm",children:[h.reduce((a,t)=>{var s;return a+(null!==(s=t[e])&&void 0!==s?s:0)},0)," hours"]})]},e))]}),(0,i.jsxs)("div",{className:"space-y-1",children:[(0,i.jsx)("p",{className:"text-sm",children:"Compute Hours usage per day"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"The data refreshes every hour."})]}),d?(0,i.jsx)(f.A,{}):h.length>0&&v?(0,i.jsx)(tV.Z,{name:"Compute Hours usage",unit:"hours",attributes:g,data:h,yMin:24}):(0,i.jsx)(aM.Z,{children:(0,i.jsx)(aM.Z.Content,{children:(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,i.jsx)(tq.Z,{className:"text-foreground-light mb-2"}),(0,i.jsx)("p",{className:"text-sm",children:"No data in period"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"May take up to one hour to show"})]})})})]})]})})},t1=e=>{var a,t;let{orgSlug:s,projectRef:n,startDate:r,endDate:l,subscription:o,currentBillingCycleSelected:d}=e,{data:c,isLoading:u}=(0,H.L6)({orgSlug:s,projectRef:n,metric:H.tk.DATABASE_SIZE,interval:"1d",startDate:r,endDate:l}),{data:m,isLoading:p}=(0,H.L6)({orgSlug:s,projectRef:n,metric:H.tk.STORAGE_SIZE,interval:"1d",startDate:r,endDate:l}),h={[H.tk.DATABASE_SIZE]:{isLoading:u,margin:14,data:null!==(a=null==c?void 0:c.data)&&void 0!==a?a:[]},[H.tk.STORAGE_SIZE]:{isLoading:p,margin:14,data:null!==(t=null==m?void 0:m.data)&&void 0!==t?t:[]}};return(0,i.jsx)(tX,{orgSlug:s,projectRef:n,categoryKey:"sizeCount",chartMeta:h,subscription:o,currentBillingCycleSelected:d})};let t4=[{key:H.tk.DATABASE_SIZE,name:"Database Size",units:"bytes",anchor:"dbSize",category:"Database",unitName:"GB"},{key:H.tk.EGRESS,name:"Egress",units:"bytes",anchor:"egress",category:"Database",unitName:"GB"},{key:H.tk.MONTHLY_ACTIVE_USERS,name:"Monthly Active Users",units:"absolute",anchor:"mau",category:"Authentication",unitName:"MAU"},{key:H.tk.MONTHLY_ACTIVE_SSO_USERS,name:"Monthly Active SSO Users",units:"absolute",anchor:"mauSso",category:"Authentication",unitName:"MAU"},{key:H.tk.MONTHLY_ACTIVE_THIRD_PARTY_USERS,name:"Monthly Active Third-Party Users",units:"absolute",category:"Authentication",unitName:"MAU"},{key:H.tk.STORAGE_SIZE,name:"Storage Size",units:"bytes",anchor:"storageSize",category:"Storage",unitName:"GB"},{key:H.tk.STORAGE_IMAGES_TRANSFORMED,name:"Storage Image Transformations",units:"absolute",anchor:"storageImageTransformations",category:"Storage"},{key:H.tk.REALTIME_PEAK_CONNECTIONS,name:"Realtime Peak Connections",units:"absolute",anchor:"realtimePeakConnections",category:"Realtime"},{key:H.tk.REALTIME_MESSAGE_COUNT,name:"Realtime Messages",units:"absolute",anchor:"realtimeMessageCount",category:"Realtime"},{key:H.tk.FUNCTION_INVOCATIONS,name:"Edge Function Invocations",units:"absolute",anchor:"funcInvocations",category:"Edge Functions"},{key:H.tk.DISK_SIZE_GB_HOURS_GP3,name:"Disk Size",units:"absolute",unitName:"GB-Hrs",category:"Database",tip:"Each project gets provisioned with 8 GB of disk. When you get close to the disk size limit, we autoscale your disk by 1.5x. The first 8 GB of disk is free for every single project."},{key:H.tk.DISK_SIZE_GB_HOURS_IO2,name:"Disk Size IO2",units:"absolute",unitName:"GB-Hrs",category:"Database"},{key:H.tk.DISK_IOPS_IO2,name:"Disk IOPS IO2",units:"absolute",unitName:"IOPS-Hrs",category:"Database"},{key:H.tk.DISK_IOPS_GP3,name:"Disk IOPS GP3",units:"absolute",unitName:"IOPS-Hrs",category:"Database"},{key:H.tk.DISK_THROUGHPUT_GP3,name:"Disk Throughput",units:"absolute",unitName:"IOPS-Hrs",category:"Database"},{key:H.tk.LOG_DRAIN_EVENTS,name:"Log Drain Events",units:"absolute",category:"Database"}];var t3=t(11304),t5=e=>{var a;let{slug:t,metric:s,usage:n,subscription:r,relativeToSubscription:l}=e,o=n.usages.find(e=>e.metric===s.key),d=(0,u.useMemo)(()=>{var e,a,t,n;return o?l&&!1===o.available_in_plan?"Unavailable in plan":o.cost&&o.cost>0||!l||o.unlimited||0===o.pricing_free_units?"bytes"===s.units||"gigabytes"===s.units?"".concat(null!==(e=o.usage.toLocaleString())&&void 0!==e?e:0," GB"):o.usage.toLocaleString()+(s.unitName?" ".concat(s.unitName):""):"bytes"===s.units||"gigabytes"===s.units?"".concat(null!==(t=o.usage.toLocaleString())&&void 0!==t?t:0," / ").concat(null!==(n=o.pricing_free_units)&&void 0!==n?n:0," GB"):"".concat(o.usage.toLocaleString()," / ").concat(null===(a=o.pricing_free_units)||void 0===a?void 0:a.toLocaleString())+(s.unitName?" ".concat(s.unitName):""):""},[o,l,s]),c=(0,u.useMemo)(()=>o&&o.project_allocations?o.project_allocations.sort((e,a)=>a.usage-e.usage):[],[o]);if(!o)return null;let m=0===o.usage?0:o.usage/(null!==(a=o.pricing_free_units)&&void 0!==a?a:0),p=(null==r?void 0:r.usage_billing_enabled)===!0,h=!1==!!o.unlimited,x=h&&m>=.8,g=l&&h&&m>=1,j=Q(o.metric),v=0===o.usage||0===o.pricing_free_units?"":m<.01?"(<1%)":"(".concat((+(100*m).toFixed(0)).toLocaleString(),"%)");return(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[s.anchor?(0,i.jsx)(M(),{href:"/org/".concat(t,"/usage#").concat(s.anchor),children:(0,i.jsxs)("div",{className:"group flex items-center space-x-2",children:[(0,i.jsx)("p",{className:"text-sm text-foreground-light group-hover:text-foreground transition cursor-pointer",children:s.name}),(0,i.jsx)($.Z,{strokeWidth:1.5,size:16,className:"transition"})]})}):(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:s.name}),(0,i.jsx)("span",{className:"text-sm",children:d}),"\xa0",l&&o.cost&&o.cost>0?(0,i.jsxs)("span",{className:"text-sm",children:["(",(0,V.xG)(o.cost),")"]}):o.available_in_plan&&!o.unlimited&&l?(0,i.jsx)("span",{className:"text-sm",children:v}):null]}),o.available_in_plan?(0,i.jsx)("div",{children:(0,i.jsxs)(F.fC,{delayDuration:0,children:[(0,i.jsx)(F.xz,{children:l&&!o.unlimited?(0,i.jsxs)("svg",{className:"h-8 w-8 -rotate-90 transform",children:[(0,i.jsx)("circle",{cx:15,cy:15,r:12,fill:"transparent",stroke:"currentColor",strokeWidth:4,className:"text-background-surface-300"}),(0,i.jsx)("circle",{cx:15,cy:15,r:12,fill:"transparent",stroke:"currentColor",strokeDasharray:75.398,strokeDashoffset:"calc(75.39822 - ".concat(m<1?100*m:100," / 100 * 75.39822)"),strokeWidth:4,className:p?"text-gray-dark-800":g?"text-red-900":x?"text-yellow-1000":"text-gray-dark-800"})]}):(0,i.jsx)(t3.Z,{className:"h-8 w-8 p-1"})}),(0,i.jsx)(F.h_,{children:(0,i.jsxs)(F.VY,{side:"bottom",children:[(0,i.jsx)(F.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background min-w-[300px] max-w-[450px] max-h-[300px] overflow-y-auto",children:(0,i.jsxs)("div",{className:"text-xs text-foreground space-y-2",children:[(0,i.jsx)("p",{className:"font-medium",children:o.unit_price_desc}),s.tip&&(0,i.jsx)("div",{className:"my-2",children:(0,i.jsx)("p",{className:"text-xs",children:s.tip})}),!1===r.usage_billing_enabled&&l&&(x||g)&&(0,i.jsx)("div",{className:"mt-2",children:(0,i.jsx)("p",{className:"text-xs",children:"Exceeding your plans included usage will lead to restrictions to your project. Upgrade to a usage-based plan or disable the spend cap to avoid restrictions."})}),c&&c.length>0&&(0,i.jsxs)("table",{className:"list-disc w-full",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"text-left",children:"Project"}),(0,i.jsx)("th",{className:"text-right",children:"Usage"})]})}),(0,i.jsxs)("tbody",{children:[c.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:e.name}),(0,i.jsx)("td",{className:"text-right",children:K(o.metric,e)})]},"".concat(o.metric,"_").concat(e.ref))),(0,i.jsx)("tr",{})]}),(0,i.jsx)("tfoot",{children:(0,i.jsxs)("tr",{children:[(0,i.jsxs)("td",{className:"py-2 border-t text-left",children:["Total",j&&(0,i.jsxs)("span",{children:[" (",j,")"]})]}),(0,i.jsxs)("td",{className:"py-2 border-t text-right",children:[K(o.metric,{usage:o.usage_original})," "]})]})})]})]})})]})})]})}):(0,i.jsx)("div",{children:(0,i.jsx)(W.z,{type:"default",asChild:!0,children:(0,i.jsx)(M(),{href:"/org/".concat(t,"/billing?panel=subscriptionPlan"),children:"Upgrade"})})})]})},t6=e=>{let{slug:a,metric:t,usage:s,relativeToSubscription:n}=e,r=s.usages.find(e=>e.metric===t.key),l=(0,u.useMemo)(()=>{var e,a,t,s,n;return(null==r?void 0:r.pricing_free_units)?"".concat(null!==(a=null==r?void 0:null===(e=r.usage)||void 0===e?void 0:e.toLocaleString())&&void 0!==a?a:0," / ").concat(null!==(t=null==r?void 0:r.pricing_free_units)&&void 0!==t?t:0," hours"):"".concat(null!==(n=null==r?void 0:null===(s=r.usage)||void 0===s?void 0:s.toLocaleString())&&void 0!==n?n:0," hours")},[r]),o=(0,u.useMemo)(()=>r&&r.project_allocations?r.project_allocations.sort((e,a)=>a.usage-e.usage):[],[r]);return(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)(M(),{href:"/org/".concat(a,"/usage#").concat(t.anchor),children:(0,i.jsxs)("div",{className:"group flex items-center space-x-2",children:[(0,i.jsx)("p",{className:"text-sm text-foreground-light group-hover:text-foreground transition cursor-pointer",children:t.name}),(0,i.jsx)($.Z,{strokeWidth:1.5,size:16,className:"transition"})]})}),(0,i.jsx)("span",{className:"text-sm",children:l}),"\xa0",n&&(null==r?void 0:r.cost)&&r.cost>0?(0,i.jsxs)("span",{className:"text-sm",children:["(",(0,V.xG)(null==r?void 0:r.cost),")"]}):null]}),(0,i.jsx)("div",{children:(0,i.jsxs)(F.fC,{delayDuration:0,children:[(0,i.jsx)(F.xz,{children:(0,i.jsx)(t3.Z,{className:"h-8 w-8 p-1"})}),(0,i.jsx)(F.h_,{children:(0,i.jsxs)(F.VY,{side:"bottom",children:[(0,i.jsx)(F.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background min-w-[300px] max-w-[450px] max-h-[300px] overflow-y-auto",children:(0,i.jsxs)("div",{className:"text-xs text-foreground space-y-2",children:[(0,i.jsx)("p",{className:"font-medium",children:null==r?void 0:r.unit_price_desc}),(0,i.jsx)("div",{className:"my-2",children:(0,i.jsxs)("p",{className:"text-xs",children:["Every project is a dedicated server and database. For every hour your project is active, it incurs compute costs based on the compute size of your project. Paused projects do not incur compute costs."," ",(0,i.jsx)(M(),{href:"https://supabase.com/docs/guides/platform/org-based-billing#billing-for-compute-compute-hours",target:"_blank",className:"transition text-brand hover:text-brand-600 underline",children:"Read more"})]})}),r&&o.length>0&&(0,i.jsxs)("table",{className:"list-disc w-full",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"text-left",children:"Project"}),(0,i.jsx)("th",{className:"text-right",children:"Usage"})]})}),(0,i.jsxs)("tbody",{children:[o.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:e.name}),(0,i.jsx)("td",{className:"text-right",children:K(r.metric,e)})]},"".concat(r.metric,"_").concat(e.ref))),(0,i.jsx)("tr",{})]}),(0,i.jsx)("tfoot",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{className:"py-2 border-t text-left",children:"Total (Hours)"}),(0,i.jsx)("td",{className:"py-2 border-t text-right",children:K(r.metric,{usage:r.usage_original})})]})})]})]})})]})})]})})]})};let t8=[H.tk.DISK_IOPS_IO2,H.tk.DISK_IOPS_GP3,H.tk.DISK_SIZE_GB_HOURS_GP3,H.tk.DISK_SIZE_GB_HOURS_IO2,H.tk.DISK_THROUGHPUT_GP3];var t7=e=>{var a,t;let{orgSlug:s,projectRef:n,subscription:r,startDate:l,endDate:o,currentBillingCycleSelected:d}=e,c=null==r?void 0:r.usage_billing_enabled,{data:m,error:h,isLoading:x,isError:g,isSuccess:j}=(0,e8.v)({orgSlug:s,projectRef:n,start:!d&&l?new Date(l):void 0,end:!d&&o?new Date(o):void 0}),v=d&&!n,y=v&&!!(null==m?void 0:m.usages.find(e=>{var a;return!e.metric.startsWith("COMPUTE_")&&!e.unlimited&&e.usage>(null!==(a=null==e?void 0:e.pricing_free_units)&&void 0!==a?a:0)})),b=(0,u.useMemo)(()=>m?t4.filter(e=>m.usages.some(a=>a.metric===e.key)).filter(e=>{if(!t8.includes(e.key))return!0;let a=m.usages.find(a=>a.metric===e.key);return a&&a.usage>0}).slice().sort((e,a)=>{var t,s,n,i;let r=m.usages.find(a=>a.metric===e.key),l="number"!=typeof r?(null!==(t=null==r?void 0:r.usage)&&void 0!==t?t:0)/(null!==(s=null==r?void 0:r.pricing_free_units)&&void 0!==s?s:0):0,o=m.usages.find(e=>e.metric===a.key),d="number"!=typeof o?(null!==(n=null==o?void 0:o.usage)&&void 0!==n?n:0)/(null!==(i=null==o?void 0:o.pricing_free_units)&&void 0!==i?i:0):0;return Number(null==o?void 0:o.available_in_plan)-Number(null==r?void 0:r.available_in_plan)||d-l}):[],[m]),N=((null==m?void 0:m.usages)||[]).filter(e=>e.metric.startsWith("COMPUTE")).map(e=>e.metric);return(0,i.jsx)("div",{id:"summary",children:(0,i.jsxs)(tD,{section:{name:"Usage Summary",description:c?"Your plan includes a limited amount of usage. If exceeded, you will be charged for the overages. It may take up to ".concat((null==r?void 0:r.usage_based_billing_project_addons)?"1 hour":"24 hours"," for usage stats to update."):"Your plan includes a limited amount of usage. If exceeded, you may experience restrictions, as you are currently not billed for overages. It may take up to ".concat((null==r?void 0:r.usage_based_billing_project_addons)?"1 hour":"24 hours"," for usage stats to update."),links:[{name:"How billing works",url:"https://supabase.com/docs/guides/platform/org-based-billing"},{name:"Supabase Plans",url:"https://supabase.com/pricing"}]},children:[x&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(f.Z,{}),(0,i.jsx)(f.Z,{className:"w-3/4"}),(0,i.jsx)(f.Z,{className:"w-1/2"})]}),g&&(0,i.jsx)(p.Z,{subject:"Failed to retrieve usage data",error:h}),j&&r&&(0,i.jsxs)("div",{children:[v&&(0,i.jsx)("p",{className:"text-sm",children:y?y&&(null==r?void 0:null===(a=r.plan)||void 0===a?void 0:a.id)==="free"?(0,i.jsxs)("span",{children:["You have exceeded your"," ",(0,i.jsx)("span",{className:"font-medium",children:null==r?void 0:r.plan.name})," Plan quota in this billing cycle. Upgrade your plan to continue using Supabase without restrictions."]}):y&&(null==r?void 0:r.usage_billing_enabled)===!1&&(null==r?void 0:null===(t=r.plan)||void 0===t?void 0:t.id)==="pro"?(0,i.jsxs)("span",{children:["You have exceeded your"," ",(0,i.jsx)("span",{className:"font-medium",children:null==r?void 0:r.plan.name})," Plan quota in this billing cycle. Disable your spend cap to continue using Supabase without restrictions."]}):y&&(null==r?void 0:r.usage_billing_enabled)===!0?(0,i.jsxs)("span",{children:["You have exceeded your"," ",(0,i.jsx)("span",{className:"font-medium",children:null==r?void 0:r.plan.name})," Plan quota in this billing cycle and will be charged for over-usage."]}):(0,i.jsxs)("span",{children:["You have not exceeded your"," ",(0,i.jsx)("span",{className:"font-medium",children:null==r?void 0:r.plan.name})," Plan quota in this billing cycle."]}):(0,i.jsxs)("span",{children:["You have not exceeded your"," ",(0,i.jsx)("span",{className:"font-medium",children:null==r?void 0:r.plan.name})," Plan quota in this billing cycle."]})}),(0,i.jsxs)("div",{className:"grid grid-cols-12 mt-3",children:[b.map((e,a)=>(0,i.jsx)("div",{className:(0,U.default)("col-span-12 md:col-span-6 space-y-4 py-4 border-overlay",a%2==0?"md:border-r md:pr-4":"md:pl-4","border-b"),children:(0,i.jsx)(t5,{idx:a,slug:s,metric:e,usage:m,subscription:r,relativeToSubscription:v})},e.key)),N.map((e,a)=>(0,i.jsx)("div",{className:(0,U.default)("col-span-12 md:col-span-6 space-y-4 py-4 border-overlay",(a+b.length)%2==0?"md:border-r md:pr-4":"md:pl-4","border-b"),children:(0,i.jsx)(t6,{slug:s,metric:{key:e,name:(0,H.p5)(e)+" Compute Hours",units:"hours",anchor:"compute",category:"Compute",unitName:"GB"},relativeToSubscription:v,usage:m})},e))]})]})]})})},t9=()=>{var e,a;let{slug:t,projectRef:s}=(0,r.UO)(),[n,o]=(0,u.useState)(),[m,h]=(0,u.useState)(),x=(0,N.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),g=(0,z.l)(),{data:v,isSuccess:y}=(0,ac.Sy)(),{data:b,error:w,isLoading:_,isError:S,isSuccess:C}=(0,d.Gl)({orgSlug:t}),I=null==v?void 0:v.filter(e=>e.organization_id===(null==g?void 0:g.id));(0,u.useEffect)(()=>{s&&y&&void 0!==I&&I.find(e=>e.ref===s)&&h(s)},[s,y]);let A=D().unix(null!==(e=null==b?void 0:b.current_period_start)&&void 0!==e?e:0).utc(),Z=D().unix(null!==(a=null==b?void 0:b.current_period_end)&&void 0!==a?a:0).utc(),E=(0,u.useMemo)(()=>{if(!(null==n?void 0:n.period_start)||!(null==n?void 0:n.period_end)||!b)return!0;let{current_period_start:e,current_period_end:a}=b;return D()(n.period_start.date).isSame(new Date(1e3*e))&&D()(n.period_end.date).isSame(new Date(1e3*a))},[n,b]),k=(0,u.useMemo)(()=>{var e,a;if(null==n?void 0:null===(e=n.period_start)||void 0===e?void 0:e.date)return new Date(null==n?void 0:null===(a=n.period_start)||void 0===a?void 0:a.date).toISOString().slice(0,-5)+"Z"},[n,b]),P=(0,u.useMemo)(()=>{var e,a;return(null==n?void 0:null===(e=n.period_end)||void 0===e?void 0:e.date)&&D()(n.period_end.date).isAfter(D()())?D()().endOf("day").toISOString().slice(0,-5)+"Z":(null==n?void 0:null===(a=n.period_end)||void 0===a?void 0:a.date)?new Date(n.period_end.date).toISOString().slice(0,-5)+"Z":void 0},[n,b]),O=m?null==I?void 0:I.find(e=>e.ref===m):void 0;return x?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l._S,{className:"sticky top-0 border-b bg-studio z-10 overflow-hidden",children:(0,i.jsxs)("div",{className:"py-4 flex items-center space-x-4",children:[_&&(0,i.jsx)(f.Z,{className:"w-[250px]"}),S&&(0,i.jsx)(p.Z,{className:"w-full",subject:"Failed to retrieve usage data",error:w}),C&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tT.Z,{onChange:o,value:tP.eB[0].key,options:[...tP.eB,...tP._T],loading:_,currentBillingPeriodStart:null==b?void 0:b.current_period_start,currentBillingPeriodEnd:null==b?void 0:b.current_period_end}),(0,i.jsxs)(T.Z,{size:"tiny",name:"schema",className:"w-[180px]",value:m,onChange:e=>{"all-projects"===e?h(void 0):h(e)},children:[(0,i.jsx)(T.Z.Option,{id:"all-projects",label:"All projects",value:"all-projects",children:"All projects"},"all-projects"),null==I?void 0:I.map(e=>(0,i.jsx)(T.Z.Option,{id:e.ref,value:e.ref,label:e.name,children:e.name},e.ref))]}),(0,i.jsxs)("div",{className:"flex flex-col xl:flex-row xl:gap-3",children:[(0,i.jsxs)("p",{className:(0,U.default)("text-sm transition",_&&"opacity-50"),children:["Organization is on the ",b.plan.name," plan"]}),(0,i.jsxs)("p",{className:"text-sm text-foreground-light",children:[A.format("DD MMM YYYY")," -"," ",Z.format("DD MMM YYYY")]})]})]})]})}),m?(0,i.jsx)(l._S,{className:"mt-5",children:(0,i.jsx)(ar.Z,{title:"Usage filtered by project",description:(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("p",{children:['You are currently viewing usage for the "',(null==O?void 0:O.name)||m,'" project. Since your organization is using the new organization-based billing, the included quota is for your whole organization and not just this project. For billing purposes, we sum up usage from all your projects. To view your usage quota, set the project filter above back to "All Projects".']}),(0,i.jsx)("div",{children:(0,i.jsx)(W.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{strokeWidth:1.5}),children:(0,i.jsx)(M(),{href:"https://supabase.com/docs/guides/platform/org-based-billing",target:"_blank",rel:"noreferrer",children:"Documentation"})})})]}),defaultVisibility:!0,hideCollapse:!0,icon:(0,i.jsx)(ee.Z,{})})}):(0,i.jsx)(l._S,{id:"restriction",className:"mt-5",children:(0,i.jsx)(e9,{})}),(0,i.jsx)(t7,{orgSlug:t,projectRef:m,subscription:b,startDate:k,endDate:P,currentBillingCycleSelected:E}),(null==b?void 0:b.plan.id)!=="free"&&(0,i.jsx)(t2,{orgSlug:t,projectRef:m,subscription:b,startDate:k,endDate:P}),(0,i.jsx)(tQ,{orgSlug:t,projectRef:m,subscription:b,startDate:k,endDate:P,currentBillingCycleSelected:E}),(0,i.jsx)(t1,{orgSlug:t,projectRef:m,subscription:b,startDate:k,endDate:P,currentBillingCycleSelected:E}),(0,i.jsx)(tK,{orgSlug:t,projectRef:m,subscription:b,startDate:k,endDate:P,currentBillingCycleSelected:E})]}):(0,i.jsx)(l.gW,{children:(0,i.jsx)(j.Z,{resourceText:"view organization usage"})})},se=t(44446),sa=t(52649),st=t(54813),ss=t(24334),sn=t(38421),si=t.n(sn),sr=t(82366),sl=t(13252),so=t(46666),sd=t(88354);async function sc(e,a){let{slug:t,iso_timestamp_start:s,iso_timestamp_end:n,project_refs:i}=e;if(!t)throw Error("slug is required");let r=await (0,sd.U2)("".concat(ej.T5,"/organizations/").concat(t,"/audit?iso_timestamp_start=").concat(s,"&iso_timestamp_end=").concat(n),{signal:a});if(r.error)throw r.error;return r}let su=function(e){let{enabled:a=!0,...t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{slug:s,iso_timestamp_start:n,iso_timestamp_end:i}=e,r=D()(n).utc().format("YYYY-MM-DD"),l=D()(i).utc().format("YYYY-MM-DD");return(0,y.a)(w.O.auditLogs(s,{date_start:r,date_end:l}),a=>{let{signal:t}=a;return sc(e,t)},{enabled:a&&void 0!==s,...t})};async function sm(e,a){let{slug:t}=e;if(!t)throw Error("slug is required");let[s,n]=await Promise.all([(0,b.U2)("/platform/organizations/{slug}/members",{params:{path:{slug:t}},signal:a}),(0,b.U2)("/platform/organizations/{slug}/members/invitations",{params:{path:{slug:t}},signal:a})]),{data:i,error:r}=s,{data:l,error:o}=n;return r&&(0,b.S3)(r),o&&(0,b.S3)(o),[...i,...l.invitations.map(e=>({invited_at:e.invited_at,invited_id:e.id,mfa_enabled:!1,username:e.invited_email.slice(0,1),primary_email:e.invited_email,role_ids:[e.role_id]}))]}let sp=function(e){let{slug:a}=e,{enabled:t=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,y.a)(w.O.members(a),e=>{let{signal:t}=e;return sm({slug:a},t)},{enabled:t&&void 0!==a,...s})};async function sh(e,a){let{slug:t}=e;if(!t)throw Error("slug is required");let{data:s,error:n}=await (0,b.U2)("/platform/organizations/{slug}/roles",{params:{path:{slug:t}},signal:a});return n&&(0,b.S3)(n),{roles:s}}let sx=function(e){let{slug:a}=e,{enabled:t=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,y.a)(w.O.roles(a),e=>{let{signal:t}=e;return sh({slug:a},t)},{enabled:t&&void 0!==a,...s})};var sg=()=>{var e,a,t,s,n,o,d;let{slug:m}=(0,r.UO)(),h=D()().utc().set("millisecond",0),[x,g]=(0,u.useState)(!0),[v,y]=(0,u.useState)({from:h.subtract(1,"day").toISOString(),to:h.toISOString()}),[b,w]=(0,u.useState)(),[_,S]=(0,u.useState)({users:[],projects:[]}),C=(0,N.Xo)(c.KA.READ,"notifications"),{data:I}=(0,ac.Sy)(),{data:A}=(0,er.tl)(),{data:Z}=sp({slug:m}),{data:z}=sx({slug:m}),{data:E,error:k,isLoading:T,isSuccess:P,isError:O,isRefetching:R,refetch:L}=su({slug:m,iso_timestamp_start:v.from,iso_timestamp_end:v.to},{enabled:C,retry:(e,a)=>!a.message.endsWith("upgrade to Team or Enterprise Plan to access audit logs."),retryOnMount:!1,refetchOnWindowFocus:!1});(0,u.useEffect)(()=>{let e=D()(v.from).diff(D()(v.to)),a=setInterval(()=>{let a=D()().utc().set("millisecond",0);y({from:a.add(e).toISOString(),to:a.toISOString()})},3e5);return()=>clearInterval(a)},[v.from,v.to]);let U=null!==(t=null==z?void 0:z.roles)&&void 0!==t?t:[],Y=null!==(s=null==E?void 0:E.retention_period)&&void 0!==s?s:0,G=null!==(n=null==E?void 0:E.result)&&void 0!==n?n:[],B=null==G?void 0:null===(a=G.sort((e,a)=>x?Number(new Date(a.occurred_at))-Number(new Date(e.occurred_at)):Number(new Date(e.occurred_at))-Number(new Date(a.occurred_at))))||void 0===a?void 0:null===(e=a.filter(e=>_.users.length>0?_.users.includes(e.actor.id):e))||void 0===e?void 0:e.filter(e=>_.projects.length>0?_.projects.includes(e.target.metadata.project_ref||""):e),V=null==A?void 0:A.find(e=>e.slug===m);return C?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.gW,{children:(0,i.jsxs)("div",{className:"space-y-4 flex flex-col",children:[T&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(f.Z,{}),(0,i.jsx)(f.Z,{className:"w-3/4"}),(0,i.jsx)(f.Z,{className:"w-1/2"})]}),O?k.message.endsWith("upgrade to Team or Enterprise Plan to access audit logs.")?(0,i.jsxs)(ey.bZ,{variant:"default",title:"Organization Audit Logs are not available on Free or Pro plans",children:[(0,i.jsx)(e7.aN,{}),(0,i.jsxs)("div",{className:"flex flex-row pt-1",children:[(0,i.jsxs)("div",{className:"grow",children:[(0,i.jsx)(ey.Cd,{children:"Organization Audit Logs are not available on Free or Pro plans"}),(0,i.jsx)(ey.X,{className:"flex flex-row justify-between gap-3",children:(0,i.jsx)("p",{children:"Upgrade to Team or Enterprise to view up to 28 days of Audit Logs for your organization."})})]}),(0,i.jsx)("div",{className:"flex items-center",children:(0,i.jsx)(W.z,{type:"primary",asChild:!0,children:(0,i.jsx)(M(),{href:"/org/".concat(m,"/billing?panel=subscriptionPlan"),children:"Upgrade subscription"})})})]})]}):(0,i.jsx)(p.Z,{error:k,subject:"Failed to retrieve audit logs"}):null,P&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("p",{className:"text-xs prose",children:"Filter by"}),(0,i.jsx)(so.E,{name:"Users",options:null!=Z?Z:[],labelKey:"username",valueKey:"gotrue_id",activeOptions:_.users,onSaveFilters:e=>S({..._,users:e})}),(0,i.jsx)(so.E,{name:"Projects",options:null!==(o=null==I?void 0:I.filter(e=>e.organization_id===(null==V?void 0:V.id)))&&void 0!==o?o:[],labelKey:"name",valueKey:"ref",activeOptions:_.projects,onSaveFilters:e=>S({..._,projects:e})}),(0,i.jsx)(sl.M,{hideTime:!0,hideClear:!0,triggerButtonType:"dashed",triggerButtonTitle:"",from:v.from,to:v.to,minDate:D()().subtract(Y,"days").toDate(),maxDate:D()().toDate(),onChange:e=>{if(null!==e.from&&null!==e.to){let a=D()().utc();y({from:D()(e.from).utc().hour(a.hour()).minute(a.minute()).second(a.second()).toISOString(),to:D()(e.to).utc().hour(a.hour()).minute(a.minute()).second(a.second()).toISOString()})}},renderFooter:()=>(0,i.jsxs)(ef.b,{title:"",variant:"info",className:"mx-3 pl-2 pr-2 pt-1 pb-2",children:["Your organization has a log retention period of"," ",(0,i.jsxs)("span",{className:"text-brand",children:[Y," day",Y>1?"s":""]}),". You may only view logs from"," ",D()().subtract(Y,"days").format("DD MMM YYYY")," as the earliest date."]})}),P&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"h-[20px] border-r border-strong !ml-4 !mr-2"}),(0,i.jsxs)("p",{className:"prose text-xs",children:["Viewing ",B.length," logs in total"]})]})]}),(0,i.jsx)(W.z,{type:"default",disabled:T||R,icon:(0,i.jsx)(se.Z,{className:R?"animate-spin":""}),onClick:()=>L(),children:R?"Refreshing":"Refresh"})]}),0===G.length?(0,i.jsx)("div",{className:"bg-surface-100 border rounded p-4 flex items-center justify-between",children:(0,i.jsx)("p",{className:"prose text-sm",children:"Your organization does not have any audit logs available yet"})}):G.length>0&&0===B.length?(0,i.jsx)("div",{className:"bg-surface-100 border rounded p-4 flex items-center justify-between",children:(0,i.jsx)("p",{className:"prose text-sm",children:"No audit logs found based on the filters applied"})}):(0,i.jsx)(eN.Z,{head:[(0,i.jsx)(eN.Z.th,{className:"py-2",children:"User"},"user"),(0,i.jsx)(eN.Z.th,{className:"py-2",children:"Action"},"action"),(0,i.jsx)(eN.Z.th,{className:"py-2",children:"Target"},"target"),(0,i.jsx)(eN.Z.th,{className:"py-2",children:(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("p",{children:"Date"}),(0,i.jsxs)(F.fC,{delayDuration:0,children:[(0,i.jsx)(F.xz,{asChild:!0,children:(0,i.jsx)(W.z,{type:"text",className:"px-1",icon:x?(0,i.jsx)(sa.Z,{strokeWidth:1.5,size:14}):(0,i.jsx)(st.Z,{strokeWidth:1.5,size:14}),onClick:()=>g(!x)})}),(0,i.jsx)(F.h_,{children:(0,i.jsxs)(F.VY,{side:"right",children:[(0,i.jsx)(F.Eh,{className:"radix-tooltip-arrow"}),(0,i.jsx)("div",{className:"rounded bg-alternative py-1 px-2 leading-none shadow border border-background",children:(0,i.jsx)("span",{className:"text-xs text-foreground",children:x?"Sort latest first":"Sort earliest first"})})]})})]})]})},"date"),(0,i.jsx)(eN.Z.th,{className:"py-2"},"actions")],body:null!==(d=null==B?void 0:B.map(e=>{var a,t,s,n,r,l,o,d,c;let u=(null!=Z?Z:[]).find(a=>a.gotrue_id===e.actor.id),m=U.find(e=>{var a;return(null==u?void 0:null===(a=u.role_ids)||void 0===a?void 0:a[0])===e.id}),p=null==I?void 0:I.find(a=>a.ref===e.target.metadata.project_ref),h=null==A?void 0:A.find(a=>a.slug===e.target.metadata.org_slug),x=(null===(a=e.action.metadata[0])||void 0===a?void 0:a.status)!==void 0,g=void 0===u?(0,i.jsx)("div",{className:"flex h-[30px] w-[30px] items-center justify-center border-2 rounded-full border-strong",children:(0,i.jsx)("p",{children:"?"})}):(null==u?void 0:u.invited_id)||(null==u?void 0:u.username)===(null==u?void 0:u.primary_email)?(0,i.jsx)("div",{className:"flex h-[30px] w-[30px] items-center justify-center border-2 rounded-full border-strong",children:(0,i.jsx)(ss.Z,{size:18,strokeWidth:2})}):(0,i.jsx)(si(),{alt:null==u?void 0:u.username,src:"https://github.com/".concat(null!==(t=null==u?void 0:u.username)&&void 0!==t?t:"",".png?size=80"),width:"30",height:"30",className:"border rounded-full"});return(0,i.jsxs)(eN.Z.tr,{onClick:()=>w(e),className:"cursor-pointer hover:!bg-alternative transition duration-100",children:[(0,i.jsx)(eN.Z.td,{children:(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsx)("div",{children:g}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-foreground-light",children:null!==(s=null==u?void 0:u.username)&&void 0!==s?s:"-"}),m&&(0,i.jsx)("p",{className:"mt-0.5 text-xs text-foreground-light",children:null==m?void 0:m.name})]})]})}),(0,i.jsx)(eN.Z.td,{className:"max-w-[250px]",children:(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[x&&(0,i.jsx)("p",{className:"bg-surface-200 rounded px-1 flex items-center justify-center text-xs font-mono border",children:e.action.metadata[0].status}),(0,i.jsx)("p",{className:"truncate",title:e.action.name,children:e.action.name})]})}),(0,i.jsxs)(eN.Z.td,{children:[(0,i.jsxs)("p",{className:"text-foreground-light max-w-[230px] truncate",title:null!==(r=null!==(n=null==p?void 0:p.name)&&void 0!==n?n:null==h?void 0:h.name)&&void 0!==r?r:"-",children:[(null==p?void 0:p.name)?"Project: ":(null==h?void 0:h.name)?"Organization: ":null,null!==(o=null!==(l=null==p?void 0:p.name)&&void 0!==l?l:null==h?void 0:h.name)&&void 0!==o?o:"Unknown"]}),(0,i.jsxs)("p",{className:"text-foreground-light text-xs mt-0.5 truncate",title:null!==(d=e.target.metadata.project_ref)&&void 0!==d?d:e.target.metadata.org_slug,children:[e.target.metadata.project_ref?"Ref: ":e.target.metadata.org_slug?"Slug: ":null,null!==(c=e.target.metadata.project_ref)&&void 0!==c?c:e.target.metadata.org_slug]})]}),(0,i.jsx)(eN.Z.td,{children:D()(e.occurred_at).format("DD MMM YYYY, HH:mm:ss")}),(0,i.jsx)(eN.Z.td,{align:"right",children:(0,i.jsx)(W.z,{type:"default",children:"View details"})})]},e.occurred_at)}))&&void 0!==d?d:[]})]})]})}),(0,i.jsx)(sr.h,{selectedLog:b,onClose:()=>w(void 0)})]}):(0,i.jsx)(l.gW,{children:(0,i.jsx)(j.Z,{resourceText:"view organization audit logs"})})};let sj=e=>[e,"oauth-apps"],sv=e=>[e,"authorized-apps"];async function sf(e,a){let{slug:t}=e;if(!t)throw Error("Organization slug is required");let s=await (0,sd.U2)("".concat(ej.T5,"/organizations/").concat(t,"/oauth/apps?type=authorized"),{signal:a});if(s.error)throw s.error;return s}let sy=function(e){let{slug:a}=e,{enabled:t=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,y.a)(sv(a),e=>{let{signal:t}=e;return sf({slug:a},t)},{enabled:t&&void 0!==a,...s})};async function sb(e,a){let{slug:t}=e;if(!t)throw Error("Organization slug is required");let s=await (0,sd.U2)("".concat(ej.T5,"/organizations/").concat(t,"/oauth/apps?type=published"),{signal:a});if(s.error)throw s.error;return s}let sN=function(e){let{slug:a}=e,{enabled:t=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,y.a)(sj(a),e=>{let{signal:t}=e;return sb({slug:a},t)},{enabled:t&&void 0!==a,...s})};var sw=t(3536),s_=e=>{let{app:a,onSelectRevoke:t}=e;return(0,i.jsxs)(eN.Z.tr,{children:[(0,i.jsx)(eN.Z.td,{children:(0,i.jsx)("div",{className:"w-[30px] h-[30px] rounded-full bg-no-repeat bg-cover bg-center border border-control flex items-center justify-center",style:{backgroundImage:a.icon?"url('".concat(a.icon,"')"):"none"},children:a.icon?"":"".concat(a.name[0])})}),(0,i.jsx)(eN.Z.td,{children:a.name}),(0,i.jsx)(eN.Z.td,{children:D()(a.authorized_at).format("DD/MM/YYYY, HH:mm:ss")}),(0,i.jsx)(eN.Z.td,{align:"right",children:(0,i.jsx)(W.z,{type:"default",icon:(0,i.jsx)(sw.Z,{}),className:"px-1",onClick:()=>t()})})]})},sS=t(16826);async function sC(e){let{id:a,slug:t}=e;if(!a)throw Error("OAuth app ID is required");if(!t)throw Error("Organization slug is required");let s=await (0,sd.$v)("".concat(ej.T5,"/organizations/").concat(t,"/oauth/apps/").concat(a,"?type=published"));if(s.error)throw s.error;return s}let sI=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,I.D)(e=>sC(e),{async onSuccess(a,t,n){let{slug:i}=t;await s.invalidateQueries(sj(i)),await (null==e?void 0:e(a,t,n))},async onError(e,t,s){void 0===a?m.Am.error("Failed to delete application: ".concat(e.message)):a(e,t,s)},...t})};var sA=e=>{let{selectedApp:a,onClose:t}=e,{slug:s}=(0,r.UO)(),{mutate:n,isLoading:l}=sI({onSuccess:()=>{m.Am.success('Successfully deleted the app "'.concat(null==a?void 0:a.name,'"')),t()}}),o=async()=>s?(null==a?void 0:a.id)?void n({slug:s,id:null==a?void 0:a.id}):console.error("App ID is required"):console.error("Slug is required");return(0,i.jsxs)(eD.Z,{size:"medium",alignFooter:"right",header:"Confirm to delete ".concat(null==a?void 0:a.name),visible:void 0!==a,loading:l,onCancel:t,onConfirm:o,children:[(0,i.jsx)(eD.Z.Content,{children:(0,i.jsxs)(ef.b,{withIcon:!0,variant:"warning",title:"This action cannot be undone",children:["Deleting ",null==a?void 0:a.name," will invalidate any access tokens from this application that were authorized by users."]})}),(0,i.jsx)(eD.Z.Content,{children:(0,i.jsx)("ul",{className:"space-y-5",children:(0,i.jsxs)("li",{className:"flex gap-3 text-sm",children:[(0,i.jsx)(sS.Z,{size:14,className:"flex-shrink-0"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Before you remove this application, consider:"}),(0,i.jsx)("ul",{className:"space-y-2 mt-2",children:(0,i.jsx)("li",{className:"list-disc ml-4",children:"No users are currently using this application. It will no longer be available for use after deletion."})})]})]})})})]})},sZ=t(7774),sz=t(78549),sE=t(65644),sk=t(2322),sT=e=>{let{app:a,onSelectEdit:t,onSelectDelete:s}=e,[n,r]=(0,u.useState)(!1),l=(0,N.Xo)(c.KA.UPDATE,"approved_oauth_apps"),o=(0,N.Xo)(c.KA.DELETE,"approved_oauth_apps");return(0,i.jsxs)(eN.Z.tr,{children:[(0,i.jsx)(eN.Z.td,{children:(0,i.jsx)("div",{className:"w-[30px] h-[30px] rounded-full bg-no-repeat bg-cover bg-center border border-control flex items-center justify-center",style:{backgroundImage:a.icon?"url('".concat(a.icon,"')"):"none"},children:a.icon?"":"".concat(a.name[0])})}),(0,i.jsx)(eN.Z.td,{children:(0,i.jsx)("p",{title:a.name,className:"truncate",children:a.name})}),(0,i.jsx)(eN.Z.td,{children:(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("p",{className:"font-mono truncate w-[220px]",title:a.client_id,children:a.client_id}),(0,i.jsx)(W.z,{type:"default",icon:n?(0,i.jsx)(at.Z,{className:"text-brand",strokeWidth:3}):(0,i.jsx)(sZ.Z,{}),className:"ml-2 px-1",onClick:()=>{(0,V.vQ)(a.client_id),r(!0),setTimeout(()=>{r(!1)},3e3)}})]})}),(0,i.jsx)(eN.Z.td,{children:(0,i.jsxs)("span",{className:"font-mono",title:a.client_secret_alias,children:[a.client_secret_alias,"..."]})}),(0,i.jsx)(eN.Z.td,{children:D()(a.created_at).format("DD/MM/YYYY, HH:mm:ss")}),(0,i.jsx)(eN.Z.td,{align:"right",children:(0,i.jsxs)(e0.h_,{children:[(0,i.jsx)(e0.$F,{asChild:!0,children:(0,i.jsx)(W.z,{type:"default",icon:(0,i.jsx)(sz.Z,{}),className:"px-1"})}),(0,i.jsxs)(e0.AW,{align:"end",side:"bottom",children:[(0,i.jsxs)(sk.u,{children:[(0,i.jsx)(sk.aJ,{asChild:!0,children:(0,i.jsxs)(e0.Xi,{disabled:!l,className:"space-x-2 !pointer-events-auto",onClick:()=>{l&&t()},children:[(0,i.jsx)(sE.Z,{size:16}),(0,i.jsx)("p",{children:"Edit app"})]},"edit")}),!l&&(0,i.jsx)(sk._v,{side:"left",children:"You need additional permissions to edit apps"})]}),(0,i.jsx)(e0.VD,{}),(0,i.jsxs)(sk.u,{children:[(0,i.jsx)(sk.aJ,{asChild:!0,children:(0,i.jsxs)(e0.Xi,{disabled:!o,className:"space-x-2 !pointer-events-auto",onClick:()=>{o&&s()},children:[(0,i.jsx)(sw.Z,{size:16}),(0,i.jsx)("p",{children:"Delete app"})]},"delete")}),!o&&(0,i.jsx)(sk._v,{side:"left",children:"You need additional permissions to delete apps"})]})]})]})})]})};async function sP(e){let{slug:a,name:t,website:s,icon:n,scopes:i,redirect_uris:r}=e,l=await (0,sd.v_)("".concat(ej.T5,"/organizations/").concat(a,"/oauth/apps"),{name:t,website:s,icon:n,scopes:i,redirect_uris:r});if(l.error)throw l.error;return l}let sO=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,I.D)(e=>sP(e),{async onSuccess(a,t,n){let{slug:i}=t;await s.invalidateQueries(sj(i)),await (null==e?void 0:e(a,t,n))},async onError(e,t,s){void 0===a?m.Am.error("Failed to create OAuth application: ".concat(e.message)):a(e,t,s)},...t})};async function sR(e){let{id:a,slug:t,name:s,website:n,icon:i,scopes:r,redirect_uris:l}=e;if(!a)throw Error("OAuth app ID is required");if(!t)throw Error("Organization slug is required");if(!s)throw Error("OAuth app name is required");if(!n)throw Error("OAuth app URL is required");if(!l||0===l.length)throw Error("Redirect URIs are required");let o=await (0,sd.gz)("".concat(ej.T5,"/organizations/").concat(t,"/oauth/apps/").concat(a),{name:s,website:n,icon:i,scopes:r,redirect_uris:l});if(o.error)throw o.error;return o}let sD=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,I.D)(e=>sR(e),{async onSuccess(a,t,n){let{slug:i}=t;await s.invalidateQueries(sj(i)),await (null==e?void 0:e(a,t,n))},async onError(e,t,s){void 0===a?m.Am.error("Failed to update application: ".concat(e.message)):a(e,t,s)},...t})};var sL=t(27208);let sM=async function(e,a,t){let s=!(arguments.length>3)||void 0===arguments[3]||arguments[3],n=(0,sL.eI)("https://obuldanrptloktxcffvn.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9idWxkYW5ycHRsb2t0eGNmZnZuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTg2MTQ2ODUsImV4cCI6MjAzNDE5MDY4NX0.NFt49g6DFkc1X5khCzN5p01iAVo2TMxlx88cY1V0E2M",{auth:{persistSession:!1,autoRefreshToken:!1,multiTab:!1,detectSessionInUrl:!1,localStorage:{getItem:e=>void 0,setItem:(e,a)=>{},removeItem:e=>{}}}}),{data:i,error:r}=await n.storage.from(e).upload(a,t,{cacheControl:"3600"});if(r){console.error("Failed to upload:",r);return}if(i&&s){let{data:a}=await n.storage.from(e).getPublicUrl(i.path);return null==a?void 0:a.publicUrl}};var sU=t(25001);function sF(e){let{label:a,children:t}=e;return(0,i.jsx)("h1",{children:"WIP"})}sF.Dragger=function(e){let{label:a,afterLabel:t,beforeLabel:s,layout:n,children:r,files:l,setFiles:o}=e;return(0,i.jsx)("div",{onDragOver:e=>{e.preventDefault()},onDragEnter:e=>{e.preventDefault()},onDragLeave:e=>{e.preventDefault()},onDrop:e=>{e.preventDefault(),o([...l,...e.dataTransfer.files])},children:(0,i.jsx)(sU.l,{label:a,afterLabel:t,beforeLabel:s,layout:n,children:(0,i.jsxs)("label",{htmlFor:"file-upload",children:[(0,i.jsx)("input",{id:"file-upload",name:"file-upload",type:"file",onChange:e=>{e.preventDefault(),o([...l,...e.target.files||[]])}}),r]})})})};var sY=t(41421),sG=t(78232);let sB=e=>{let{children:a,scopeName:t,scopes:s,onChange:n}=e;return(0,i.jsx)(e0.bO,{checked:s.includes(t),onCheckedChange:e=>{e?n([...s,t]):n([...s.filter(e=>e!==t)])},children:a})},sV=e=>{let{title:a,description:t,readScopeName:s,writeScopeName:n,scopes:r,setScopes:l}=e,o="Access: No access";return r.includes(s)&&(o="Access: Read-only"),r.includes(n)&&(o="Access: Write-only"),r.includes(s)&&r.includes(n)&&(o="Access: Read and write"),(0,i.jsxs)("div",{className:"flex flex-row justify-between p-4 border first:rounded-t last:rounded-b",children:[(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("span",{className:"text-foreground text-sm",children:a}),(0,i.jsx)("span",{className:"text-foreground-light text-xs",children:t})]}),(0,i.jsxs)(e0.h_,{children:[(0,i.jsx)(e0.$F,{asChild:!0,children:(0,i.jsx)(W.z,{type:"default",iconRight:(0,i.jsx)(sG.Z,{}),children:(0,i.jsx)("p",{children:o})})}),(0,i.jsxs)(e0.AW,{align:"end",children:[(0,i.jsx)(e0.Ju,{children:"Select an access level"}),(0,i.jsx)(e0.VD,{}),(0,i.jsx)(sB,{scopeName:s,scopes:r,onChange:l,children:"Read"}),(0,i.jsx)(sB,{scopeName:n,scopes:r,onChange:l,children:"Write"})]})]})]},a)},sW=e=>{let{scopes:a,setScopes:t}=e;return(0,i.jsxs)("div",{className:"-space-y-px",children:[(0,i.jsx)(sV,{title:"Auth",description:"Auth configurations and SSO providers.",readScopeName:c.YX.AUTH_READ,writeScopeName:c.YX.AUTH_WRITE,scopes:a,setScopes:t}),(0,i.jsx)(sV,{title:"Database",description:"Postgres configurations, SQL snippets, SSL enforcement configurations and Typescript schema types.",readScopeName:c.YX.DATABASE_READ,writeScopeName:c.YX.DATABASE_WRITE,scopes:a,setScopes:t}),(0,i.jsx)(sV,{title:"Domains",description:"Custom domains and vanity subdomains.",readScopeName:c.YX.DOMAINS_READ,writeScopeName:c.YX.DOMAINS_WRITE,scopes:a,setScopes:t}),(0,i.jsx)(sV,{title:"Edge Functions",description:"Edge functions.",readScopeName:c.YX.EDGE_FUNCTIONS_READ,writeScopeName:c.YX.EDGE_FUNCTIONS_WRITE,scopes:a,setScopes:t}),(0,i.jsx)(sV,{title:"Environment",description:"Environments/branches.",readScopeName:c.YX.ENVIRONMENT_READ,writeScopeName:c.YX.ENVIRONMENT_WRITE,scopes:a,setScopes:t}),(0,i.jsx)(sV,{title:"Organizations",description:"Organizations and all its members.",readScopeName:c.YX.ORGANIZATIONS_READ,writeScopeName:c.YX.ORGANIZATIONS_WRITE,scopes:a,setScopes:t}),(0,i.jsx)(sV,{title:"Projects",description:"Metadata, upgrade status, network restrictions and network bans.",readScopeName:c.YX.PROJECTS_READ,writeScopeName:c.YX.PROJECTS_WRITE,scopes:a,setScopes:t}),(0,i.jsx)(sV,{title:"REST",description:"PostgREST configurations.",readScopeName:c.YX.REST_READ,writeScopeName:c.YX.REST_WRITE,scopes:a,setScopes:t}),(0,i.jsx)(sV,{title:"Secrets",description:"API keys, secrets and pgsodium configurations.",readScopeName:c.YX.SECRETS_READ,writeScopeName:c.YX.SECRETS_WRITE,scopes:a,setScopes:t}),(0,i.jsx)(sV,{title:"Storage",description:"Storage buckets and files.",readScopeName:c.YX.STORAGE_READ,writeScopeName:c.YX.STORAGE_WRITE,scopes:a,setScopes:t})]})};var sq=e=>{let{visible:a,selectedApp:t,onClose:s,onCreateSuccess:n}=e,{slug:l}=(0,r.UO)(),o=(0,u.useRef)(),{mutate:d}=sO({onSuccess:(e,a)=>{m.Am.success('Successfully created OAuth app "'.concat(a.name,'"!')),s(),n(e),h(!1)},onError:e=>{m.Am.error("Failed to create OAuth application: ".concat(e.message)),h(!1)}}),{mutate:c}=sD({onSuccess:(e,a)=>{m.Am.success('Successfully updated OAuth app "'.concat(a.name,'"!')),s(),h(!1)},onError:e=>{m.Am.error("Failed to update OAuth application: ".concat(e.message)),h(!1)}}),[p,h]=(0,u.useState)(!1),[x,g]=(0,u.useState)(!1),[j,v]=(0,u.useState)(),[f,y]=(0,u.useState)(),[b,N]=(0,u.useState)({}),[w,_]=(0,u.useState)([{id:(0,V.k$)(),value:""}]),[S,C]=(0,u.useState)([]);(0,u.useEffect)(()=>{a&&(N({}),h(!1),v(void 0),void 0!==t?(_(t.redirect_uris.map(e=>({id:(0,V.k$)(),value:e}))),C(t.scopes),y(null===t.icon?void 0:t.icon)):(_([{id:(0,V.k$)(),value:""}]),C([]),y(void 0)))},[a,t]);let I=(e,a)=>{_(w.map(t=>t.id===e?{id:e,value:a}:t)),N({})},A=e=>{_(w.filter(a=>a.id!==e))},Z=async e=>{e.persist();let[a]=e.target.files||e.dataTransfer.items;v(a),y(URL.createObjectURL(a)),e.target.value=""},z=async e=>{if(!l)return console.error("Slug is required");let a=w.filter(e=>e.value.length>0).map(e=>e.value);if(0===a.length){N({urls:"Please provide at least one URL"});return}N({}),h(!0);let{name:s,website:n}=e,i=void 0!==j?await sM("oauth-app-icons","".concat(l,"/").concat((0,V.k$)(),".png"),j):f;void 0===t?d({slug:l,name:s,website:n,redirect_uris:a,scopes:S,icon:i}):c({id:t.id,slug:l,name:s,website:n,redirect_uris:a,scopes:S,icon:void 0===i?null:i})};return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(eI.ZP,{hideFooter:!0,size:"large",visible:a,header:void 0!==t?"Update OAuth application":"Publish a new OAuth application",onCancel:()=>s(),children:(0,i.jsx)(E.Z,{validateOnBlur:!0,className:"h-full",initialValues:{name:"",website:""},validate:e=>{let a={};return e.name||(a.name="Please provide a name for your application"),e.website||(a.website="Please provide a URL for your site"),(0,V.HH)(e.website)||(a.website="Please provide a valid URL for your site"),a},onSubmit:z,children:e=>{let{resetForm:n,values:r}=e;return(0,u.useEffect)(()=>{if(a&&void 0!==t){let e={name:t.name,website:t.website};n({values:e,initialValues:e})}},[a,t]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"h-full flex flex-col",children:[(0,i.jsxs)("div",{className:"flex-grow",children:[(0,i.jsx)(eI.ZP.Content,{children:(0,i.jsxs)("div",{className:"py-4 flex items-start justify-between gap-10",children:[(0,i.jsxs)("div",{className:"space-y-4 w-full",children:[(0,i.jsx)(k.Z,{id:"name",label:"Application name",descriptionText:(null==t?void 0:t.id)&&"ID: ".concat(t.id)}),(0,i.jsx)(k.Z,{id:"website",label:"Website URL",placeholder:"https://my-website.com"})]}),(0,i.jsxs)("div",{children:[void 0!==f?(0,i.jsx)("div",{className:(0,eA.cn)("shadow transition group relative","bg-center bg-cover bg-no-repeat","mt-4 mr-4 space-y-2 rounded-full h-[120px] w-[120px] flex flex-col items-center justify-center"),style:{backgroundImage:f?'url("'.concat(f,'")'):"none"},children:(0,i.jsx)("div",{className:"absolute bottom-1 right-1",children:(0,i.jsxs)(e0.h_,{children:[(0,i.jsx)(e0.$F,{asChild:!0,children:(0,i.jsx)(W.z,{type:"default",className:"px-1",children:(0,i.jsx)(sE.Z,{})})}),(0,i.jsxs)(e0.AW,{align:"end",side:"bottom",children:[(0,i.jsx)(e0.Xi,{onClick:()=>{o.current&&o.current.click()},children:(0,i.jsx)("p",{children:"Upload image"})},"upload"),(0,i.jsx)(e0.Xi,{onClick:()=>{v(void 0),y(void 0)},children:(0,i.jsx)("p",{children:"Remove image"})},"remove")]})]})})}):(0,i.jsxs)("div",{className:(0,eA.cn)("border border-strong transition opacity-75 hover:opacity-100","mt-4 mr-4 space-y-2 rounded-full h-[120px] w-[120px] flex flex-col items-center justify-center cursor-pointer"),onClick:()=>{o.current&&o.current.click()},children:[(0,i.jsx)(sF,{size:18,strokeWidth:1.5,className:"text-foreground"}),(0,i.jsx)("p",{className:"text-xs text-foreground-light",children:"Upload logo"})]}),(0,i.jsx)("input",{multiple:!0,type:"file",ref:o,className:"hidden",accept:"image/png, image/jpeg",onChange:Z})]})]})}),(0,i.jsx)(eI.ZP.Separator,{}),(0,i.jsxs)(eI.ZP.Content,{className:"py-4",children:[(0,i.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"prose text-sm",children:"Authorization callback URLs"}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"All URLs must use HTTPS, except for localhost"})]}),(0,i.jsx)(W.z,{onClick:()=>_(w.concat({id:(0,V.k$)(),value:""})),children:"Add URL"})]}),(0,i.jsxs)("div",{className:"space-y-2 pb-2",children:[w.map(e=>(0,i.jsx)(k.Z,{value:e.value,onChange:a=>I(e.id,a.target.value),placeholder:"e.g https://my-website.com",actions:[w.length>1?(0,i.jsx)(W.z,{type:"default",onClick:()=>A(e.id),children:"Remove"},"remove-url"):null]},e.id)),b.urls&&(0,i.jsx)("p",{className:"text-red-900 text-sm",children:b.urls})]})]}),(0,i.jsx)(eI.ZP.Separator,{}),(0,i.jsxs)("div",{className:"p-6 ",children:[(0,i.jsxs)("div",{className:"flex items-start justify-between space-x-4 pb-4",children:[(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("span",{className:"prose text-sm",children:"Application permissions"}),(0,i.jsx)("span",{className:"text-sm text-foreground-light",children:"The application permissions are organized in scopes and will be presented to the user when adding an app to their organization and all of its projects."})]}),(0,i.jsx)(W.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{}),children:(0,i.jsx)(M(),{href:"https://supabase.com/docs/guides/platform/oauth-apps/oauth-scopes",target:"_blank",rel:"noreferrer",children:"Documentation"})})]}),(0,i.jsx)(sW,{scopes:S,setScopes:C})]})]}),(0,i.jsx)(eI.ZP.Separator,{}),(0,i.jsx)(eI.ZP.Content,{children:(0,i.jsxs)("div",{className:"pt-2 pb-3 flex items-center justify-between",children:[(0,i.jsx)(W.z,{type:"default",onClick:()=>g(!0),disabled:0===r.name.length||0===r.website.length,children:"Preview consent for users"}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(W.z,{type:"default",disabled:p,onClick:()=>s(),children:"Cancel"}),(0,i.jsx)(W.z,{htmlType:"submit",loading:p,disabled:p,children:"Confirm"})]})]})})]}),(0,i.jsxs)(eD.Z,{hideFooter:!0,className:"!max-w-[600px]",visible:x,onCancel:()=>g(!1),children:[(0,i.jsx)(eD.Z.Content,{children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("p",{children:["Authorize API access for ",r.name]}),(0,i.jsx)(ek.C,{variant:"brand",children:"Preview"})]})}),(0,i.jsx)(eD.Z.Separator,{}),(0,i.jsxs)(eD.Z.Content,{children:[(0,i.jsx)(sY.Z,{icon:f||null,name:r.name,domain:r.website,scopes:S}),(0,i.jsxs)("div",{className:"pt-4 space-y-2",children:[(0,i.jsx)("p",{className:"prose text-sm",children:"Select an organization to grant API access to"}),(0,i.jsx)("div",{className:"border border-control text-foreground-light rounded px-4 py-2 text-sm bg-surface-200",children:"Organizations that you have access to will be listed here"})]})]}),(0,i.jsx)(eD.Z.Separator,{}),(0,i.jsx)(eD.Z.Content,{children:(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("p",{className:"prose text-xs",children:"This is what your users will see when authorizing with your app"}),(0,i.jsx)(W.z,{type:"default",onClick:()=>g(!1),children:"Close"})]})})]})]})}})})})};async function sH(e){let{id:a,slug:t}=e;if(!a)throw Error("App ID is required");if(!t)throw Error("Organization slug is required");let s=await (0,sd.v_)("".concat(ej.T5,"/organizations/").concat(t,"/oauth/apps/").concat(a,"/revoke"),{});if(s.error)throw s.error;return s}let sX=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,I.D)(e=>sH(e),{async onSuccess(a,t,n){let{slug:i}=t;await s.invalidateQueries(sv(i)),await (null==e?void 0:e(a,t,n))},async onError(e,t,s){void 0===a?m.Am.error("Failed to revoke application: ".concat(e.message)):a(e,t,s)},...t})};var sK=e=>{let{selectedApp:a,onClose:t}=e,{slug:s}=(0,r.UO)(),{mutate:n,isLoading:l}=sX({onSuccess:()=>{m.Am.success('Successfully revoked the app "'.concat(null==a?void 0:a.name,'"')),t()}}),o=async()=>s?(null==a?void 0:a.id)?void n({slug:s,id:null==a?void 0:a.id}):console.error("App ID is required"):console.error("Slug is required");return(0,i.jsxs)(eD.Z,{size:"medium",alignFooter:"right",header:"Confirm to revoke ".concat(null==a?void 0:a.name),visible:void 0!==a,loading:l,onCancel:t,onConfirm:o,children:[(0,i.jsx)(eD.Z.Content,{children:(0,i.jsxs)(ef.b,{withIcon:!0,variant:"warning",title:"This action cannot be undone",children:[null==a?void 0:a.name," application will no longer have access to your organization's settings and projects."]})}),(0,i.jsx)(eD.Z.Content,{children:(0,i.jsx)("ul",{className:"space-y-5",children:(0,i.jsxs)("li",{className:"flex gap-3 text-sm",children:[(0,i.jsx)(sS.Z,{size:14,className:"flex-shrink-0"}),(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Before you remove this app, consider:"}),(0,i.jsx)("ul",{className:"space-y-2 mt-2",children:(0,i.jsx)("li",{className:"list-disc ml-4",children:"No users are currently using this application. The application will no longer have access to your organization after being revoked."})})]})]})})})]})},sQ=()=>{var e,a,t,s;let{slug:n}=(0,r.UO)(),[o,d]=(0,u.useState)(!1),[m,h]=(0,u.useState)(),[x,g]=(0,u.useState)(),[v,y]=(0,u.useState)(),[b,w]=(0,u.useState)(),_=(0,N.Xo)(c.KA.READ,"approved_oauth_apps"),S=(0,N.Xo)(c.KA.CREATE,"approved_oauth_apps"),{data:C,error:I,isLoading:A,isSuccess:Z,isError:z}=sN({slug:n},{enabled:_}),E=null==C?void 0:C.sort((e,a)=>Number(new Date(e.created_at))-Number(new Date(a.created_at))),{data:T,isLoading:P,isSuccess:O,isError:R}=sy({slug:n}),D=null==T?void 0:T.sort((e,a)=>Number(new Date(e.authorized_at))-Number(new Date(a.authorized_at)));return _?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(l.gW,{children:[(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{children:"Published Apps"}),(0,i.jsx)("p",{className:"text-foreground-light text-sm",children:"Build integrations that extend Supabase's functionality"})]}),(0,i.jsx)(ai.u,{disabled:!S,type:"primary",onClick:()=>d(!0),tooltip:{content:{side:"bottom",text:"You need additional permissions to create apps"}},children:"Add application"})]}),A&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(f.Z,{}),(0,i.jsx)(f.Z,{className:"w-3/4"}),(0,i.jsx)(f.Z,{className:"w-1/2"})]}),z&&(0,i.jsx)(p.Z,{error:I,subject:"Failed to retrieve published OAuth apps"}),void 0!==m&&(0,i.jsxs)(ef.b,{withIcon:!0,variant:"success",title:"Successfully published a new application!",children:[(0,i.jsx)("div",{className:"absolute top-4 right-4",children:(0,i.jsx)(W.z,{type:"text",icon:(0,i.jsx)(aK.Z,{size:18}),className:"px-1",onClick:()=>h(void 0)})}),(0,i.jsxs)("div",{className:"w-full space-y-4",children:[(0,i.jsx)("p",{className:"text-sm",children:"Ensure that you store the client secret securely - you will not be able to see it again."}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)(k.Z,{copy:!0,readOnly:!0,size:"small",label:"Client ID",className:"max-w-xl input-mono",value:m.client_id,onChange:()=>{}}),(0,i.jsx)(k.Z,{copy:!0,readOnly:!0,size:"small",label:"Client secret",className:"max-w-xl input-mono",value:m.client_secret,onChange:()=>{}})]})]})]}),Z&&(0,i.jsx)(i.Fragment,{children:(null!==(e=null==C?void 0:C.length)&&void 0!==e?e:0)===0?(0,i.jsx)("div",{className:"bg-surface-100 border rounded p-4 flex items-center justify-between mt-4",children:(0,i.jsx)("p",{className:"prose text-sm",children:"You do not have any published applications yet"})}):(0,i.jsx)(eN.Z,{head:[(0,i.jsx)(eN.Z.th,{className:"w-[30px]"},"icon"),(0,i.jsx)(eN.Z.th,{children:"Name"},"name"),(0,i.jsx)(eN.Z.th,{children:"Client ID"},"client-id"),(0,i.jsx)(eN.Z.th,{children:"Client Secret"},"client-secret"),(0,i.jsx)(eN.Z.th,{children:"Created at"},"created-at"),(0,i.jsx)(eN.Z.th,{},"delete-action")],body:null!==(a=null==E?void 0:E.map(e=>(0,i.jsx)(sT,{app:e,onSelectEdit:()=>{d(!0),g(e)},onSelectDelete:()=>y(e)},e.id)))&&void 0!==a?a:[]})})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{children:"Authorized Apps"}),(0,i.jsx)("p",{className:"text-foreground-light text-sm",children:"Applications that have access to your organization's settings and projects"}),(0,i.jsxs)("div",{className:"mt-4",children:[P&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(f.Z,{}),(0,i.jsx)(f.Z,{className:"w-3/4"}),(0,i.jsx)(f.Z,{className:"w-1/2"})]}),R&&(0,i.jsx)(p.Z,{subject:"Failed to retrieve authorized apps"}),O&&(0,i.jsx)(i.Fragment,{children:(null!==(t=T.length)&&void 0!==t?t:0)===0?(0,i.jsx)("div",{className:"bg-surface-100 border rounded p-4 flex items-center justify-between",children:(0,i.jsx)("p",{className:"prose text-sm",children:"You do not have any authorized applications yet"})}):(0,i.jsx)(eN.Z,{className:"mt-4",head:[(0,i.jsx)(eN.Z.th,{className:"w-[30px]"},"icon"),(0,i.jsx)(eN.Z.th,{children:"Name"},"name"),(0,i.jsx)(eN.Z.th,{children:"Authorized at"},"authorized-at"),(0,i.jsx)(eN.Z.th,{},"delete-action")],body:null!==(s=null==D?void 0:D.map(e=>(0,i.jsx)(s_,{app:e,onSelectRevoke:()=>w(e)},e.id)))&&void 0!==s?s:[]})})]})]})]}),(0,i.jsx)(sq,{visible:o,selectedApp:x,onClose:()=>{g(void 0),d(!1)},onCreateSuccess:h}),(0,i.jsx)(sA,{selectedApp:v,onClose:()=>y(void 0)}),(0,i.jsx)(sK,{selectedApp:b,onClose:()=>w(void 0)})]}):(0,i.jsx)(l.gW,{children:(0,i.jsx)(j.Z,{resourceText:"view OAuth apps"})})},sJ=t(68806);async function s$(e){let{slug:a,gotrueId:t}=e,s=await (0,sd.$v)("".concat(ej.T5,"/organizations/").concat(a,"/members/").concat(t));if(s.error)throw s.error;return s}let s0=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,I.D)(e=>s$(e),{async onSuccess(a,t,n){let{slug:i}=t;await Promise.all([s.invalidateQueries(w.O.members(i)),s.invalidateQueries(w.O.roles(i))]),await (null==e?void 0:e(a,t,n))},async onError(e,t,s){void 0===a?m.Am.error("Failed to remove member: ".concat(e.message)):a(e,t,s)},...t})};var s2=t(96551),s1=t(74138),s4=t(1842),s3=t.n(s4),s5=t(90038),s6=t(3507);async function s8(e){let{slug:a,email:t,roleId:s,projects:n}=e,i={email:t,role_id:s};void 0!==n&&(i.role_scoped_projects=n);let{data:r,error:l}=await (0,b.v_)("/platform/organizations/{slug}/members/invitations",{params:{path:{slug:a}},body:i});return l&&(0,b.S3)(l),r}let s7=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,I.D)(e=>s8(e),{async onSuccess(a,t,n){let{slug:i}=t;await Promise.all([s.invalidateQueries(s6.O.rolesV2(i)),s.invalidateQueries(w.O.members(i))]),await (null==e?void 0:e(a,t,n))},async onError(e,t,s){void 0===a?m.Am.error("Failed to update member role: ".concat(e.message)):a(e,t,s)},...t})},s9=["Owner","Administrator","Developer","Read-only"];async function ne(e,a){let{slug:t}=e;if(!t)throw Error("slug is required");let{data:s,error:n}=await (0,b.U2)("/platform/organizations/{slug}/roles",{params:{path:{slug:t}},headers:{Version:"2"},signal:a});return n&&(0,b.S3)(n),s}let na=function(e){let{slug:a}=e,{enabled:t=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,y.a)(s6.O.rolesV2(a),e=>{let{signal:t}=e;return ne({slug:a},t)},{enabled:t&&void 0!==a,select:e=>({...e,org_scoped_roles:e.org_scoped_roles.sort((e,a)=>s9.indexOf(e.name)-s9.indexOf(a.name))}),...s})};async function nt(e){let{slug:a,invitedEmail:t,ownerId:s,roleId:n}=e,i=await (0,sd.v_)("".concat(ej.T5,"/organizations/").concat(a,"/members/invite"),{invited_email:t,owner_id:s,role_id:n});if(i.error)throw i.error;return i}let ns=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,I.D)(e=>nt(e),{async onSuccess(a,t,n){let{slug:i}=t;await Promise.all([s.invalidateQueries(w.O.members(i)),s.invalidateQueries(w.O.roles(i))]),await (null==e?void 0:e(a,t,n))},async onError(e,t,s){void 0===a?m.Am.error("Failed to invite member: ".concat(e.message)):a(e,t,s)},...t})};var nn=t(41909),ni=t(93705),nr=t(61786),nl=t(90504),no=t(19869),nd=t(87668);let nc=(e,a,t)=>{let{permissions:s,organizationSlug:n}=(0,N.Rc)(t,e,void 0!==t&&void 0!==e),i=[],r=[];return a&&e&&a.forEach(e=>{(0,N.G8)(s,c.KA.CREATE,"auth.subject_roles",{resource:{role_id:e.id}},n)&&i.push(e.id),(0,N.G8)(s,c.KA.DELETE,"auth.subject_roles",{resource:{role_id:e.id}},n)&&r.push(e.id)}),{rolesAddable:i,rolesRemovable:r}},nu=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.filter(e=>{var t;let[s]=null!==(t=e.role_ids)&&void 0!==t?t:[],n=a.find(e=>e.id===s);return(null==n?void 0:n.name)==="Owner"&&!e.invited_at}).length>1},nm=()=>{var e,a;let{slug:t}=(0,r.UO)(),{profile:s}=(0,tZ.Un)(),n=(0,z.l)(),{permissions:l}=(0,N.Rc)(),[o,p]=(0,u.useState)(!1),[h,x]=(0,u.useState)(!1),{data:g}=(0,ac.Sy)(),{data:j}=sp({slug:t}),{data:v,isSuccess:f}=na({slug:t}),y=null!==(e=null==v?void 0:v.org_scoped_roles)&&void 0!==e?e:[],b=(null!=g?g:[]).filter(e=>e.organization_id===(null==n?void 0:n.id)).sort((e,a)=>e.name.localeCompare(a.name)),w=(0,N.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),{data:_,isSuccess:S}=(0,d.Gl)({orgSlug:t},{enabled:w}),C=null==_?void 0:_.plan,I=(0,d.Tt)(t),A=null==j?void 0:j.find(e=>e.gotrue_id===(null==s?void 0:s.gotrue_id)),Z=1===(null!==(a=null==A?void 0:A.role_ids)&&void 0!==a?a:[]).length&&y.some(e=>e.id===(null==A?void 0:A.role_ids[0])),{rolesAddable:E}=nc(null==n?void 0:n.slug,y,null!=l?l:[]),k=Z&&y.some(e=>{let{id:a}=e;return(0,N.G8)(l,c.KA.CREATE,"user_invites",{resource:{role_id:a}},null==n?void 0:n.slug)}),{mutate:T,isLoading:P}=s7(),{mutate:O,isLoading:R}=ns(),D=aL.Ry({email:aL.Z_().email("Must be a valid email address").min(1,"Email is required"),role:aL.Z_().min(1,"Role is required"),applyToOrg:aL.O7(),projectRef:aL.Z_()}),L=(0,aD.cI)({mode:"onBlur",reValidateMode:"onBlur",resolver:(0,aR.F)(D),defaultValues:{email:"",role:"",applyToOrg:!0,projectRef:""}}),{applyToOrg:U}=L.watch(),F=async e=>{if(!t)return console.error("Slug is required");if((null==s?void 0:s.id)===void 0)return console.error("Profile ID required");let a=y.find(e=>"Developer"===e.name),n=(null!=j?j:[]).find(a=>a.primary_email===e.email.toLowerCase());if(void 0!==n)return n.invited_id?(0,m.Am)("User has already been invited to this organization"):(0,m.Am)("User is already in this organization");I?T({slug:t,email:e.email.toLowerCase(),roleId:Number(e.role),...!e.applyToOrg&&e.projectRef?{projects:[e.projectRef]}:{}},{onSuccess:()=>{var e;m.Am.success("Successfully sent invitation to new member"),p(!o),L.reset({email:"",role:null!==(e=null==a?void 0:a.id.toString())&&void 0!==e?e:"",applyToOrg:!0,projectRef:""})}}):O({slug:t,invitedEmail:e.email.toLowerCase(),ownerId:s.id,roleId:Number(e.role)},{onSuccess:e=>{if(s3()(e))m.Am.error("Failed to add member");else{var t;m.Am.success("Successfully added new member"),p(!o),L.reset({email:"",role:null!==(t=null==a?void 0:a.id.toString())&&void 0!==t?t:"",applyToOrg:!0,projectRef:""})}}})};return(0,u.useEffect)(()=>{if(f&&o){let e=y.find(e=>"Developer"===e.name);void 0!==e&&L.setValue("role",e.id.toString())}},[f,o]),(0,u.useEffect)(()=>{if(U)L.setValue("projectRef","");else{let e=null==b?void 0:b[0];void 0!==e&&L.setValue("projectRef",e.ref)}},[U]),(0,i.jsxs)(nn.Vq,{open:o,onOpenChange:p,children:[(0,i.jsx)(nn.hg,{asChild:!0,children:(0,i.jsxs)(sk.u,{children:[(0,i.jsx)(sk.aJ,{asChild:!0,children:(0,i.jsx)(W.z,{disabled:!k,className:"pointer-events-auto",onClick:()=>p(!0),children:"Invite"})}),!k&&(0,i.jsx)(sk._v,{side:"bottom",children:"You need additional permissions to invite a member to this organization"})]})}),(0,i.jsxs)(nn.cZ,{size:"medium",children:[(0,i.jsx)(nn.fK,{children:(0,i.jsx)(nn.$N,{children:"Invite a member to this organization"})}),(0,i.jsx)(nn.P3,{}),(0,i.jsx)(aB.l0,{...L,children:(0,i.jsxs)("form",{id:"organization-invitation",className:"flex flex-col gap-y-4",onSubmit:L.handleSubmit(F),children:[(0,i.jsxs)(nn.VO,{className:"flex flex-col gap-y-4 pb-2",children:[I&&(0,i.jsx)(aB.Wi,{name:"applyToOrg",control:L.control,render:e=>{let{field:a}=e;return(0,i.jsx)(nd.E,{layout:"flex",label:"Apply role to all projects in the organization",children:(0,i.jsx)(aB.NI,{children:(0,i.jsx)(ni.r,{checked:a.value,onCheckedChange:e=>L.setValue("applyToOrg",e)})})})}}),(0,i.jsx)(aB.Wi,{name:"role",control:L.control,render:e=>{var a,t;let{field:s}=e;return(0,i.jsx)(nd.E,{label:"Member role",children:(0,i.jsx)(aB.NI,{children:(0,i.jsxs)(aV.Ph,{value:s.value,onValueChange:e=>L.setValue("role",e),children:[(0,i.jsx)(aV.i4,{className:"text-sm capitalize",children:null!==(t=null===(a=y.find(e=>e.id===Number(s.value)))||void 0===a?void 0:a.name)&&void 0!==t?t:"Unknown"}),(0,i.jsx)(aV.Bw,{children:(0,i.jsx)(aV.DI,{children:y.map(e=>{let a=E.includes(e.id);return(0,i.jsxs)(aV.Ql,{value:e.id.toString(),className:"text-sm [&>span:nth-child(2)]:w-full [&>span:nth-child(2)]:flex [&>span:nth-child(2)]:items-center [&>span:nth-child(2)]:justify-between",disabled:!a,children:[(0,i.jsx)("span",{children:e.name}),!a&&(0,i.jsx)("span",{children:"Additional permissions required to assign role"})]},e.id)})})})]})})})}}),!U&&(0,i.jsx)(aB.Wi,{name:"projectRef",control:L.control,render:e=>{var a,t;let{field:s}=e;return(0,i.jsx)(nd.E,{label:"Select a project",description:"You can assign roles to multiple projects once the invite is accepted",children:(0,i.jsx)(aB.NI,{children:(0,i.jsxs)(nr.J2,{open:h,onOpenChange:x,children:[(0,i.jsx)(nr.xo,{asChild:!0,children:(0,i.jsx)(W.z,{block:!0,type:"default",role:"combobox",size:"small",className:"justify-between max-w-[470px]",iconRight:(0,i.jsx)(s5.Z,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"}),children:null!==(t=null===(a=b.find(e=>e.ref===s.value))||void 0===a?void 0:a.name)&&void 0!==t?t:"Unknown"})}),(0,i.jsx)(nr.yk,{sameWidthAsTrigger:!0,className:"p-0",children:(0,i.jsxs)(nl.mY,{filter:(e,a)=>{let t=b.find(a=>a.ref===e),s=null==t?void 0:t.name.toLowerCase();return void 0!==s&&s.includes(a.toLowerCase())?1:e.includes(a)?1:0},children:[(0,i.jsx)(nl.sZ,{placeholder:"Search project..."}),(0,i.jsxs)(nl.e8,{children:[(0,i.jsx)(nl.rb,{children:"No projects found..."}),(0,i.jsx)(nl.fu,{children:(0,i.jsx)(no.x,{className:(0,eA.cn)((b||[]).length>7&&"max-h-[210px] overflow-y-auto"),children:b.map(e=>(0,i.jsxs)(nl.di,{value:e.ref,onSelect:e=>{L.setValue("projectRef",e),x(!1)},children:[(0,i.jsx)(at.Z,{className:(0,eA.cn)("mr-2 h-4 w-4",s.value===e.ref?"opacity-100":"opacity-0")}),e.name]},e.ref))})})]})]})})]})})})}}),(0,i.jsx)(aB.Wi,{name:"email",control:L.control,render:e=>{let{field:a}=e;return(0,i.jsx)(nd.E,{label:"Email address",children:(0,i.jsx)(aB.NI,{children:(0,i.jsx)(aW.I,{autoFocus:!0,...a,autoComplete:"off",disabled:P||R,placeholder:"Enter email address"})})})}}),(0,i.jsx)(ar.Z,{defaultVisibility:!1,title:"Single Sign-on (SSO) login option available",hideCollapse:!1,description:(0,i.jsxs)("div",{className:"space-y-4 mb-1",children:[(0,i.jsx)("p",{children:"Supabase offers single sign-on (SSO) as a login option to provide additional account security for your team. This allows company administrators to enforce the use of an identity provider when logging into Supabase."}),(0,i.jsx)("p",{children:"This is only available for organizations on Team Plan or above."}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(W.z,{asChild:!0,type:"default",children:(0,i.jsx)(M(),{href:"https://supabase.com/docs/guides/platform/sso",target:"_blank",rel:"noreferrer",children:"Learn more"})}),S&&((null==C?void 0:C.id)==="free"||(null==C?void 0:C.id)==="pro")&&(0,i.jsx)(W.z,{asChild:!0,type:"default",children:(0,i.jsx)(M(),{href:"/org/".concat(t,"/billing?panel=subscriptionPlan"),children:"Upgrade to Team"})})]})]})})]}),(0,i.jsx)(nn.P3,{}),(0,i.jsx)(nn.VO,{className:"pt-0",children:(0,i.jsx)(W.z,{block:!0,htmlType:"submit",loading:P||R,children:"Send invitation"})})]})})]})]})};var np=t(55446),nh=t(17747),nx=t(81384);function ng(e){let a=new Date(e);return!((new Date().valueOf()-a.valueOf())/1e3/60/60<24)}let nj=e=>{if(!e)return"";let{username:a,primary_email:t,invited_id:s}=e||{};return void 0!==s?t:a||""};async function nv(e){let{slug:a,id:t}=e,{error:s}=await (0,b.IV)("/platform/organizations/{slug}/members/invitations/{id}",{params:{path:{slug:a,id:t}}});return s&&(0,b.S3)(s),!0}let nf=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,I.D)(e=>nv(e),{async onSuccess(a,t,n){let{slug:i,skipInvalidation:r}=t;r||await Promise.all([s.invalidateQueries(s6.O.rolesV2(i)),s.invalidateQueries(w.O.members(i))]),await (null==e?void 0:e(a,t,n))},async onError(e,t,s){void 0===a?m.Am.error("Failed to delete invitation: ".concat(e.message)):a(e,t,s)},...t})};async function ny(e){let{slug:a,invitedId:t}=e,{data:s,error:n}=await (0,b.IV)("/platform/organizations/{slug}/members/invite",{params:{path:{slug:a},query:{invited_id:t}}});return n&&(0,b.S3)(n),s}let nb=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,I.D)(e=>ny(e),{async onSuccess(a,t,n){let{slug:i,invalidateDetail:r}=t;await Promise.all([...null==r||r?[s.invalidateQueries(w.O.members(i))]:[],s.invalidateQueries(w.O.roles(i))]),await (null==e?void 0:e(a,t,n))},async onError(e,t,s){void 0===a?m.Am.error("Failed to revoke invitation: ".concat(e.message)):a(e,t,s)},...t})};var nN=t(18149),nw=t.n(nN),n_=t(7117);async function nS(e){let{slug:a,gotrueId:t,roleId:s,projects:n}=e,i={role_id:s};void 0!==n&&(i.role_scoped_projects=n);let{data:r,error:l}=await (0,b.r$)("/platform/organizations/{slug}/members/{gotrue_id}",{params:{path:{slug:a,gotrue_id:t}},body:i,headers:{Version:"2"}});return l&&(0,b.S3)(l),r}let nC=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,I.D)(e=>nS(e),{async onSuccess(a,t,n){let{slug:i,skipInvalidation:r}=t;r||await Promise.all([s.invalidateQueries(s6.O.rolesV2(i)),s.invalidateQueries(w.O.members(i))]),await (null==e?void 0:e(a,t,n))},async onError(e,t,s){void 0===a?m.Am.error("Failed to update member role: ".concat(e.message)):a(e,t,s)},...t})};async function nI(e){let{slug:a,gotrueId:t,roleId:s}=e,{data:n,error:i}=await (0,b.IV)("/platform/organizations/{slug}/members/{gotrue_id}/roles/{role_id}",{params:{path:{slug:a,gotrue_id:t,role_id:s.toString()}}});return i&&(0,b.S3)(i),n}let nA=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,I.D)(e=>nI(e),{async onSuccess(a,t,n){let{slug:i,skipInvalidation:r}=t;r||await Promise.all([s.invalidateQueries(s6.O.rolesV2(i)),s.invalidateQueries(w.O.members(i))]),await (null==e?void 0:e(a,t,n))},async onError(e,t,s){void 0===a?m.Am.error("Failed to unassign member role: ".concat(e.message)):a(e,t,s)},...t})};async function nZ(e){let{slug:a,gotrueId:t,roleId:s,roleName:n,projects:i}=e,{data:r,error:l}=await (0,b.gz)("/platform/organizations/{slug}/members/{gotrue_id}/roles/{role_id}",{params:{path:{slug:a,gotrue_id:t,role_id:s.toString()}},body:{name:n,role_scoped_projects:i}});return l&&(0,b.S3)(l),r}let nz=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,C.NL)();return(0,I.D)(e=>nZ(e),{async onSuccess(a,t,n){let{slug:i,skipInvalidation:r}=t;r||await Promise.all([s.invalidateQueries(s6.O.rolesV2(i)),s.invalidateQueries(w.O.members(i))]),await (null==e?void 0:e(a,t,n))},async onError(e,t,s){void 0===a?m.Am.error("Failed to update member role: ".concat(e.message)):a(e,t,s)},...t})};var nE=t(3440),nk=t.n(nE);let nT=(e,a,t)=>{let{org_scoped_roles:s,project_scoped_roles:n}=a;return e.role_ids.map(e=>{let a=s.find(a=>a.id===e);if(void 0!==a)return{ref:void 0,roleId:a.id};let i=n.find(a=>a.id===e);if(void 0!==i){var r;return(null!==(r=null==i?void 0:i.project_ids)&&void 0!==r?r:[]).map(e=>t.find(a=>a.id===e)).map(e=>({ref:null==e?void 0:e.ref,projectId:null==e?void 0:e.id,roleId:i.id,baseRoleId:i.base_role_id}))}}).filter(Boolean).flat()},nP=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2?arguments[2]:void 0,s=[],n=[],i=[];return e.forEach(e=>{let t=a.find(a=>e.ref===a.ref);void 0===t?s.push(e):t.roleId!==e.roleId&&i.push({ref:t.ref,originalRole:e.roleId,originalBaseRole:e.baseRoleId,updatedRole:t.roleId})}),a.forEach(a=>{void 0===e.find(e=>a.ref===e.ref)&&n.push(a)}),{removed:s.map(e=>{var a;return{...e,projectId:null===(a=t.find(a=>a.ref===e.ref))||void 0===a?void 0:a.id}}),added:n.map(e=>{var a;return{...e,projectId:null===(a=t.find(a=>a.ref===e.ref))||void 0===a?void 0:a.id}}),updated:i.map(e=>{var a;return{...e,projectId:null===(a=t.find(a=>a.ref===e.ref))||void 0===a?void 0:a.id}})}},nO=(e,a)=>{let{removed:t,added:s,updated:n}=a,i=[],r=[],l=[],o=nk()(s,"roleId"),d=nk()(t,"roleId"),c=nk()(n,"originalRole"),u=nk()(n,"updatedRole"),m=e.filter(e=>{var a;return(null!==(a=null==e?void 0:e.project_ids)&&void 0!==a?a:[]).length>0}).map(e=>e.base_role_id);return e.forEach(e=>{var a,r,m,p,h,x,g,j;let v=e.project_ids;if(null===v)return i.push(e.id);let f=v.every(e=>{let a=t.map(e=>e.projectId).some(a=>a===e),s=n.map(e=>e.projectId).some(a=>a===e);return a||s}),y=s.some(a=>a.roleId===e.base_role_id),b=n.some(a=>a.updatedRole===e.base_role_id);if(f&&!y&&!b)return i.push(e.id);let N=null!==(h=null===(a=o[e.base_role_id])||void 0===a?void 0:a.map(e=>e.projectId))&&void 0!==h?h:[],w=null!==(x=null===(r=d[e.id])||void 0===r?void 0:r.map(e=>e.projectId))&&void 0!==x?x:[],_=null!==(g=null===(m=c[e.id])||void 0===m?void 0:m.map(e=>e.projectId))&&void 0!==g?g:[],S=null!==(j=null===(p=u[e.base_role_id])||void 0===p?void 0:p.map(e=>e.projectId))&&void 0!==j?j:[],C=v.filter(e=>!w.includes(e)).filter(e=>!_.includes(e)).concat(N).concat(S);nw()(v,C)||l.push({roleId:e.id,projectIds:C.sort((e,a)=>e-a)})}),Object.keys(o).forEach(e=>{m.includes(Number(e))||r.push({roleId:Number(e),projectIds:o[e].map(e=>e.projectId).sort((e,a)=>e-a)})}),Object.keys(u).forEach(e=>{m.includes(Number(e))||r.push({roleId:Number(e),projectIds:u[e].map(e=>e.projectId).sort((e,a)=>e-a)})}),{toRemove:i.sort((e,a)=>e-a),toAssign:r,toUpdate:l}},nR=e=>{var a;let{visible:t,member:s,projectsRoleConfiguration:n,onClose:l}=e,{slug:o}=(0,r.UO)(),d=(0,C.NL)(),c=(0,z.l)(),{data:p}=(0,ac.Sy)(),{data:h}=na({slug:null==c?void 0:c.slug}),[x,g]=(0,u.useState)(!1),{mutateAsync:j}=nC(),{mutateAsync:v}=nA({onError:()=>{}}),{mutateAsync:f}=nz(),y=null!==(a=null==h?void 0:h.org_scoped_roles)&&void 0!==a?a:[],{org_scoped_roles:b,project_scoped_roles:N}=null!=h?h:{org_scoped_roles:[],project_scoped_roles:[]},_=(null!=p?p:[]).filter(e=>e.organization_id===(null==c?void 0:c.id)),S=nP(void 0!==h?nT(s,h,null!=p?p:[]):[],n,null!=p?p:[]),I=async()=>{if(void 0===o)return console.error("Slug is required");g(!0);let e=s.gotrue_id,a=s.role_ids.map(e=>[...b,...N].find(a=>a.id===e)).filter(Boolean);if(1===n.length&&void 0===n[0].ref)try{await j({slug:o,gotrueId:e,roleId:n[0].roleId}),m.Am.success("Successfully updated role for ".concat(s.username)),l(!0);return}catch(e){return g(!1),m.Am.error("Failed to update role: ".concat(e.message))}let{toRemove:t,toAssign:i,toUpdate:r}=nO(a,S);try{await Promise.all([...i.map(a=>{let{roleId:t,projectIds:s}=a;return j({slug:o,gotrueId:e,roleId:t,projects:s.map(e=>{var a;return null==p?void 0:null===(a=p.find(a=>a.id===e))||void 0===a?void 0:a.ref})})})]),await Promise.all([...t.map(a=>v({slug:o,gotrueId:e,roleId:a})),...r.map(a=>{var t;let{roleId:s,projectIds:n}=a;return f({slug:o,gotrueId:e,roleId:s,roleName:null===(t=N.find(e=>e.id===s))||void 0===t?void 0:t.name,projects:n.map(e=>{var a;return null==p?void 0:null===(a=p.find(a=>a.id===e))||void 0===a?void 0:a.ref})})})]),await Promise.all([d.invalidateQueries(s6.O.rolesV2(o)),d.invalidateQueries(w.O.members(o))]),m.Am.success("Successfully updated role for ".concat(s.username)),l(!0)}catch(e){return g(!1),m.Am.error("Failed to update role: ".concat(e.message))}};return(0,i.jsx)(s1.Z,{size:"medium",visible:t,loading:x,title:"Confirm to change roles of member",confirmLabel:"Update roles",confirmLabelLoading:"Updating",onCancel:()=>l(),onConfirm:I,children:(0,i.jsxs)("div",{className:"flex flex-col gap-y-3",children:[(0,i.jsxs)("p",{className:"text-sm text-foreground-light",children:["You are making the following changes to the role of"," ",(0,i.jsx)("span",{className:"text-foreground",children:s.username})," in the organization"," ",(0,i.jsx)("span",{className:"text-foreground",children:null==c?void 0:c.name}),":"]}),(0,i.jsxs)("div",{className:"flex flex-col gap-y-2",children:[0!==S.removed.length&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{className:"text-sm",children:["Removing ",S.removed.length," role",S.removed.length>1?"s":""," for user:"]}),(0,i.jsx)("ul",{className:"list-disc pl-6",children:S.removed.map((e,a)=>{var t,s,n;let r=null!==(t=b.find(a=>a.id===e.roleId))&&void 0!==t?t:N.find(a=>a.id===e.roleId),l=_.find(a=>a.ref===e.ref),o=(null!==(s=null==r?void 0:r.name)&&void 0!==s?s:"Unknown").split("_")[0];return(0,i.jsxs)("li",{className:"text-sm text-foreground-light",children:[(0,i.jsx)("span",{className:"text-foreground",children:o})," on"," ",(0,i.jsx)("span",{className:void 0!==l?"text-foreground":"",children:null!==(n=null==l?void 0:l.name)&&void 0!==n?n:"organization"})]},"update-".concat(a))})})]}),0!==S.added.length&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{className:"text-sm",children:["Adding ",S.added.length," role",S.added.length>1?"s":""," for user:"]}),(0,i.jsx)("ul",{className:"list-disc pl-6",children:S.added.map((e,a)=>{var t;let s=y.find(a=>a.id===e.roleId),n=_.find(a=>a.ref===e.ref);return(0,i.jsxs)("li",{className:"text-sm text-foreground-light",children:[(0,i.jsx)("span",{className:"text-foreground",children:null==s?void 0:s.name})," on"," ",(0,i.jsx)("span",{className:void 0!==n?"text-foreground":"",children:null!==(t=null==n?void 0:n.name)&&void 0!==t?t:"organization"})]},"update-".concat(a))})})]}),0!==S.updated.length&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("p",{className:"text-sm",children:["Updating ",S.updated.length," role",S.updated.length>1?"s":""," for user:"]}),(0,i.jsx)("ul",{className:"list-disc pl-6",children:S.updated.map((e,a)=>{var t,s,n;let r=null!==(t=b.find(a=>a.id===e.originalRole))&&void 0!==t?t:N.find(a=>a.id===e.originalRole),l=b.find(a=>a.id===e.updatedRole),o=_.find(a=>a.ref===e.ref),d=(null!==(s=null==r?void 0:r.name)&&void 0!==s?s:"Unknown").split("_")[0];return(0,i.jsxs)("li",{className:"text-sm text-foreground-light",children:["From ",(0,i.jsx)("span",{className:"text-foreground",children:d})," to"," ",(0,i.jsx)("span",{className:"text-foreground",children:null==l?void 0:l.name})," on"," ",(0,i.jsx)("span",{className:void 0!==o?"text-foreground":"",children:null!==(n=null==o?void 0:o.name)&&void 0!==n?n:"organization"})]},"update-".concat(a))})})]})]}),(0,i.jsx)("p",{className:"text-sm text-foreground",children:"By changing the role of this member their permissions will change."})]})})},nD=e=>{var a,t,s,n;let{visible:l,member:o,onClose:c}=e,{slug:m}=(0,r.UO)(),p=(0,z.l)(),h=(0,d.Tt)(m),{data:x}=(0,ac.Sy)(),{data:g}=(0,s2.j)(),{data:j,isSuccess:v}=na({slug:m}),f=null!==(s=null==j?void 0:j.org_scoped_roles)&&void 0!==s?s:[],y=null!==(n=null==j?void 0:j.project_scoped_roles)&&void 0!==n?n:[],{rolesAddable:b,rolesRemovable:N}=nc(null==p?void 0:p.slug,f.concat(y),null!=g?g:[]),w=f.every(e=>!b.includes(e.id)),[_,S]=(0,u.useState)(!1),[C,I]=(0,u.useState)(!1),[A,Z]=(0,u.useState)([]),E=void 0!==j?nT(o,j,null!=x?x:[]):[],k=(null!=x?x:[]).filter(e=>e.organization_id===(null==p?void 0:p.id)),T=1===A.length&&(null===(a=A[0])||void 0===a?void 0:a.ref)===void 0,P=A.length>0,O=null===(t=f.find(e=>"Developer"===e.name))||void 0===t?void 0:t.id;["Owner","Administrator","Developer"].reduce((e,a,t)=>({...e,[a]:t}),{});let R=k.filter(e=>!A.some(a=>a.ref===e.ref)),D=k.length-R.length,L=E.length!==R.length,M=e=>{Z(A.concat({ref:e,roleId:null!=O?O:f[0].id})),I(!1)},U=e=>{void 0!==e&&Z(A.filter(a=>a.ref!==e))},F=(e,a)=>{void 0!==a.ref?Z(A.map(t=>t.ref===a.ref?{ref:t.ref,projectId:t.projectId,roleId:Number(e)}:t)):Z([{ref:void 0,roleId:Number(e)}])};return(0,u.useEffect)(()=>{l&&v&&Z(nT(o,j,null!=x?x:[]))},[l,v]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n_.yo,{open:l,onOpenChange:()=>c(),children:(0,i.jsx)(n_.ue,{showClose:!1,size:"default",className:(0,eA.cn)("bg-surface-200 p-0 flex flex-row gap-0 !min-w-[400px]"),children:(0,i.jsxs)("div",{className:(0,eA.cn)("flex flex-col grow w-full"),children:[(0,i.jsxs)(n_.Tu,{className:(0,eA.cn)("py-3 flex flex-row justify-between gap-x-4 items-center border-b"),children:[(0,i.jsxs)("p",{className:"truncate",title:"Manage access for ".concat(o.username),children:["Manage access for ",o.username]}),(0,i.jsx)(W.z,{asChild:!0,type:"default",icon:(0,i.jsx)(eo.Z,{}),children:(0,i.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://supabase.com/docs/guides/platform/access-control",children:"Documentation"})})]}),(0,i.jsxs)(n_.DN,{className:"h-full overflow-auto flex flex-col gap-y-4",children:[h&&(0,i.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,i.jsx)(ni.r,{disabled:w,checked:T,onCheckedChange:()=>{var e,a,t;let s=null!==(t=null!==(a=null===(e=A[0])||void 0===e?void 0:e.roleId)&&void 0!==a?a:O)&&void 0!==t?t:f[0].id;T?Z(k.map(e=>({ref:e.ref,projectId:e.id,roleId:s}))):Z([{ref:void 0,roleId:s}])}}),(0,i.jsx)("p",{className:"text-sm",children:"Apply roles to all projects in the organization"})]}),0===A.length&&(0,i.jsxs)(ey.bZ,{children:[(0,i.jsx)(e7.aN,{}),(0,i.jsx)(ey.Cd,{children:"Team members need to be assigned at least one role"}),(0,i.jsx)(ey.X,{children:"You may not remove all roles from a team member"})]}),!T&&A.length>0&&A.length!==k.length&&(0,i.jsxs)(ey.bZ,{children:[(0,i.jsx)(ey.Cd,{children:L?"This member will only have access to ".concat(D," project").concat(D>1?"s":""):"This member only has access to ".concat(D," project").concat(D>1?"s":"")}),(0,i.jsxs)(ey.X,{children:[o.username," ",L?"will":"does"," not have access to the following ",R.length," project",R.length>1?"s":"",":",(0,i.jsx)("ul",{className:"list-disc pl-6",children:R.map(e=>(0,i.jsx)("li",{children:e.name},e.id))})]})]}),(0,i.jsx)("div",{className:"flex flex-col gap-y-2",children:A.sort((e,a)=>{var t,s;return(null!==(t=null==e?void 0:e.projectId)&&void 0!==t?t:0)-(null!==(s=null==a?void 0:a.projectId)&&void 0!==s?s:0)}).map(e=>{var a,t,s,n,r;let l=void 0===e.ref?"All projects":null==x?void 0:null===(a=x.find(a=>a.ref===e.ref))||void 0===a?void 0:a.name,o=f.find(a=>void 0!==e.baseRoleId?a.id===e.baseRoleId:a.id===e.roleId),d=N.includes(null!==(t=null==o?void 0:o.id)&&void 0!==t?t:0);return(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("p",{className:"text-sm",children:l}),(0,i.jsxs)("div",{className:"flex items-center gap-x-2",children:[w?(0,i.jsxs)(sk.u,{children:[(0,i.jsx)(sk.aJ,{asChild:!0,children:(0,i.jsx)("div",{className:"flex items-center justify-between rounded-md border border-button bg-button px-3 py-2 text-sm h-10 w-56 text-foreground-light",children:null!==(s=null==o?void 0:o.name)&&void 0!==s?s:"Unknown"})}),(0,i.jsx)(sk._v,{side:"bottom",children:"Additional permissions required to update role"})]}):(0,i.jsxs)(aV.Ph,{value:(null!==(n=null==e?void 0:e.baseRoleId)&&void 0!==n?n:e.roleId).toString(),onValueChange:a=>F(a,e),children:[(0,i.jsx)(aV.i4,{className:(0,eA.cn)("text-sm h-10 w-56",(null==o?void 0:o.name)===void 0&&"text-foreground-light"),children:null!==(r=null==o?void 0:o.name)&&void 0!==r?r:"Please select a role"}),(0,i.jsx)(aV.Bw,{children:(0,i.jsx)(aV.DI,{children:(null!=f?f:[]).map(e=>{let a=b.includes(e.id);return(0,i.jsx)(aV.Ql,{value:e.id.toString(),className:"text-sm",disabled:!a,children:e.name},e.id)})})})]}),!T&&(0,i.jsxs)(sk.u,{children:[(0,i.jsx)(sk.aJ,{asChild:!0,children:(0,i.jsx)(W.z,{type:"text",disabled:!d,className:"px-1",icon:(0,i.jsx)(aK.Z,{}),onClick:()=>U(null==e?void 0:e.ref)})}),!d&&(0,i.jsx)(sk._v,{side:"bottom",children:"Additional permission required to remove role from member"})]})]})]},"".concat(e.ref,"-").concat(e.roleId))})}),!T&&(0,i.jsxs)(nr.J2,{open:C,onOpenChange:I,modal:!1,children:[(0,i.jsx)(nr.xo,{asChild:!0,children:(0,i.jsx)(W.z,{type:"default",className:"w-min",children:"Add project"})}),(0,i.jsx)(nr.yk,{className:"p-0",side:"bottom",align:"start",children:(0,i.jsxs)(nl.mY,{children:[(0,i.jsx)(nl.sZ,{placeholder:"Find project..."}),(0,i.jsxs)(nl.e8,{children:[(0,i.jsx)(nl.rb,{children:"No projects found"}),(0,i.jsx)(nl.fu,{children:(0,i.jsx)(no.x,{className:(x||[]).length>7?"h-[210px]":"",children:k.map(e=>{let a=A.some(a=>a.ref===e.ref);return(0,i.jsxs)(nl.di,{disabled:a,className:"cursor-pointer w-full justify-between",onSelect:()=>M(e.ref),onClick:()=>M(e.ref),children:[(0,i.jsx)("p",{className:"truncate",children:e.name}),a&&(0,i.jsx)("p",{className:"w-[45%] text-right",children:"Already assigned"})]},e.ref)})})})]})]})})]})]}),(0,i.jsxs)(n_.FF,{className:"flex items-center !justify-end px-5 py-4 w-full border-t",children:[(0,i.jsx)(W.z,{type:"default",disabled:!1,onClick:()=>c(),children:"Cancel"}),(0,i.jsx)(W.z,{loading:!1,disabled:!P,onClick:()=>{nw()(A,E)?c():S(!0)},children:"Save roles"})]})]})})}),(0,i.jsx)(nR,{visible:_,member:o,projectsRoleConfiguration:A,onClose:e=>{S(!1),e&&c()}})]})},nL=e=>{var a,t,s,n,l;let{member:p}=e,{slug:h}=(0,r.UO)(),{profile:x}=(0,tZ.Un)(),[g,j]=(0,u.useState)(!1),[v,f]=(0,u.useState)(!1),y=(0,o.N)("organization_members:delete"),b=(0,z.l)(),{data:w}=(0,s2.j)(),{data:_}=(0,ac.Sy)(),{data:S}=sp({slug:h}),{data:C}=na({slug:h}),I=(0,d.Tt)(h),A=null!==(t=null==C?void 0:C.org_scoped_roles)&&void 0!==t?t:[],Z=null!==(s=null==C?void 0:C.project_scoped_roles)&&void 0!==s?s:[],E=!!p.invited_id,k=null==S?void 0:S.find(e=>e.gotrue_id===(null==x?void 0:x.gotrue_id)),T=1===(null!==(n=null==k?void 0:k.role_ids)&&void 0!==n?n:[]).length&&A.some(e=>e.id===(null==k?void 0:k.role_ids[0])),{rolesRemovable:P}=nc(null==b?void 0:b.slug,A.concat(Z),null!=w?w:[]),O=null!==(l=null===(a=p.role_ids)||void 0===a?void 0:a[0])&&void 0!==l?l:-1,R=p.role_ids.every(e=>P.includes(e)),D=(0,N.Xo)(c.KA.CREATE,"user_invites",{resource:{role_id:O}})&&T,L=(0,N.Xo)(c.KA.DELETE,"user_invites",{resource:{role_id:O}})&&T,{mutate:M,isLoading:U}=s0({onSuccess:()=>{m.Am.success("Successfully removed ".concat(p.primary_email)),f(!1)}}),{mutate:F,isLoading:Y}=s7({onSuccess:()=>{m.Am.success("Resent the invitation.")},onError:e=>{m.Am.error("Failed to resend invitation: ".concat(e.message))}}),{mutate:G,isLoading:B}=ns({onSuccess:()=>{m.Am.success("Resent the invitation")},onError:e=>{m.Am.error("Failed to resend the invidation: ".concat(e.message))}}),{mutate:V,isLoading:q}=nf(),{mutate:H}=nb(),X=U||q||Y,K=()=>h?p.gotrue_id?void M({slug:h,gotrueId:p.gotrue_id}):console.error("gotrue_id is required"):console.error("slug is required"),Q=e=>{var a;let t=(null!==(a=null==e?void 0:e.role_ids)&&void 0!==a?a:[])[0],s=e.invited_id;return h?s?void(I?V({slug:h,id:s,skipInvalidation:!0},{onSuccess:()=>{if(!e.primary_email)return m.Am.error("Email is required");let a=Z.find(e=>e.id===t);if(void 0!==a){var s;let t=(null!==(s=null==a?void 0:a.project_ids)&&void 0!==s?s:[]).map(e=>{var a;return null==_?void 0:null===(a=_.find(a=>a.id===e))||void 0===a?void 0:a.ref}).filter(Boolean);F({slug:h,email:e.primary_email,roleId:a.base_role_id,projects:t})}else F({slug:h,email:e.primary_email,roleId:t})}}):H({slug:h,invitedId:s,invalidateDetail:!1},{onSuccess:()=>{G({slug:h,invitedEmail:e.primary_email,ownerId:s,roleId:t})}})):console.error("Member invited ID is required"):console.error("Slug is required")},J=e=>{let a=e.invited_id;return h?a?void(I?V({slug:h,id:a},{onSuccess:()=>m.Am.success("Successfully revoked the invitation.")}):H({slug:h,invitedId:a},{onSuccess:()=>m.Am.success("Successfully revoked the invitation.")})):console.error("Member invited ID is required"):console.error("Slug is required")};return R&&(!E||D||L)?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex items-center justify-end gap-x-2",children:[(0,i.jsx)(ai.u,{type:"default",disabled:E||!R,onClick:()=>j(!0),tooltip:{content:{side:"bottom",text:E?"Role can only be changed after the user has accepted the invite":R?void 0:"You need additional permissions to manage this team member"}},children:"Manage access"}),(0,i.jsxs)(e0.h_,{children:[(0,i.jsx)(e0.$F,{asChild:!0,children:(0,i.jsx)(W.z,{type:"text",className:"px-1.5",disabled:X,loading:X,icon:(0,i.jsx)(sz.Z,{})})}),(0,i.jsx)(e0.AW,{side:"bottom",align:"end",children:(0,i.jsx)(i.Fragment,{children:E?(0,i.jsxs)(i.Fragment,{children:[L&&(0,i.jsx)(e0.Xi,{onClick:()=>J(p),children:(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("p",{children:"Cancel invitation"}),(0,i.jsx)("p",{className:"text-foreground-lighter",children:"Revoke this invitation."})]})}),D&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e0.VD,{}),(0,i.jsx)(e0.Xi,{onClick:()=>Q(p),children:(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("p",{children:"Resend invitation"}),(0,i.jsx)("p",{className:"text-foreground-lighter",children:"Invites expire after 24hrs."})]})})]})]}):y&&(0,i.jsxs)(e0.Xi,{className:"space-x-2 items-start",disabled:!R,onClick:()=>{f(!0)},children:[(0,i.jsx)(sw.Z,{size:16}),(0,i.jsxs)("div",{className:"flex flex-col",children:[(0,i.jsx)("p",{children:"Remove member"}),!R&&(0,i.jsx)("p",{className:"text-foreground-lighter",children:"Additional permissions required"})]})]})})})]})]}),(0,i.jsx)(s1.Z,{visible:v,loading:U,title:"Confirm to remove",confirmLabel:"Remove",onCancel:()=>f(!1),onConfirm:()=>{K()},children:(0,i.jsxs)("p",{className:"text-sm text-foreground-light",children:["This is permanent! Are you sure you want to remove ",p.primary_email]})}),(0,i.jsx)(nD,{visible:g,member:p,onClose:()=>j(!1)})]}):(0,i.jsx)("div",{className:"flex items-center justify-end",children:(0,i.jsx)(ai.u,{disabled:!0,type:"text",className:"px-1.5",icon:(0,i.jsx)(sz.Z,{size:18}),tooltip:{content:{side:"bottom",text:"You need additional permissions to manage this team member"}}})})};var nM=t(64725);let nU={vercel:"vercel-marketplace"},nF=e=>{var a,t,s;let{member:n}=e,{slug:l}=(0,r.UO)(),{profile:o}=(0,tZ.Un)(),{data:c}=(0,ac.Sy)(),m=(0,z.l)(),[p,h]=(0,u.useState)(!1),x=(0,d.Tt)(l),{data:g,isLoading:j}=na({slug:null==m?void 0:m.slug}),v=n.gotrue_id==(null==o?void 0:o.gotrue_id),f=!!n.invited_id,y=n.username===n.primary_email,b=!!(null===(a=n.primary_email)||void 0===a?void 0:a.endsWith("customer.fly.io")),N=n.role_ids.filter(e=>{var a,t,s;let n=[...null!==(a=null==g?void 0:g.org_scoped_roles)&&void 0!==a?a:[],...null!==(t=null==g?void 0:g.project_scoped_roles)&&void 0!==t?t:[]].find(a=>a.id===e);return(null==n?void 0:n.project_ids)!==null&&0===(null!==(s=null==n?void 0:n.project_ids)&&void 0!==s?s:[]).map(e=>{var a,t;return null!==(t=null==c?void 0:null===(a=c.find(a=>a.id===e))||void 0===a?void 0:a.name)&&void 0!==t?t:""}).filter(e=>e.length>0).length}).length>0;return(0,i.jsxs)(eN.Z.tr,{children:[(0,i.jsx)(eN.Z.td,{children:(0,i.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,i.jsx)("div",{children:f||y||b||p?(0,i.jsx)("div",{className:"w-[40px] h-[40px] bg-surface-100 border border-overlay rounded-full text-foreground-lighter flex items-center justify-center",children:(0,i.jsx)(ss.Z,{size:20,strokeWidth:1.5})}):(0,i.jsx)(si(),{alt:n.username,src:"https://github.com/".concat(n.username,".png?size=80"),width:"40",height:"40",className:"border rounded-full",onError:()=>{h(!0)}})}),(0,i.jsxs)("div",{className:"flex item-center gap-x-2",children:[void 0===f?(0,i.jsx)("p",{className:"text-foreground-light truncate",children:n.primary_email}):(0,i.jsx)("p",{className:"text-foreground truncate",children:nj(n)}),n.primary_email===(null==o?void 0:o.primary_email)&&(0,i.jsx)(ek.C,{color:"scale",children:"You"})]}),(null===(t=n.metadata)||void 0===t?void 0:t.origin)&&(0,i.jsx)(nM.Z,{organization:{managed_by:null!==(s=nU[n.metadata.origin])&&void 0!==s?s:"supabase"},tooltipText:"This user is managed by Vercel Marketplace."})]})}),(0,i.jsx)(eN.Z.td,{children:f&&n.invited_at&&(0,i.jsx)(ek.C,{variant:ng(n.invited_at)?"destructive":"warning",children:ng(n.invited_at)?"Expired":"Invited"})}),(0,i.jsx)(eN.Z.td,{children:(0,i.jsx)("div",{className:"flex items-center justify-center",children:n.mfa_enabled?(0,i.jsx)(at.Z,{className:"text-brand",strokeWidth:2,size:20}):(0,i.jsx)(aK.Z,{className:"text-foreground-light",strokeWidth:1.5,size:20})})}),(0,i.jsx)(eN.Z.td,{className:"max-w-64",children:j?(0,i.jsx)(nx.Z,{className:"w-32"}):N?(0,i.jsx)(nh.Z,{strokeWidth:1.5,size:20}):n.role_ids.map(e=>{var a,t,s,n,r;let l=(null!==(a=null==g?void 0:g.org_scoped_roles)&&void 0!==a?a:[]).find(a=>a.id===e),o=(null!==(t=null==g?void 0:g.project_scoped_roles)&&void 0!==t?t:[]).find(a=>a.id===e),d=l||o,u=(null!==(s=null==d?void 0:d.name)&&void 0!==s?s:"").split("_")[0],m=(null==d?void 0:d.project_ids)===null?null!==(n=null==c?void 0:c.map(e=>e.name))&&void 0!==n?n:[]:(null!==(r=null==d?void 0:d.project_ids)&&void 0!==r?r:[]).map(e=>{var a,t;return null!==(t=null==c?void 0:null===(a=c.find(a=>a.id===e))||void 0===a?void 0:a.name)&&void 0!==t?t:""}).filter(e=>e.length>0);return(0,i.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,i.jsx)("p",{children:u}),x&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{children:""}),1===m.length?(0,i.jsx)("span",{className:"text-foreground truncate",title:m[0],children:m[0]}):(0,i.jsxs)(sk.u,{children:[(0,i.jsx)(sk.aJ,{asChild:!0,children:(0,i.jsx)("span",{className:"text-foreground",children:(null==d?void 0:d.project_ids)===null?"Organization":"".concat(m.length," project").concat(m.length>1?"s":"")})}),(null==d?void 0:d.project_ids)!==null&&m.length>1&&(0,i.jsxs)(sk._v,{side:"bottom",className:"flex flex-col gap-y-1",children:[null==m?void 0:m.slice(0,2).map(e=>(0,i.jsx)("span",{children:e},e)),m.length>2&&(0,i.jsxs)("span",{children:["And ",m.length-2," other project",m.length>4?"s":""]})]})]})]})]},"role-".concat(e))})}),(0,i.jsx)(eN.Z.td,{children:!v&&(0,i.jsx)(nL,{member:n})})]})};var nY=e=>{let{searchString:a}=e,{slug:t}=(0,r.UO)(),{profile:s}=(0,tZ.Un)(),{data:n,error:l,isLoading:o,isError:d,isSuccess:c}=sp({slug:t}),{error:u,isError:m}=na({slug:t}),h=null!=n?n:[],x=(a?h.filter(e=>{var t,s;return e.invited_at?null===(t=e.primary_email)||void 0===t?void 0:t.includes(a):e.gotrue_id?e.username.includes(a)||(null===(s=e.primary_email)||void 0===s?void 0:s.includes(a)):void 0}):h).slice().sort((e,a)=>e.primary_email===(null==s?void 0:s.primary_email)?-1:e.username.localeCompare(a.username));return(0,i.jsxs)(i.Fragment,{children:[o&&(0,i.jsx)(f.A,{}),d&&(0,i.jsx)(p.Z,{error:l,subject:"Failed to retrieve organization members"}),m&&(0,i.jsx)(p.Z,{error:u,subject:"Failed to retrieve organization roles"}),c&&(0,i.jsx)("div",{className:"rounded w-full",children:(0,i.jsx)(np.Z,{active:!x,children:(0,i.jsx)(eN.Z,{head:[(0,i.jsx)(eN.Z.th,{children:"User"},"header-user"),(0,i.jsx)(eN.Z.th,{className:"w-24"},"header-status"),(0,i.jsx)(eN.Z.th,{className:"text-center w-32",children:"Enabled MFA"},"header-mfa"),(0,i.jsxs)(eN.Z.th,{className:"flex items-center space-x-1",children:[(0,i.jsx)("span",{children:"Role"}),(0,i.jsxs)(sk.u,{children:[(0,i.jsx)(sk.aJ,{asChild:!0,children:(0,i.jsx)(W.z,{asChild:!0,type:"text",className:"px-1",children:(0,i.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://supabase.com/docs/guides/platform/access-control",children:(0,i.jsx)(t_.Z,{size:14,className:"text-foreground-light"})})})}),(0,i.jsx)(sk._v,{side:"bottom",children:"How to configure access control?"})]})]},"header-role"),(0,i.jsx)(eN.Z.th,{},"header-action")],body:[...x.map(e=>(0,i.jsx)(nF,{member:e},e.gotrue_id)),...a.length>0&&0===x.length?[(0,i.jsx)(eN.Z.tr,{className:"bg-panel-secondary-light",children:(0,i.jsx)(eN.Z.td,{colSpan:12,children:(0,i.jsxs)("div",{className:"flex items-center space-x-3 opacity-75",children:[(0,i.jsx)(aZ.Z,{size:16,strokeWidth:2}),(0,i.jsxs)("p",{className:"text-foreground-light",children:['No users matched the search query "',a,'"']})]})})},"no-results")]:[],(0,i.jsx)(eN.Z.tr,{className:"bg-panel-secondary-light",children:(0,i.jsx)(eN.Z.td,{colSpan:12,children:(0,i.jsxs)("p",{className:"text-foreground-light",children:[a?"".concat(x.length," of "):"",h.length||"0"," ",1==h.length?"user":"users"]})})},"footer")]})})})]})},nG=()=>{var e;let{slug:a}=(0,r.UO)(),{organizationMembersCreate:t,organizationMembersDelete:s}=(0,o.N)(["organization_members:create","organization_members:delete"]),{profile:n}=(0,tZ.Un)(),d=(0,z.l)(),c=null==d?void 0:d.is_owner,{data:p}=(0,s2.j)(),{data:h}=sx({slug:a}),{data:x}=sp({slug:a}),g=null!==(e=null==h?void 0:h.roles)&&void 0!==e?e:[],{rolesAddable:j}=nc(null==d?void 0:d.slug,g,null!=p?p:[]),[v,f]=(0,u.useState)(!1),[y,b]=(0,u.useState)(""),N=j.length>0,w=!c||c&&nu(x,g),{mutate:_}=s0({onSuccess:()=>{var e;f(!1),C(!1),null===(e=window)||void 0===e||e.location.replace("/")},onError:e=>{f(!1),m.Am.error("Failed to leave organization: ".concat(null==e?void 0:e.message))}}),[S,C]=(0,u.useState)(!1),I=async()=>{if(!a)return console.error("Org slug is required");f(!0),_({slug:a,gotrueId:n.gotrue_id})};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.gW,{children:(0,i.jsxs)(l.tM,{children:[(0,i.jsxs)(l.Wv,{className:"justify-between",children:[(0,i.jsx)(k.Z,{icon:(0,i.jsx)(sJ.Z,{size:12}),size:"small",value:y,onChange:e=>b(e.target.value),name:"email",id:"email",placeholder:"Filter members"}),(0,i.jsxs)(l.ur,{children:[t&&N&&void 0!==n&&void 0!==d&&(0,i.jsx)(nm,{}),s&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(ai.u,{type:"default",loading:v,disabled:!w,tooltip:{content:{side:"bottom",text:w?void 0:"An organization requires at least 1 owner"}},onClick:()=>C(!0),children:"Leave team"})})]})]}),(0,i.jsx)(l.Lc,{className:"w-full",children:(0,i.jsx)(nY,{searchString:y})})]})}),(0,i.jsx)(s1.Z,{visible:S,title:"Are you sure?",confirmLabel:"Leave",onCancel:()=>C(!1),onConfirm:()=>{I()},children:(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"Are you sure you want to leave this organization? This is permanent."})})]})},nB=()=>(0,i.jsxs)(l.jX,{children:[(0,i.jsxs)(l.g$,{className:"sticky space-y-6 top-12",children:[(0,i.jsx)("p",{className:"text-base m-0",children:"Data Processing Addendum (DPA)"}),(0,i.jsxs)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:[(0,i.jsx)("p",{children:"All organizations can access and use our DPA as part of their GDPR compliance. This is only to access the document. Please ignore this if you have sent the signed document to us."}),(0,i.jsxs)("p",{children:["Please review these details and add data specific to user processing where required. Sign and return the signed DPA document to"," ",(0,i.jsx)("a",{href:"mailto:privacy@supabase.com",target:"_blank",className:"text-brand hover:text-brand",children:"privacy@supabase.com"})," ","for the document to be considered executed."]})]})]}),(0,i.jsx)(l.Lc,{className:"flex items-center justify-center h-full",children:(0,i.jsx)("a",{href:"https://supabase.com/downloads/docs/Supabase+DPA+231211.pdf",target:"_blank",rel:"noreferrer noopener",download:!0,children:(0,i.jsx)(W.z,{type:"default",iconRight:(0,i.jsx)(eo.Z,{}),children:"View DPA"})})})]}),nV=()=>(0,i.jsxs)(l.jX,{children:[(0,i.jsxs)(l.g$,{className:"sticky space-y-6 top-12",children:[(0,i.jsx)("p",{className:"text-base m-0",children:"Transfer Impact Assessment (TIA)"}),(0,i.jsx)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:(0,i.jsx)("p",{children:"All organizations can access and use our TIA as part of their GDPR-compliant data transfer process."})})]}),(0,i.jsx)(l.Lc,{className:"flex items-center justify-center h-full",children:(0,i.jsx)("a",{href:"https://supabase.com/downloads/docs/Supabase+TIA+240804.pdf",target:"_blank",rel:"noreferrer noopener",download:!0,children:(0,i.jsx)(W.z,{type:"default",iconRight:(0,i.jsx)(eo.Z,{}),children:"View TIA"})})})]});async function nW(e,a){let{orgSlug:t,docType:s}=e;if(!t)throw Error("orgSlug is required");if("standard-security-questionnaire"===s){let{data:e,error:s}=await (0,b.U2)("/platform/organizations/{slug}/documents/standard-security-questionnaire",{params:{path:{slug:t}},signal:a});return s&&(0,b.S3)(s),e}if("soc2-type-2-report"===s){let{data:e,error:s}=await (0,b.U2)("/platform/organizations/{slug}/documents/soc2-type-2-report",{params:{path:{slug:t}},signal:a});if(s)throw s;return e}}var nq=()=>{let{slug:e}=(0,r.UO)(),a=(0,N.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),{data:t,error:s,isLoading:n,isError:o,isSuccess:u}=(0,d.Gl)({orgSlug:e},{enabled:a}),h=null==t?void 0:t.plan,x=async e=>{try{let a=await nW({orgSlug:e,docType:"standard-security-questionnaire"});(null==a?void 0:a.fileUrl)&&window.open(a.fileUrl,"_blank")}catch(e){m.Am.error("Failed to download Security Questionnaire: ".concat(e.message))}};return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(l.jX,{children:[(0,i.jsxs)(l.g$,{className:"sticky space-y-6 top-12",children:[(0,i.jsx)("p",{className:"text-base m-0",children:"Standard Security Questionnaire"}),(0,i.jsx)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:(0,i.jsx)("p",{children:"Organizations on Team Plan or above have access to our standard security questionnaire."})})]}),(0,i.jsx)(l.Lc,{children:a?(0,i.jsxs)(i.Fragment,{children:[n&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(f.Z,{}),(0,i.jsx)(f.Z,{className:"w-3/4"}),(0,i.jsx)(f.Z,{className:"w-1/2"})]}),o&&(0,i.jsx)(p.Z,{subject:"Failed to retrieve subscription",error:s}),u&&(0,i.jsx)("div",{className:"flex items-center justify-center h-full",children:(null==h?void 0:h.id)==="free"||(null==h?void 0:h.id)==="pro"?(0,i.jsx)(M(),{href:"/org/".concat(e,"/billing?panel=subscriptionPlan"),children:(0,i.jsx)(W.z,{type:"default",children:"Upgrade to Team"})}):(0,i.jsx)(W.z,{type:"default",icon:(0,i.jsx)(tb.Z,{}),onClick:()=>{e&&x(e)},children:"Download Questionnaire"})})]}):(0,i.jsx)(j.Z,{resourceText:"access our security questionnaire"})})]})})},nH=()=>{let{slug:e}=(0,r.UO)(),a=(0,N.Xo)(c.KA.BILLING_READ,"stripe.subscriptions"),{data:t,error:s,isLoading:n,isError:o,isSuccess:h}=(0,d.Gl)({orgSlug:e},{enabled:a}),x=null==t?void 0:t.plan,[g,v]=(0,u.useState)(!1),y=async e=>{try{let a=await nW({orgSlug:e,docType:"soc2-type-2-report"});(null==a?void 0:a.fileUrl)&&window.open(a.fileUrl,"_blank"),v(!1)}catch(e){m.Am.error("Failed to download SOC2 report: ".concat(e.message))}};return(0,i.jsxs)(l.jX,{children:[(0,i.jsxs)(l.g$,{className:"sticky space-y-6 top-12",children:[(0,i.jsx)("p",{className:"text-base m-0",children:"SOC2 Type 2"}),(0,i.jsx)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:(0,i.jsx)("p",{children:"Organizations on Team Plan or above have access to our most recent SOC2 Type 2 report."})})]}),(0,i.jsxs)(l.Lc,{children:[a?(0,i.jsxs)(i.Fragment,{children:[n&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(f.Z,{}),(0,i.jsx)(f.Z,{className:"w-3/4"}),(0,i.jsx)(f.Z,{className:"w-1/2"})]}),o&&(0,i.jsx)(p.Z,{subject:"Failed to retrieve subscription",error:s}),h&&(0,i.jsx)("div",{className:"flex items-center justify-center h-full",children:(null==x?void 0:x.id)==="free"||(null==x?void 0:x.id)==="pro"?(0,i.jsx)(M(),{href:"/org/".concat(e,"/billing?panel=subscriptionPlan"),children:(0,i.jsx)(W.z,{type:"default",children:"Upgrade to Team"})}):(0,i.jsx)(W.z,{type:"default",icon:(0,i.jsx)(tb.Z,{}),onClick:()=>v(!0),children:"Download SOC2 Type 2 Report"})})]}):(0,i.jsx)(j.Z,{resourceText:"access our SOC2 Type 2 report"}),(0,i.jsx)(s1.Z,{visible:g,size:"large",title:"Non-Disclosure Agreement to access Supabase's SOC2 Report",confirmLabel:"I agree",confirmLabelLoading:"Downloading",onCancel:()=>v(!1),onConfirm:()=>{e&&y(e)},children:(0,i.jsxs)("ol",{className:"list-decimal list-inside text-sm text-foreground-light pl-30",children:[(0,i.jsx)("li",{children:"The information that you are about to access is confidential."}),(0,i.jsx)("li",{children:'Your access to our SOC 2 materials is governed by confidentiality obligations contained in the agreement between Supabase, Inc ("Supabase", "we", "our" or "us") and the Supabase customer that has authorized you to access our platform to obtain this information (our "Customer").'}),(0,i.jsx)("li",{children:"You must ensure that you treat the information in our SOC 2 materials in accordance with those confidentiality obligations, as communicated to you by the Customer."}),(0,i.jsxs)("li",{children:['By clicking "I agree" below or otherwise accessing our SOC 2 materials, you:',(0,i.jsxs)("ol",{className:"list-[lower-roman] list-inside pl-4",children:[(0,i.jsx)("li",{children:"acknowledge that you have read and understood this Confidentiality Notice;"}),(0,i.jsx)("li",{children:"confirm that you have been authorized by the Customer to access this information, and your use of our SOC 2 materials is subject to the confidentiality obligations owed by the Customer to us."})]})]}),(0,i.jsx)("li",{children:"This Confidentiality Notice does not substitute or supersede any agreement between us and the Customer, or any internal rules or policies that the Customer requires you to comply with in your access to and use of confidential information. However, your failure to comply with this Confidentiality Notice may be used to determine whether the Customer has complied with its confidentiality obligations to us."})]})})]})]})},nX=()=>(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(l.jX,{children:[(0,i.jsxs)(l.g$,{className:"sticky space-y-6 top-12",children:[(0,i.jsx)("p",{className:"text-base m-0",children:"HIPAA"}),(0,i.jsxs)("div",{className:"space-y-2 text-sm text-foreground-light m-0",children:[(0,i.jsx)("p",{children:"This is only for HIPAA requests. Please ignore this if you already have HIPAA enabled."}),(0,i.jsx)("p",{children:"Organizations on the Team Plan or above are eligible for a paid HIPAA compliance add-on. You can submit a request here and we will get back to you on the pricing and process for your use case."}),(0,i.jsx)("p",{children:"Organizations on the Free or Pro Plan can also submit a request for HIPAA. Note that you are still required to upgrade to the Team Plan after your request is approved."})]})]}),(0,i.jsx)(l.Lc,{children:(0,i.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,i.jsx)("a",{href:"https://forms.supabase.com/hipaa2",target:"_blank",rel:"noreferrer noopener",children:(0,i.jsx)(W.z,{type:"default",iconRight:(0,i.jsx)(eo.Z,{}),children:"Request HIPAA"})})})})]})}),nK=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l._S,{id:"dpa",children:(0,i.jsx)(nB,{})}),(0,i.jsx)(l.I7,{}),(0,i.jsx)(l._S,{id:"tia",children:(0,i.jsx)(nV,{})}),(0,i.jsx)(l.I7,{}),(0,i.jsx)(l._S,{id:"soc2",children:(0,i.jsx)(nH,{})}),(0,i.jsx)(l.I7,{}),(0,i.jsx)(l._S,{id:"hipaa",children:(0,i.jsx)(nX,{})}),(0,i.jsx)(l.I7,{}),(0,i.jsx)(l._S,{id:"security-questionnaire",children:(0,i.jsx)(nq,{})}),(0,i.jsx)(l.I7,{}),(0,i.jsx)(l._S,{children:(0,i.jsx)(l.jX,{children:(0,i.jsxs)("p",{className:"sticky space-y-6 top-12 text-sm text-foreground-light m-0 whitespace-nowrap",children:[(0,i.jsx)(M(),{href:"/support/new",className:"hover:underline",children:"Submit a support request"})," ","if you require additional documents for financial or tax reasons, such as a W-9 form."]})})})]})},46666:function(e,a,t){t.d(a,{E:function(){return d}});var s=t(52322),n=t(2784),i=t(10012),r=t(19869),l=t(12934),o=t(32079);let d=e=>{let{options:a=[],activeOptions:t=[],valueKey:d,labelKey:c,name:u="default",variant:m="rectangular",onSaveFilters:p,disabled:h}=e,[x,g]=(0,n.useState)(!1),[j,v]=(0,n.useState)([]),f=t.map(e=>{let t=a.find(a=>a[d]===e);return t&&t[c]?t[c]:""});return(0,s.jsx)(i.Z,{side:"bottom",align:"start",disabled:h,open:x,onOpenChange:()=>g(!x),header:(0,s.jsxs)("div",{className:"prose text-xs",children:["Select ",u.toLowerCase()]}),overlay:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"space-y-4 min-w-[170px]",children:(0,s.jsx)(r.x,{className:a.length>7?"h-[205px]":"",children:(0,s.jsx)(l.Z.Group,{className:"px-3 py-3",id:"projects",onChange:e=>{let a=e.target.value;j.includes(a)?v(j.filter(e=>e!==a)):v(j.concat(a))},options:a.map(e=>({value:e[d],label:e[c],defaultChecked:t.includes(e[d])}))})})}),(0,s.jsxs)("div",{className:"flex items-center justify-end gap-2 border-t border-overlay bg-surface-200 py-2 px-3",children:[(0,s.jsx)(o.z,{size:"tiny",type:"default",onClick:()=>{p([]),g(!1)},children:"Clear"}),(0,s.jsx)(o.z,{type:"primary",onClick:()=>{p(j),g(!1)},children:"Save"})]})]}),children:(0,s.jsx)(o.z,{asChild:!0,type:t.length>0?"default":"dashed",onClick:()=>g(!1),className:"rounded"===m?"rounded-full":"",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{children:u}),t.length>0&&(0,s.jsx)("span",{className:"mr-1",children:":"}),t.length>=3?(0,s.jsxs)("span",{children:[f[0]," and ",t.length-1," others"]}):t.length>0?(0,s.jsx)("span",{children:f.join(", ")}):null]})})})}},67873:function(e,a,t){t.d(a,{DO:function(){return d},Tq:function(){return l},by:function(){return r},iL:function(){return o},m9:function(){return c}});var s=t(52322),n=t(2784),i=t(54383);let r=e=>{let{children:a,header:t,footer:n}=e;return(0,s.jsxs)(l,{children:[t&&(0,s.jsx)(o,{children:t}),(0,s.jsx)(d,{className:"divide-y",children:a}),n&&(0,s.jsx)(c,{children:n})]})},l=(0,n.forwardRef)((e,a)=>{let{children:t,...n}=e;return(0,s.jsx)("div",{ref:a,...n,className:(0,i.cn)("bg-surface-100 border overflow-hidden rounded-md shadow",n.className),children:t})});l.displayName=l.displayName;let o=(0,n.forwardRef)((e,a)=>{let{children:t,...n}=e;return(0,s.jsx)("div",{ref:a,...n,className:(0,i.cn)("border-default border-b px-8 py-4",n.className),children:t})});o.displayName=o.displayName;let d=(0,n.forwardRef)((e,a)=>{let{children:t,...n}=e;return(0,s.jsx)("div",{ref:a,...n,className:(0,i.cn)("divide-border flex flex-col gap-0",n.className),children:t})});d.displayName=d.displayName;let c=(0,n.forwardRef)((e,a)=>{let{children:t,...n}=e;return(0,s.jsx)("div",{ref:a,...n,className:(0,i.cn)("border-t",n.className),children:t})});c.displayName=c.displayName},4787:function(e,a,t){t.d(a,{B4:function(){return o},S0:function(){return r},hj:function(){return i}});var s=t(52322),n=t(2784);let i=e=>{let{children:a,id:t,header:n,disabled:i,className:r}=e;return(0,s.jsxs)("div",{id:t,className:["grid grid-cols-12 gap-6 px-8 py-8","".concat(i?" opacity-30":" opacity-100"),"".concat(r)].join(" "),children:[n,a]})},r=e=>{let{children:a,className:t="",description:n}=e;return void 0!==n?(0,s.jsxs)("div",{className:"flex flex-col space-y-2 col-span-12 lg:col-span-5 ".concat(t),children:[(0,s.jsx)("label",{className:"text-foreground text-sm",children:a}),n]}):(0,s.jsx)("label",{className:"text-foreground col-span-12 text-sm lg:col-span-5 ".concat(t),children:a})},l=()=>(0,s.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[(0,s.jsx)("div",{className:"shimmering-loader h-2 w-1/3 rounded"}),(0,s.jsx)("div",{className:"flex flex-col justify-between space-y-2",children:(0,s.jsx)("div",{className:"shimmering-loader h-[34px] w-2/3 rounded"})})]}),o=e=>{let{children:a,loading:t=!0,fullWidth:i,className:r}=e;return(0,s.jsx)("div",{className:"\n        relative col-span-12 flex flex-col gap-6 lg:col-span-7\n        ".concat(i&&"!col-span-12","\n        ").concat(r,"\n      "),children:t?n.Children.map(a,()=>(0,s.jsx)(l,{})):a})}},61531:function(e,a,t){var s=t(52322),n=t(99064),i=t(25097),r=t(17172),l=t(39097),o=t.n(l),d=t(2784),c=t(32079);a.Z=e=>{let{icon:a,title:t,description:l,url:u,urlLabel:m="Read more",defaultVisibility:p=!1,hideCollapse:h=!1,button:x,className:g="",block:j=!1}=e,[v,f]=(0,d.useState)(p);return(0,s.jsx)("div",{className:"".concat(j?"block w-full":"","\n      block w-full rounded border bg-surface-200 py-3 ").concat(g),children:(0,s.jsxs)("div",{className:"flex flex-col px-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex w-full space-x-3 items-center",children:[a&&(0,s.jsx)("span",{className:"text-foreground-lighter",children:a}),(0,s.jsx)("div",{className:"flex-grow",children:(0,s.jsx)("h5",{className:"text-sm text-foreground",children:t})})]}),l&&!h?(0,s.jsx)("div",{className:"cursor-pointer text-foreground-lighter",onClick:()=>f(!v),children:v?(0,s.jsx)(n.Z,{size:14,strokeWidth:1.5}):(0,s.jsx)(i.Z,{size:14,strokeWidth:1.5})}):null]}),(l||u||x)&&(0,s.jsxs)("div",{className:"flex flex-col space-y-3 overflow-hidden transition-all ".concat(v?"mt-3":""),style:{maxHeight:v?500:0},children:[(0,s.jsx)("div",{className:"text-foreground-light text-sm",children:l}),u&&(0,s.jsx)("div",{children:(0,s.jsx)(c.z,{asChild:!0,type:"default",icon:(0,s.jsx)(r.Z,{}),children:(0,s.jsx)(o(),{href:u,target:"_blank",rel:"noreferrer",children:m})})}),x&&(0,s.jsx)("div",{children:x})]})]})})}},81073:function(e,a,t){t.d(a,{y:function(){return d}});var s=t(52322),n=t(17172),i=t(69513),r=t(95492),l=t(32079),o=t(64725);let d={"vercel-marketplace":"Vercel Marketplace","aws-marketplace":"AWS Marketplace"};a.Z=function(e){var a,t;let{partner:c,resource:u,cta:m}=e,p=void 0!==m,{data:h,isLoading:x,isError:g}=(0,i.s)({installationId:null==m?void 0:m.installationId},{enabled:p}),j=(null!==(a=null==h?void 0:h.url)&&void 0!==a?a:"")+(null!==(t=null==m?void 0:m.path)&&void 0!==t?t:"");return(0,s.jsxs)(r.bZ,{className:"flex flex-col items-center gap-4",children:[(0,s.jsx)(o.Z,{organization:{managed_by:c},showTooltip:!1,size:"large"}),(0,s.jsxs)(r.Cd,{className:"text-lg",children:[u," are managed by ",d[c],"."]}),p&&(0,s.jsx)(l.z,{asChild:!0,iconRight:(0,s.jsx)(n.Z,{}),disabled:x||g,children:(0,s.jsx)("a",{href:j,target:"_blank",rel:"noopener noreferrer",children:m.message||"View ".concat(u," on ").concat(d[c])})})]})}},69513:function(e,a,t){t.d(a,{s:function(){return l}});var s=t(36492),n=t(31696),i=t(90301);async function r(e,a){let{installationId:t}=e;if(!t)throw Error("installationId is required");let{data:s,error:i}=await (0,n.U2)("/platform/vercel/redirect/{installation_id}",{params:{path:{installation_id:t}},signal:a});return i&&(0,n.S3)(i),s}let l=function(e){let{installationId:a}=e,{enabled:t=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.a)(i.F.vercelRedirect(a),e=>{let{signal:t}=e;return r({installationId:a},t)},{enabled:t&&void 0!==a,...n})}},17436:function(e,a,t){t.d(a,{Y:function(){return s}});let s={overdueInvoices:()=>["invoices","overdue"],invoice:e=>["invoice",e],list:(e,a)=>["invoices",e,a],count:e=>["invoices",e,"count"],projectInvoices:(e,a)=>["invoices",e,a],projectInvoicesCount:e=>["invoices",e,"count"],orgUpcomingPreview:e=>["invoices",e,"upcoming-preview"]}},3507:function(e,a,t){t.d(a,{O:function(){return s}});let s={rolesV2:e=>["organization-members",e,"roles-v2"],invitations:e=>["organization-members",e,"invitations"],invitation:(e,a)=>["organization-members",e,"invitations",a],token:(e,a)=>["organization-members",e,"token",a]}},78388:function(e,a,t){t.d(a,{T:function(){return c}});var s=t(85945),n=t(48228),i=t(56958),r=t(31696),l=t(28414),o=t(91160);async function d(e){let{name:a,kind:t,size:s,tier:n,payment_method:i}=e,{data:l,error:o}=await (0,r.v_)("/platform/organizations",{body:{name:a,kind:t,size:s,tier:n,payment_method:i}});return o&&(0,r.S3)(o),l}let c=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,s.NL)();return(0,n.D)(e=>d(e),{async onSuccess(a,t,s){await Promise.all([r.invalidateQueries(o.O.list()),r.invalidateQueries(l.F.list())]),await (null==e?void 0:e(a,t,s))},async onError(e,t,s){void 0===a?i.Am.error("Failed to create organization: ".concat(e.message)):a(e,t,s)},...t})}},6654:function(e,a,t){t.d(a,{k:function(){return d}});var s=t(85945),n=t(48228),i=t(56958),r=t(31696),l=t(91160);async function o(e){let{slug:a,name:t,billing_email:s,opt_in_tags:n}=e,i={};t&&(i.name=t),s&&(i.billing_email=s),n&&(i.opt_in_tags=n);let{data:l,error:o}=await (0,r.r$)("/platform/organizations/{slug}",{params:{path:{slug:a}},body:i});return o&&(0,r.S3)(o),l}let d=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,s.NL)();return(0,n.D)(e=>o(e),{async onSuccess(a,t,s){await r.invalidateQueries(l.O.list()),await (null==e?void 0:e(a,t,s))},async onError(e,t,s){void 0===a?i.Am.error("Failed to update organization: ".concat(e.message)):a(e,t,s)},...t})}},11774:function(e,a,t){t.d(a,{Wu:function(){return r}});var s=t(9162),n=t(4741);let i=(0,s.sj)({panelKey:void 0,setPanelKey:e=>{i.panelKey=e}}),r=e=>(0,n.R)(i,e)},87668:function(e,a,t){t.d(a,{E:function(){return b}});var s=t(52322),n=t(2784),i=t(22574),r=t(10929),l=t(54383),o=t(6112),d=t(75109),c=t(67914);let u=(0,r.j)("relative grid gap-2",{variants:{size:{tiny:"text-xs",small:"text-sm leading-4",medium:"text-sm",large:"text-base",xlarge:"text-base"},align:{left:"",right:""},responsive:{true:"",false:""},layout:{horizontal:"grid grid-cols-12",vertical:"flex flex-col gap-3",flex:"flex flex-row gap-3","flex-row-reverse":"flex flex-row gap-3 flex-row-reverse justify-between"},flex:{true:"",false:""}},compoundVariants:[{layout:"flex",align:"right",className:"justify-between"},{layout:"flex-row-reverse",align:"right",className:"justify-between"}],defaultVariants:{}}),m=(0,r.j)("transition-all duration-500 ease-in-out",{variants:{flex:{true:"",false:""},align:{left:"",right:""},layout:{horizontal:"flex flex-col gap-2 col-span-4",vertical:"flex flex-row gap-2 justify-between",flex:"flex flex-col gap-0","flex-row-reverse":"flex flex-col gap-2"},labelLayout:{horizontal:"",vertical:"","":""}},compoundVariants:[{flex:!0,align:"left",className:"order-2"},{flex:!0,align:"right",className:"order-1"},{layout:"vertical",labelLayout:void 0,flex:!1,className:"flex flex-row gap-2 justify-between"},{layout:"horizontal",className:"flex flex-col gap-2"}],defaultVariants:{}}),p=(0,r.j)("transition-all duration-500 ease-in-out",{variants:{flex:{true:"",false:""},align:{left:"order-1",right:"order-2"},layout:{horizontal:"",vertical:"",flex:"","flex-row-reverse":""}},compoundVariants:[{flex:!0,align:"left",className:"order-1"},{flex:!0,align:"right",className:"order-2"},{layout:"vertical",className:"col-span-12"},{layout:"horizontal",align:"left",className:"col-span-8"},{layout:"horizontal",align:"right",className:"text-right"}],defaultVariants:{}}),h=(0,r.j)("text-foreground-lighter leading-normal",{variants:{size:{...d.NO.text},layout:{vertical:"mt-2",horizontal:"mt-2",flex:"","flex-row-reverse":""}},defaultVariants:{}}),x=(0,r.j)("text-foreground-muted",{variants:{size:{...d.NO.text}},defaultVariants:{}}),g=(0,r.j)("text-foreground-muted",{variants:{size:{...d.NO.text}},defaultVariants:{}}),j=(0,r.j)("text-foreground-muted",{variants:{size:{...d.NO.text}},defaultVariants:{}}),v=(0,r.j)("",{variants:{flex:{true:"",false:""},align:{left:"",right:""}},compoundVariants:[{flex:!0,align:"left",className:""},{flex:!0,align:"right",className:"order-last"}]}),f=(0,r.j)("",{variants:{nonBoxInput:{true:"",false:""},label:{true:"",false:""},layout:{vertical:"",horizontal:"","flex-row-reverse":""}},compoundVariants:[{nonBoxInput:!0,label:!0,layout:"vertical",className:"my-3"},{nonBoxInput:!0,label:!0,layout:"horizontal",className:"my-3 md:mt-0 mb-3"}],defaultVariants:{}}),y=n.forwardRef((e,a)=>{let{align:t="left",className:n,description:r,id:d,label:y,labelOptional:b,layout:N="vertical",style:w,labelLayout:_,size:S="medium",beforeLabel:C,afterLabel:I,nonBoxInput:A=!y,hideMessage:Z=!1,isReactForm:z,...E}=e,k="flex"===N||"flex-row-reverse"===N,T=!!(y||C||I),P=z&&!Z&&(0,s.jsx)(c.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3,ease:"easeInOut"},className:"mt-2",children:(0,s.jsx)(i.zG,{className:"mt-2 transition-opacity duration-300 ease-in-out","data-formlayout-id":"message"})}),O=r&&z?(0,s.jsx)(i.pf,{className:(0,l.cn)(h({size:S,layout:N})),"data-formlayout-id":"description",id:d+"-description",children:r}):r?(0,s.jsx)("p",{className:(0,l.cn)(h({size:S,layout:N}),"text-sm text-foreground-light"),"data-formlayout-id":"description",children:r}):null,R=()=>(0,s.jsxs)(s.Fragment,{children:[C&&(0,s.jsx)("span",{className:(0,l.cn)(x({size:S})),id:d+"-before","data-formlayout-id":"beforeLabel",children:(0,s.jsx)("span",{children:C})}),(0,s.jsx)("span",{children:y}),I&&(0,s.jsx)("span",{className:(0,l.cn)(g({size:S})),id:d+"-after","data-formlayout-id":"afterLabel",children:I})]});return(0,s.jsxs)("div",{ref:a,...E,className:(0,l.cn)(u({size:S,flex:k,align:t,layout:N}),n),children:[k&&(0,s.jsx)("div",{className:(0,l.cn)(v({flex:k,align:t})),children:E.children}),T||b||"horizontal"===N?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:(0,l.cn)(m({align:t,labelLayout:_,flex:k,layout:N})),"data-formlayout-id":"labelContainer",children:[T&&z?(0,s.jsx)(i.lX,{className:"flex gap-2 items-center break-all","data-formlayout-id":"formLabel",children:(0,s.jsx)(R,{})}):(0,s.jsx)(o._,{htmlFor:E.name,"data-formlayout-id":"label",className:"flex gap-2 items-center break-all",children:(0,s.jsx)(R,{})}),b&&(0,s.jsx)("span",{className:(0,l.cn)(j({size:S})),id:d+"-optional","data-formlayout-id":"labelOptional",children:b}),k&&(0,s.jsxs)(s.Fragment,{children:[O,P]})]})}):null,!k&&(0,s.jsx)("div",{className:(0,l.cn)(p({align:t,layout:N})),style:w,"data-formlayout-id":"dataContainer",children:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:(0,l.cn)(f({nonBoxInput:A,label:y,layout:N})),"data-formlayout-id":"nonBoxInputContainer",children:E.children}),P,O]})})]})}),b=(0,n.forwardRef)((e,a)=>{let{...t}=e;return(0,s.jsx)(i.xJ,{children:(0,s.jsx)(y,{ref:a,isReactForm:!0,...t,children:t.children})})});b.displayName="FormItemLayout"},12934:function(e,a,t){t.d(a,{Z:function(){return c}});var s=t(52322),n=t(2784),i=t(25001),r=t(46318),l=t(70780);let o=(0,n.createContext)({parentCallback:e=>{},parentSize:""});function d(e){let{className:a,id:t="",name:n="",label:i,afterLabel:d,beforeLabel:c,description:u,checked:m,value:p,onChange:h,onBlur:x,size:g="medium",disabled:j=!1,...v}=e,{formContextOnChange:f,values:y,handleBlur:b}=(0,l.G)(),N=(0,r.Z)("checkbox");return(0,s.jsx)(o.Consumer,{children:e=>{let{parentCallback:r,parentSize:l}=e,o=t||n||(i?i.toLowerCase().replace(/^[^A-Z0-9]+/gi,"").replace(/ /g,"-"):void 0);g=l||g;let w=n||o,_=null!=m?m:void 0,S=[N.container];return a&&S.push(a),y&&void 0===m&&(_=y[t||n]),(0,s.jsxs)("div",{className:S.join(" "),children:[(0,s.jsx)("input",{id:o,name:w,type:"checkbox",className:[N.base,N.size[g]].join(" "),onChange:function(e){r&&r(e),h&&h(e),f&&f(e)},onBlur:function(e){b&&setTimeout(()=>{b(e)},100),x&&x(e)},checked:_,value:p||o,disabled:j,...v}),(0,s.jsxs)("label",{className:[N.label.base,N.label[g]].join(" "),htmlFor:o,children:[(0,s.jsxs)("span",{children:[c&&(0,s.jsx)("span",{className:[N.label_before.base,N.label_before[g]].join(" "),children:c}),i,d&&(0,s.jsx)("span",{className:[N.label_after.base,N.label_after[g]].join(" "),children:d})]}),u&&(0,s.jsx)("p",{className:[N.description.base,N.description[g]].join(" "),children:u})]})]})}})}d.Group=function(e){let{id:a,layout:t="vertical",error:n,descriptionText:l,label:c,afterLabel:u,beforeLabel:m,labelOptional:p,children:h,className:x,options:g,onChange:j,size:v="medium"}=e,f=(0,r.Z)("checkbox");return(0,s.jsx)(i.l,{label:c,afterLabel:u,beforeLabel:m,labelOptional:p,layout:t,id:a,error:n,descriptionText:l,className:x,size:v,children:(0,s.jsx)(o.Provider,{value:{parentCallback:e=>{j&&j(e)},parentSize:v},children:(0,s.jsx)("div",{className:f.group,children:g?g.map(e=>(0,s.jsx)(d,{id:e.id,value:e.value,label:e.label,beforeLabel:e.beforeLabel,afterLabel:e.afterLabel,checked:e.checked,name:e.name,description:e.description,defaultChecked:e.defaultChecked},e.id)):h})})})};var c=d},11992:function(e,a,t){var s=t(52322),n=t(69557);t(2784);var i=t(46318);let r=e=>{let{open:a,children:t,className:i,...r}=e;return(0,s.jsx)(n.fC,{asChild:r.asChild,defaultOpen:r.defaultOpen,open:a,onOpenChange:r.onOpenChange,disabled:r.disabled,className:i,children:t})};r.Trigger=function(e){let{children:a,asChild:t}=e;return(0,s.jsx)(n.xz,{asChild:t,children:a})},r.Content=function(e){let{asChild:a,children:t,className:r}=e,l=(0,i.Z)("collapsible");return(0,s.jsx)(n.VY,{asChild:a,className:[l.content,r].join(" "),children:t})},a.ZP=r},22854:function(e,a,t){var s=t(52322),n=t(6277),i=t(2784),r=t(25001),l=t(46318),o=t(70780);a.Z=function(e){var a;let{disabled:t,id:d="",name:c="",layout:u="flex",error:m,descriptionText:p,label:h,afterLabel:x,beforeLabel:g,labelOptional:j,onChange:v,onBlur:f,defaultChecked:y,checked:b,className:N,align:w="left",size:_="medium",validation:S,labelLayout:C,...I}=e,A=(0,l.Z)("toggle"),{formContextOnChange:Z,values:z,errors:E,handleBlur:k,touched:T,fieldLevelValidation:P}=(0,o.G)();z&&!b&&(b=z[d||c]);let[O,R]=(0,i.useState)(null!==(a=y||b)&&void 0!==a&&a),D=null!=b?b:O;(0,i.useEffect)(()=>{R(D)},[]),m||(E&&!m&&(m=E[d||c]),m=T&&T[d||c]?m:void 0);let L=[A.base,A.handle_container[_]];D&&L.push(A.active);let M=[A.handle.base,A.handle[_]];return D&&M.push(A.handle_active[_]),(0,s.jsx)(r.l,{className:N,label:h,afterLabel:x,beforeLabel:g,labelOptional:j,layout:u,id:d,error:m,align:w,descriptionText:p,size:_,labelLayout:C,nonBoxInput:!0,children:(0,s.jsx)("button",{type:"button",id:d,name:c,className:(0,n.default)(...L,t&&"opacity-50 cursor-default"),onClick:function(){v&&v(!D),R(!O);let e={};e.target={type:"checkbox",name:c,id:d,value:!D,checked:!D},Z&&Z(e),S&&P(d,S(!O))},disabled:t,onBlur:function(e){setTimeout(()=>{k&&k(e)},100),f&&f(e)},...I,children:(0,s.jsx)("span",{"aria-hidden":"true",className:M.join(" ")})})})}},62949:function(e,a,t){t.d(a,{Bw:function(){return f},DI:function(){return p},Ph:function(){return m},Ql:function(){return b},U$:function(){return N},i4:function(){return g},ki:function(){return h},n5:function(){return y}});var s=t(52322),n=t(38947),i=t(78232),r=t(20670),l=t(76141),o=t(2784),d=t(54383),c=t(10929),u=t(75109);let m=n.fC,p=n.ZA,h=n.B4,x=(0,c.j)("",{variants:{size:{...u.Ld}},defaultVariants:{size:u.Rc}}),g=o.forwardRef((e,a)=>{let{className:t,children:r,size:l,...o}=e;return(0,s.jsxs)(n.xz,{ref:a,className:(0,d.cn)("flex w-full items-center justify-between rounded-md border border-strong hover:border-stronger bg-alternative dark:bg-muted hover:bg-selection text-xs ring-offset-background-control placeholder:text-foreground-muted focus:outline-none ring-border-control focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all duration-200","data-[state=open]:bg-selection data-[state=open]:border-stronger",x({size:l}),t),...o,children:[r,(0,s.jsx)(n.JO,{asChild:!0,children:(0,s.jsx)(i.Z,{className:"h-4 w-4 text-foreground-muted"})})]})});g.displayName=n.xz.displayName;let j=o.forwardRef((e,a)=>{let{className:t,...i}=e;return(0,s.jsx)(n.u_,{ref:a,className:(0,d.cn)("flex cursor-default items-center justify-center py-1 text-foreground-muted",t),...i,children:(0,s.jsx)(r.Z,{className:"h-4 w-4"})})});j.displayName=n.u_.displayName;let v=o.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(n.$G,{ref:a,className:(0,d.cn)("flex cursor-default items-center justify-center py-1 text-foreground-muted",t),...r,children:(0,s.jsx)(i.Z,{className:"h-4 w-4"})})});v.displayName=n.$G.displayName;let f=o.forwardRef((e,a)=>{let{className:t,children:i,position:r="popper",...l}=e;return(0,s.jsx)(n.h_,{children:(0,s.jsxs)(n.VY,{ref:a,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-overlay text-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...l,children:[(0,s.jsx)(j,{}),(0,s.jsx)(n.l_,{className:(0,d.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:i}),(0,s.jsx)(v,{})]})})});f.displayName=n.VY.displayName;let y=o.forwardRef((e,a)=>{let{className:t,...i}=e;return(0,s.jsx)(n.__,{ref:a,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-xs text-foreground-lighter/75 uppercase tracking-wider font-mono",t),...i})});y.displayName=n.__.displayName;let b=o.forwardRef((e,a)=>{let{className:t,children:i,...r}=e;return(0,s.jsxs)(n.ck,{ref:a,className:(0,d.cn)("group","relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-overlay-hover text-foreground-light focus:text-foreground data-[state=checked]:text-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(n.wU,{className:"h-3.5 w-3.5 bg-foreground rounded-full flex justify-center items-center",children:(0,s.jsx)(l.Z,{className:"h-2 w-2 text-background-overlay",strokeWidth:6})})}),(0,s.jsx)(n.eT,{children:i})]})});b.displayName=n.ck.displayName;let N=o.forwardRef((e,a)=>{let{className:t,...i}=e;return(0,s.jsx)(n.Z0,{ref:a,className:(0,d.cn)("-mx-1 my-1 h-px bg-border-overlay",t),...i})});N.displayName=n.Z0.displayName},7117:function(e,a,t){t.d(a,{DN:function(){return v},Ei:function(){return b},FF:function(){return f},Tu:function(){return j},aM:function(){return c},bC:function(){return y},sw:function(){return u},ue:function(){return g},yo:function(){return d}});var s=t(52322),n=t(70241),i=t(10929),r=t(2784),l=t(8609),o=t(54383);let d=n.fC,c=n.xz,u=n.x8;(0,i.j)("fixed inset-0 z-50 flex",{variants:{side:{top:"items-start",bottom:"items-end",left:"justify-start",right:"justify-end"}},defaultVariants:{side:"right"}});let m=e=>{let{side:a,children:t,...i}=e;return(0,s.jsx)(n.h_,{...i,children:t})};m.displayName=n.h_.displayName;let p=r.forwardRef((e,a)=>{let{className:t,children:i,...r}=e;return(0,s.jsx)(n.aV,{className:(0,o.cn)("fixed inset-0 z-50 bg-alternative/90 backdrop-blur-sm transition-all duration-100 data-[state=closed]:animate-out data-[state=closed]:fade-out data-[state=open]:fade-in",t),...r,ref:a})});p.displayName=n.aV.displayName;let h=(0,o.cn)(["fixed z-50 scale-100 gap-4 bg-studio opacity-100 shadow-lg","data-[state=open]:animate-in data-[state=open]:duration-300 data-[state=closed]:animate-out data-[state=closed]:duration-300"]),x=(0,i.j)(h,{variants:{side:{top:"data-[state=open]:slide-in-from-top data-[state=closed]:slide-out-to-top w-full border-b inset-x-0 top-0",bottom:"data-[state=open]:slide-in-from-bottom data-[state=closed]:slide-out-to-bottom w-full border-t inset-x-0 bottom-0",left:"data-[state=open]:slide-in-from-left data-[state=closed]:slide-out-to-left h-full border-r inset-y-0 left-0",right:"data-[state=open]:slide-in-from-right data-[state=closed]:slide-out-to-right h-full border-l inset-y-0 right-0"},size:{content:"",default:"",sm:"",lg:"",xl:"",xxl:"",full:""}},compoundVariants:[{side:["top","bottom"],size:"content",class:"max-h-screen"},{side:["top","bottom"],size:"default",class:"h-1/3"},{side:["top","bottom"],size:"sm",class:"h-1/4"},{side:["top","bottom"],size:"lg",class:"h-1/2"},{side:["top","bottom"],size:"xl",class:"h-5/6"},{side:["top","bottom"],size:"full",class:"h-screen"},{side:["right","left"],size:"content",class:"max-w-screen"},{side:["right","left"],size:"default",class:"w-1/3"},{side:["right","left"],size:"sm",class:"w-1/4"},{side:["right","left"],size:"lg",class:"w-1/2"},{side:["right","left"],size:"xl",class:"w-4/6"},{side:["right","left"],size:"xxl",class:"w-5/6"},{side:["right","left"],size:"full",class:"w-screen"}],defaultVariants:{side:"right",size:"default"}}),g=r.forwardRef((e,a)=>{let{side:t,size:i,className:r,children:d,showClose:c=!0,...u}=e;return(0,s.jsxs)(m,{side:t,children:[(0,s.jsx)(p,{}),(0,s.jsxs)(n.VY,{ref:a,className:(0,o.cn)(x({side:t,size:i}),r),...u,children:[d,c?(0,s.jsxs)(n.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,s.jsx)(l.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]}):null]})]})});g.displayName=n.VY.displayName;let j=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,o.cn)("px-5 py-4 text-center sm:text-left border-b bg-dash-sidebar",a),...t})};j.displayName="SheetHeader";let v=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,o.cn)("px-content py-content",a),...t})};v.displayName="SheetSection";let f=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,o.cn)("px-5 py-3 border-t w-full","flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t})};f.displayName="SheetFooter";let y=r.forwardRef((e,a)=>{let{className:t,...i}=e;return(0,s.jsx)(n.Dx,{ref:a,className:(0,o.cn)("text-lg text-foreground",t),...i})});y.displayName=n.Dx.displayName;let b=r.forwardRef((e,a)=>{let{className:t,...i}=e;return(0,s.jsx)(n.dk,{ref:a,className:(0,o.cn)("text-sm text-foreground-light",t),...i})});b.displayName=n.dk.displayName}}]);