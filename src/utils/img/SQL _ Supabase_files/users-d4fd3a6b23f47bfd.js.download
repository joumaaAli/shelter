(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[347],{27559:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/auth/users",function(){return t(28704)}])},64568:function(e,s,t){"use strict";function r(e){try{return JSON.parse(JSON.stringify(e))}catch(e){throw e}}function i(e){return e?"object"==typeof e||Array.isArray(e)?JSON.stringify(e):e:""}t.d(s,{I8:function(){return r},Lw:function(){return i},vQ:function(){return a}});let a=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{};if(window.document.hasFocus()){var t,r;null===(r=window.navigator)||void 0===r||null===(t=r.clipboard)||void 0===t||t.writeText(e).then(s)}else console.warn("Unable to copy to clipboard")}},22965:function(e,s,t){"use strict";t.d(s,{Bi:function(){return a},E$:function(){return m},Gf:function(){return u},KG:function(){return i}});var r=t(99248);let i=e=>{let{currentTarget:s}=e;return s.scrollTop+10>=s.scrollHeight-s.clientHeight},a=e=>e.map(e=>{var s,t;let i=null!==(t=null===(s=e.raw_app_meta_data)||void 0===s?void 0:s.provider)&&void 0!==t?t:"";return{id:e.id,email:e.email,phone:e.phone,created_at:e.created_at,last_sign_in_at:e.last_sign_in_at,provider:e.is_anonymous?"-":i,provider_type:e.is_anonymous?"Anonymous":c.includes(i)?"Social":d.includes(i)?"Phone":"-",provider_icon:"email"===i?"".concat(r.GW,"/img/icons/email-icon2.svg"):o[i]?"".concat(r.GW,"/img/icons/").concat(o[i],".svg"):void 0,img:m(e),name:u(e)}}),n=[{apple:"apple-icon"},{azure:"microsoft-icon"},{bitbucket:"bitbucket-icon"},{discord:"discord-icon"},{facebook:"facebook-icon"},{figma:"figma-icon"},{github:"github-icon"},{gitlab:"gitlab-icon"},{google:"google-icon"},{kakao:"kakao-icon"},{keycloak:"keycloak-icon"},{linkedin:"linkedin-icon"},{notion:"notion-icon"},{twitch:"twitch-icon"},{twitter:"twitter-icon"},{slack:"slack-icon"},{spotify:"spotify-icon"},{workos:"workos-icon"},{zoom:"zoom-icon"}],l=[{twilio:"twilio-icon"},{messagebird:"messagebird-icon"},{textlocal:"messagebird-icon"},{vonage:"messagebird-icon"},{twilioverify:"twilio-verify-icon"}],o=Object.values([...n,...l]).reduce((e,s)=>{let[[t,r]]=Object.entries(s);return{...e,[t]:r}},{}),c=n.map(e=>{let[s]=Object.keys(e);return s}),d=l.map(e=>{let[s]=Object.keys(e);return s});function u(e){var s;let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",{displayName:r,display_name:i,fullName:a,full_name:n,familyName:l,family_name:o,givenName:c,given_name:d,surname:u,lastName:m,last_name:x,firstName:h,first_name:f}=null!==(s=e.raw_user_meta_data)&&void 0!==s?s:{},p=l||o||u||m||x,j=c||d||h||f;return r||i||a||n||j&&p&&"".concat(j," ").concat(p)||t}function m(e){var s;let{avatarUrl:t,avatarURL:r,avatar_url:i,profileUrl:a,profileURL:n,profile_url:l,profileImage:o,profile_image:c,profileImageUrl:d,profileImageURL:u,profile_image_url:m}=null!==(s=e.raw_user_meta_data)&&void 0!==s?s:{};return t||r||i||o||c||a||n||l||d||u||m}},41297:function(e,s,t){"use strict";t.d(s,{Z:function(){return v}});var r=t(52322),i=t(99959),a=t(5632),n=t(63910),l=t(34056),o=t(33635),c=t(3373),d=t(39097),u=t.n(d),m=t(95492),x=t(32079),h=t(4689),f=t(99248);let p=e=>[{title:"Manage",items:[{name:"Users",key:"users",url:"/project/".concat(e,"/auth/users"),items:[]}]},{title:"Configuration",items:[{name:"Policies",key:"policies",url:"/project/".concat(e,"/auth/policies"),items:[]},...f.Qy?[{name:"Providers",key:"providers",url:"/project/".concat(e,"/auth/providers"),items:[]},{name:"Rate Limits",key:"rate-limits",url:"/project/".concat(e,"/auth/rate-limits"),items:[]},{name:"Email Templates",key:"templates",url:"/project/".concat(e,"/auth/templates"),items:[]},{name:"URL Configuration",key:"url-configuration",url:"/project/".concat(e,"/auth/url-configuration"),items:[]},{name:"Hooks",key:"hooks",url:"/project/".concat(e,"/auth/hooks"),items:[],label:"BETA"}]:[]]}],j=()=>{let{ref:e="default"}=(0,i.UO)(),s=(0,n.ar)();(0,o.kM)({projectRef:e});let t=(0,a.useRouter)().pathname.split("/")[4];return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Q,{page:t,menu:p(e)}),s&&(0,r.jsx)("div",{className:"px-3",children:(0,r.jsxs)(m.bZ,{children:[(0,r.jsx)(m.Cd,{className:"text-sm",children:"Column Privileges has been shifted"}),(0,r.jsxs)(m.X,{className:"text-xs",children:[(0,r.jsx)("p",{className:"mb-2",children:"It can now be found in the menu under the database section."}),(0,r.jsx)(x.z,{asChild:!0,type:"default",size:"tiny",children:(0,r.jsx)(u(),{href:"/project/".concat(e,"/database/column-privileges"),children:"Head over to Database"})})]})]})})]})};var v=(0,c.Q)(e=>{let{title:s,children:t}=e;return(0,r.jsx)(h.Z,{title:s||"Authentication",product:"Authentication",productMenu:(0,r.jsx)(j,{}),isBlocking:!1,children:(0,r.jsx)("main",{style:{maxHeight:"100vh"},className:"flex-1 overflow-y-auto",children:t})})})},53449:function(e,s,t){"use strict";var r=t(52322),i=t(30339),a=t(16289),n=t(32079);s.Z=e=>{let{section:s}=e,t=(0,a.WZ)();return(0,r.jsx)(n.z,{size:"tiny",type:"default",onClick:()=>{s&&t.setActiveDocsSection(s),t.setShowProjectApiDocs(!0)},icon:(0,r.jsx)(i.Z,{strokeWidth:1.5,className:"text-foreground-muted"}),children:"API Docs"})}},14782:function(e,s,t){"use strict";var r=t(52322),i=t(52006);s.Z=e=>{let{resourceText:s,isFullPage:t=!1}=e,a=()=>(0,r.jsx)("div",{className:"block w-full rounded border border-opacity-20 py-4 px-6 border-overlay bg-surface-200",children:(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("div",{className:"mt-1",children:(0,r.jsx)(i.Z,{size:20})}),(0,r.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("p",{className:"text-sm",children:["You need additional permissions to ",s]}),(0,r.jsx)("div",{children:(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"Contact your organization owner or administrator for assistance."})})]})})]})});return t?(0,r.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,r.jsx)("div",{className:"w-[550px]",children:(0,r.jsx)(a,{})})}):(0,r.jsx)(a,{})}},38530:function(e,s,t){"use strict";t.d(s,{RT:function(){return n},xY:function(){return o}});var r=t(36492),i=t(31696),a=t(7161);let n=20;async function l(e,s){let{projectRef:t,page:r=1,keywords:a="",filter:l}=e;if(!t)throw Error("Project ref is required");let o={limit:n.toString(),offset:((r-1)*10).toString(),keywords:a};l&&(o.verified=l);let{data:c,error:d}=await (0,i.U2)("/platform/auth/{ref}/users",{params:{path:{ref:t},query:o},signal:s});return d&&(0,i.S3)(d),c}let o=function(e){let{projectRef:s,page:t,keywords:i,filter:n,connectionString:o}=e,{enabled:c=!0,...d}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.a)(a.o.users(s,{page:t,keywords:i,filter:n}),e=>{let{signal:r}=e;return l({projectRef:s,page:t,keywords:i,filter:n,connectionString:o},r)},{enabled:c&&void 0!==s,...d})}},28704:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return eK}});var r=t(52322),i=t(85945),a=t(2784),n=t(68806),l=t(8609),o=t(44446),c=t(59491),d=t(99959),u=t(63910),m=t(27570),x=t(53449),h=t(14782),f=t(7161),p=t(38530),j=t(87175),v=t(750),g=t(32079),y=t(62284),N=t(78232),w=t(48694);/**
 * @license lucide-react v0.436.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let b=(0,t(46145).Z)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var Z=t(4678),_=t.n(Z),k=t(99248),C=t(34503),S=t(2322),A=t(88883),z=t(16826),E=t(63955),P=t(56958),T=t(30195),U=t(48228),F=t(75939),D=t(88354);async function X(e){let{protocol:s,endpoint:t,serviceApiKey:r,user:i}=e,a=await (0,D.v_)("".concat(s,"://").concat(t,"/auth/v1/admin/users"),{email:i.email,password:i.password,email_confirm:i.autoConfirmUser},{headers:{apikey:r,Authorization:"Bearer ".concat(r)}});if(a.error)throw a.error;return a}let R=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,i.NL)(),a=(0,F.P)("userManagementV2");return(0,U.D)(e=>X(e),{async onSuccess(s,t,i){let{projectRef:n}=t;a?await r.invalidateQueries(f.o.usersInfinite(n)):await r.invalidateQueries(f.o.users(n)),await (null==e?void 0:e(s,t,i))},async onError(e,t,r){void 0===s?P.Am.error("Failed to create user: ".concat(e.message)):s(e,t,r)},...t})};var O=t(53535),L=t(41909),V=t(22574),W=t(42070),I=t(71640);let M=T.Ry({email:T.Z_().min(1,"Email is required").email("Must be a valid email address"),password:T.Z_().min(1,"Password is required"),autoConfirmUser:T.O7()});var Y=e=>{let{visible:s,setVisible:t}=e,{ref:i}=(0,d.UO)(),{data:a,isLoading:n,isSuccess:l}=(0,O.q)({projectRef:i},{enabled:s}),o=(0,j.Xo)(c.KA.AUTH_EXECUTE,"create_user"),{mutate:u,isLoading:m}=R({async onSuccess(e){P.Am.success("Successfully created user: ".concat(e.email)),t(!1)}}),x=async e=>{if(!l)return P.Am.error("Failed to create user: Error loading project config");let{protocol:s,endpoint:t,serviceApiKey:r}=a.autoApiService;u({projectRef:i,endpoint:t,protocol:s,serviceApiKey:r,user:e}),h.reset({email:"",password:"",autoConfirmUser:!0})},h=(0,E.cI)({resolver:(0,A.F)(M),defaultValues:{email:"",password:"",autoConfirmUser:!0}});return(0,r.jsx)(L.Vq,{open:s,onOpenChange:t,children:(0,r.jsxs)(L.cZ,{size:"small",children:[(0,r.jsx)(L.fK,{children:(0,r.jsx)(L.$N,{children:"Create a new user"})}),(0,r.jsx)(L.P3,{}),(0,r.jsx)(V.l0,{...h,children:(0,r.jsxs)("form",{id:"create-user",className:"flex flex-col gap-y-4 p-6",onSubmit:h.handleSubmit(x),children:[(0,r.jsx)(V.Wi,{name:"email",control:h.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(V.xJ,{className:"flex flex-col gap-1",children:[(0,r.jsx)(V.lX,{children:"Email address"}),(0,r.jsx)(V.NI,{children:(0,r.jsxs)("div",{className:"items-center relative",children:[(0,r.jsx)(w.Z,{size:18,className:"absolute left-2 top-1/2 transform -translate-y-1/2",strokeWidth:1.5}),(0,r.jsx)(W.I,{autoFocus:!0,...s,autoComplete:"off",type:"email",name:"email",placeholder:"user@example.com",disabled:m||n,className:"pl-8"})]})}),(0,r.jsx)(V.zG,{})]})}}),(0,r.jsx)(V.Wi,{name:"password",control:h.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(V.xJ,{className:"flex flex-col gap-1",children:[(0,r.jsx)(V.lX,{children:"User Password"}),(0,r.jsx)(V.NI,{children:(0,r.jsxs)("div",{className:"items-center relative",children:[(0,r.jsx)(z.Z,{size:18,className:"absolute left-2 top-1/2 transform -translate-y-1/2",strokeWidth:1.5}),(0,r.jsx)(W.I,{autoFocus:!0,...s,autoComplete:"new-password",type:"password",name:"password",placeholder:"••••••••",disabled:m||n,className:"pl-8"})]})}),(0,r.jsx)(V.zG,{})]})}}),(0,r.jsx)(V.Wi,{name:"autoConfirmUser",control:h.control,render:e=>{let{field:s}=e;return(0,r.jsxs)(V.xJ,{className:"flex items-center gap-x-2",children:[(0,r.jsx)(V.NI,{children:(0,r.jsx)(I.X,{checked:s.value,onCheckedChange:e=>s.onChange(e)})}),(0,r.jsx)(V.lX,{children:"Auto Confirm User?"})]})}}),(0,r.jsx)(V.lX,{children:(0,r.jsx)("p",{className:"text-sm text-foreground-lighter",children:"A confirmation email will not be sent when creating a user via this form."})}),(0,r.jsx)(g.z,{block:!0,size:"small",htmlType:"submit",loading:m,disabled:!o||m||n,children:"Create user"})]})})]})})};async function H(e){let{projectRef:s,email:t}=e,r=await (0,D.v_)("".concat(k.T5,"/auth/").concat(s,"/invite"),{email:t});if(r.error)throw r.error;return r}let Q=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,i.NL)(),a=(0,F.P)("userManagementV2");return(0,U.D)(e=>H(e),{async onSuccess(s,t,i){let{projectRef:n}=t;a?await r.invalidateQueries(f.o.usersInfinite(n)):await r.invalidateQueries(f.o.users(n)),await (null==e?void 0:e(s,t,i))},async onError(e,t,r){void 0===s?P.Am.error("Failed to invite user: ".concat(e.message)):s(e,t,r)},...t})};var q=t(83690),K=t(62277),J=e=>{let{visible:s,setVisible:t}=e,{ref:i}=(0,d.UO)(),{mutate:a,isLoading:n}=Q({onSuccess:(e,s)=>{P.Am.success("Sent invite email to ".concat(s.email)),t(!1)}}),l=(0,j.Xo)(c.KA.AUTH_EXECUTE,"invite_user"),o=async e=>{if(!i)return console.error("Project ref is required");a({projectRef:i,email:e.email})};return(0,r.jsx)("div",{children:(0,r.jsx)(q.Z,{closable:!0,hideFooter:!0,size:"small",visible:s,header:"Invite a new user",onCancel:()=>t(!s),children:(0,r.jsx)(K.Z,{validateOnBlur:!1,initialValues:{email:""},validate:e=>{let s={};return 0===e.email.length?s.email="Please enter a valid email":/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(e.email)||(s.email="".concat(e.email," is an invalid email")),s},onSubmit:o,children:()=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(q.Z.Content,{children:(0,r.jsx)(v.Z,{id:"email",className:"w-full",label:"User email",icon:(0,r.jsx)(w.Z,{}),type:"email",name:"email",placeholder:"User email"})}),(0,r.jsx)(q.Z.Content,{children:(0,r.jsx)(g.z,{block:!0,size:"small",htmlType:"submit",loading:n,disabled:!l||n,children:"Invite user"})})]})})},"invite-user-modal")})},G=e=>{let{projectKpsVersion:s}=e,t=!k.Qy||_().gte(_().coerce(null!=s?s:"kps-v2.5.4"),_().coerce("kps-v2.5.3")),i=(0,j.Xo)(c.KA.AUTH_EXECUTE,"invite_user"),n=(0,j.Xo)(c.KA.AUTH_EXECUTE,"create_user"),[l,o]=(0,a.useState)(!1),[d,u]=(0,a.useState)(!1);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(C.h_,{children:[(0,r.jsx)(C.$F,{asChild:!0,children:(0,r.jsx)(g.z,{type:"primary",iconRight:(0,r.jsx)(N.Z,{size:14,strokeWidth:1.5}),children:"Add user"})}),(0,r.jsxs)(C.AW,{side:"bottom",align:"end",className:"w-40",children:[t&&(0,r.jsxs)(S.u,{children:[(0,r.jsx)(S.aJ,{asChild:!0,children:(0,r.jsxs)(C.Xi,{className:"space-x-2 !pointer-events-auto",disabled:!i,onClick:()=>{i&&o(!0)},children:[(0,r.jsx)(w.Z,{size:14}),(0,r.jsx)("p",{children:"Send invitation"})]})}),!i&&(0,r.jsx)(S._v,{side:"left",children:"You need additional permissions to invite users"})]}),(0,r.jsxs)(S.u,{children:[(0,r.jsx)(S.aJ,{asChild:!0,children:(0,r.jsxs)(C.Xi,{className:"space-x-2 !pointer-events-auto",disabled:!n,onClick:()=>{n&&u(!0)},children:[(0,r.jsx)(b,{size:14}),(0,r.jsx)("p",{children:"Create new user"})]})}),!n&&(0,r.jsx)(S._v,{side:"left",children:"You need additional permissions to create users"})]})]})]}),t&&(0,r.jsx)(J,{visible:l,setVisible:o}),(0,r.jsx)(Y,{visible:d,setVisible:u})]})},$=t(52006),B=t(15735),ee=t(56006),es=t(28879),et=t.n(es),er=t(81076),ei=t(62614),ea=t(67767),en=t(24334),el=t(30181),eo=t(3536);async function ec(e){let{projectRef:s,userId:t}=e,r=await (0,D.$v)("".concat(k.T5,"/auth/").concat(s,"/users/").concat(t,"/factors"));if(r.error)throw r.error;return r}let ed=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,U.D)(e=>ec(e),{async onSuccess(s,t,r){await (null==e?void 0:e(s,t,r))},async onError(e,t,r){void 0===s?P.Am.error("Failed to delete the user's MFA factors: ".concat(e.message)):s(e,t,r)},...t})};async function eu(e){let{projectRef:s,user:t}=e,r=await (0,D.$v)("".concat(k.T5,"/auth/").concat(s,"/users"),t);if(r.error)throw r.error;return r}let em=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=(0,i.NL)(),a=(0,F.P)("userManagementV2");return(0,U.D)(e=>eu(e),{async onSuccess(s,t,i){let{projectRef:n}=t;a?await r.invalidateQueries(f.o.usersInfinite(n)):await r.invalidateQueries(f.o.users(n)),await (null==e?void 0:e(s,t,i))},async onError(e,t,r){void 0===s?P.Am.error("Failed to delete user: ".concat(e.message)):s(e,t,r)},...t})};async function ex(e){let{projectRef:s,user:t}=e,r=await (0,D.v_)("".concat(k.T5,"/auth/").concat(s,"/recover"),t);if(r.error)throw r.error;return r}let eh=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,U.D)(e=>ex(e),{async onSuccess(s,t,r){await (null==e?void 0:e(s,t,r))},async onError(e,t,r){void 0===s?P.Am.error("Failed to reset user password: ".concat(e.message)):s(e,t,r)},...t})};async function ef(e){let{projectRef:s,user:t}=e,r=await (0,D.v_)("".concat(k.T5,"/auth/").concat(s,"/magiclink"),t);if(r.error)throw r.error;return r}let ep=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,U.D)(e=>ef(e),{async onSuccess(s,t,r){await (null==e?void 0:e(s,t,r))},async onError(e,t,r){void 0===s?P.Am.error("Failed to send magic link: ".concat(e.message)):s(e,t,r)},...t})};async function ej(e){let{projectRef:s,user:t}=e,r=await (0,D.v_)("".concat(k.T5,"/auth/").concat(s,"/otp"),t);if(r.error)throw r.error;return r}let ev=function(){let{onSuccess:e,onError:s,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,U.D)(e=>ej(e),{async onSuccess(s,t,r){await (null==e?void 0:e(s,t,r))},async onError(e,t,r){void 0===s?P.Am.error("Failed to send magic link: ".concat(e.message)):s(e,t,r)},...t})};var eg=t(82955),ey=t(74138),eN=e=>{let{user:s,permissions:t,setSelectedUser:i,setUserSidePanelOpen:n}=e,{ref:l}=(0,d.UO)(),[o,c]=(0,a.useState)(!1),[u,m]=(0,a.useState)(!1),{canRemoveUser:x,canRemoveMFAFactors:h,canSendMagicLink:f,canSendRecovery:p,canSendOtp:j}=t,{mutate:v,isLoading:y}=eh({onSuccess:()=>{P.Am.success("Sent password recovery to ".concat(s.email))}}),{mutate:N,isLoading:b}=ep({onSuccess:()=>{P.Am.success("Sent magic link to ".concat(s.email))}}),{mutate:Z,isLoading:_}=ev({onSuccess:()=>{P.Am.success("Sent OTP to ".concat(s.phone))}}),{mutate:k,isLoading:A}=em({onSuccess:()=>{P.Am.success("Successfully deleted ".concat(s.email)),c(!1)}}),{mutate:z,isLoading:E}=ed({onSuccess:()=>{P.Am.success("Successfully deleted the user's factors"),m(!1)}}),T=async()=>{if(!l)return console.error("Project ref is required");v({projectRef:l,user:s})};async function U(){if(!l)return console.error("Project ref is required");N({projectRef:l,user:s})}async function F(){if(!l)return console.error("Project ref is required");Z({projectRef:l,user:s})}async function D(){if(await (0,eg.Vs)(200),!l)return console.error("Project ref is required");k({projectRef:l,user:s})}async function X(){return(await (0,eg.Vs)(200),l)?s.id?void z({projectRef:l,userId:s.id}):console.error("User id is required"):console.error("Project ref is required")}return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(C.h_,{children:[(0,r.jsx)(C.$F,{asChild:!0,children:(0,r.jsx)(g.z,{type:"text",loading:y||b||_||A||E,className:"px-1.5",icon:(0,r.jsx)(ea.Z,{})})}),(0,r.jsx)(C.AW,{children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(C.Xi,{className:"space-x-2",onClick:()=>{i(s),n(!0)},children:[(0,r.jsx)(en.Z,{size:14}),(0,r.jsx)("p",{children:"View user info"})]}),(0,r.jsx)(C.VD,{}),null!==s.email?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(S.u,{children:[(0,r.jsx)(S.aJ,{asChild:!0,children:(0,r.jsxs)(C.Xi,{className:"space-x-2 !pointer-events-auto",disabled:!p,onClick:()=>{p&&T()},children:[(0,r.jsx)(w.Z,{size:14}),(0,r.jsx)("p",{children:"Send password recovery"})]})}),!p&&(0,r.jsx)(S._v,{side:"left",children:"You need additional permissions to send password recovery."})]}),(0,r.jsxs)(S.u,{children:[(0,r.jsx)(S.aJ,{asChild:!0,children:(0,r.jsxs)(C.Xi,{disabled:!f,className:"space-x-2 !pointer-events-auto",onClick:()=>{f&&U()},children:[(0,r.jsx)(w.Z,{size:14}),(0,r.jsx)("p",{children:"Send magic link"})]})}),!f&&(0,r.jsx)(S._v,{side:"left",children:"You need additional permissions to send magic link"})]})]}):null,null!==s.phone?(0,r.jsxs)(S.u,{children:[(0,r.jsx)(S.aJ,{asChild:!0,children:(0,r.jsxs)(C.Xi,{disabled:!j,className:"space-x-2 !pointer-events-auto",onClick:()=>{j&&F()},children:[(0,r.jsx)(w.Z,{size:14}),(0,r.jsx)("p",{children:"Send OTP"})]})}),!j&&(0,r.jsx)(S._v,{side:"left",children:"You need additional permissions to send OTP"})]}):null,(0,r.jsx)(C.VD,{}),(0,r.jsxs)(S.u,{children:[(0,r.jsx)(S.aJ,{asChild:!0,children:(0,r.jsxs)(C.Xi,{onClick:()=>{h&&m(!0)},disabled:!h,className:"space-x-2 !pointer-events-auto",children:[(0,r.jsx)(el.Z,{size:14}),(0,r.jsx)("p",{children:"Remove MFA factors"})]})}),!h&&(0,r.jsx)(S._v,{side:"left",children:"You need additional permissions to remove a user's authentication factors"})]}),(0,r.jsxs)(S.u,{children:[(0,r.jsx)(S.aJ,{asChild:!0,children:(0,r.jsxs)(C.Xi,{disabled:!x,onClick:()=>{x&&c(!0)},className:"space-x-2 !pointer-events-auto",children:[(0,r.jsx)(eo.Z,{size:14}),(0,r.jsx)("p",{children:"Delete user"})]})}),!x&&(0,r.jsx)(S._v,{side:"left",children:"You need additional permissions to delete users"})]})]})})]}),(0,r.jsx)(ey.Z,{visible:o,title:"Confirm to delete",confirmLabel:"Delete",onCancel:()=>c(!1),onConfirm:()=>{D()},children:(0,r.jsxs)("p",{className:"text-sm text-foreground-light",children:["This is permanent! Are you sure you want to delete user ",s.email,"?"]})}),(0,r.jsx)(ey.Z,{visible:u,title:"Confirm to delete",confirmLabel:"Delete",onCancel:()=>m(!1),onConfirm:()=>{X()},children:(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"This is permanent! Are you sure you want to delete the user's MFA factors?"})})]})},ew=t(22965);let eb=e=>{var s;let{user:t,permissions:i,setSelectedUser:a,setUserSidePanelOpen:n}=e,l=t.email_confirmed_at||t.phone_confirmed_at,o=et()(t.created_at),c=et()(t.last_sign_in_at);return(0,r.jsxs)(B.Z.tr,{className:"relative",children:[(0,r.jsx)(B.Z.td,{className:"whitespace-nowrap max-w-xs truncate",title:(0,ew.Gf)(t),children:(0,r.jsx)("span",{className:"text-foreground",children:(0,ew.Gf)(t)})}),(0,r.jsx)(B.Z.td,{className:"whitespace-nowrap",children:(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsx)("span",{className:"text-sm text-foreground",children:t.email?t.email:"-"})})}),(0,r.jsx)(B.Z.td,{className:"whitespace-nowrap",children:(0,r.jsx)("span",{className:"text-foreground",children:t.phone?t.phone:"-"})}),(0,r.jsx)(B.Z.td,{className:"table-cell",children:(0,r.jsx)("span",{className:"capitalize text-foreground",children:t.is_anonymous?"Anonymous":null==t?void 0:null===(s=t.raw_app_meta_data)||void 0===s?void 0:s.provider})}),(0,r.jsx)(B.Z.td,{className:"table-cell",children:(0,r.jsx)("span",{className:"text-foreground",children:null==o?void 0:o.format("DD MMM, YYYY HH:mm")})}),(0,r.jsx)(B.Z.td,{className:"table-cell",children:(null==t?void 0:t.last_sign_in_at)?null==c?void 0:c.format("DD MMM, YYYY HH:mm"):l?"Never":(0,r.jsx)(er.C,{variant:"warning",children:"Waiting for verification.."})}),(0,r.jsx)(B.Z.td,{className:"table-cell",children:(0,r.jsxs)("div",{className:"flex max-w-[72px] items-baseline",children:[(0,r.jsx)(ei.Z,{className:"font-xs bash",children:t.id}),(0,r.jsx)("div",{children:"..."})]})}),(0,r.jsx)(B.Z.td,{className:"table-cell",children:(0,r.jsx)(eN,{user:t,permissions:i,setSelectedUser:a,setUserSidePanelOpen:n})})]},t.id)};var eZ=t(41679);let e_=()=>(0,r.jsxs)(B.Z.tr,{className:"relative",children:[(0,r.jsx)(B.Z.td,{className:"whitespace-nowrap",children:(0,r.jsx)(eZ.Z,{className:"h-[20px] py-0 w-8"})}),(0,r.jsx)(B.Z.td,{className:"whitespace-nowrap",children:(0,r.jsx)(eZ.Z,{className:"h-[20px] py-0 w-36"})}),(0,r.jsx)(B.Z.td,{className:"whitespace-nowrap",children:(0,r.jsx)(eZ.Z,{className:"h-[20px] py-0 w-8"})}),(0,r.jsx)(B.Z.td,{className:"table-cell",children:(0,r.jsx)(eZ.Z,{className:"h-[20px] py-0 w-10"})}),(0,r.jsx)(B.Z.td,{className:"table-cell",children:(0,r.jsx)(eZ.Z,{className:"h-[20px] py-0 w-32"})}),(0,r.jsx)(B.Z.td,{className:"table-cell",children:(0,r.jsx)(eZ.Z,{className:"h-[20px] py-0 w-8"})}),(0,r.jsx)(B.Z.td,{className:"table-cell",children:(0,r.jsx)(eZ.Z,{className:"h-[20px] py-0 w-20"})}),(0,r.jsx)(B.Z.td,{className:"table-cell",children:(0,r.jsx)(g.z,{type:"text",disabled:!0,className:"hover:border-muted flex",children:(0,r.jsx)(ea.Z,{})})})]}),ek=e=>{let{total:s,page:t,setPage:i,isFetchingNextPage:a}=e,n=p.RT*(t-1)+1,l=n>s?s:n,o=p.RT*t,c=o>s?s:o,d=c<s;return(0,r.jsxs)("nav",{className:"flex items-center justify-between overflow-hidden","aria-label":"Pagination",children:[(0,r.jsx)("div",{className:"hidden sm:block",children:(0,r.jsxs)("p",{className:"text-xs text-foreground-lighter",children:["Showing",(0,r.jsx)("span",{className:"px-1 font-medium text-foreground-light",children:l}),"to",(0,r.jsx)("span",{className:"px-1 font-medium text-foreground-light",children:c}),"of",(0,r.jsx)("span",{className:"px-1 font-medium text-foreground-light",children:s}),"results"]})}),(0,r.jsxs)("div",{className:"flex flex-1 justify-between sm:justify-end",children:[t>1&&!(a&&2===t)&&(0,r.jsx)(g.z,{type:"default",onClick:()=>i(t-1),disabled:a,children:"Previous"}),(d||a)&&(0,r.jsx)(g.z,{type:"default",className:"ml-3",onClick:()=>i(t+1),disabled:a,loading:a,children:"Next"})]})]})};var eC=t(49251),eS=e=>{let{selectedUser:s,userSidePanelOpen:t,setUserSidePanelOpen:i}=e;return(0,r.jsx)(eC.ZP,{size:"large",header:"View user info",visible:t,onCancel:()=>i(!1),cancelText:"Close",children:(0,r.jsx)(eC.ZP.Content,{className:"space-y-10 py-6",children:(0,r.jsx)(ei.Z,{className:"javascript",children:JSON.stringify(s,null,2)})})})};let eA=e=>{let{page:s,setPage:t,keywords:i,total:n,users:l,isLoading:o,isSuccess:d,isFetchingNextPage:u,error:m}=e,[x,h]=(0,a.useState)(void 0),[f,p]=(0,a.useState)(!1),v=(0,j.Xo)(c.KA.AUTH_EXECUTE,"send_magic_link"),g=(0,j.Xo)(c.KA.AUTH_EXECUTE,"send_recovery"),y=(0,j.Xo)(c.KA.AUTH_EXECUTE,"send_otp"),N=(0,j.Xo)(c.KA.TENANT_SQL_DELETE,"auth.users"),w=(0,j.Xo)(c.KA.TENANT_SQL_DELETE,"auth.mfa_factors");return(0,r.jsx)(B.Z,{head:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(B.Z.th,{children:"Display Name"}),(0,r.jsx)(B.Z.th,{children:"Email"}),(0,r.jsx)(B.Z.th,{children:"Phone"}),(0,r.jsx)(B.Z.th,{className:"table-cell",children:"Provider"}),(0,r.jsx)(B.Z.th,{className:"table-cell",children:"Created"}),(0,r.jsx)(B.Z.th,{className:"table-cell",children:"Last Sign In"}),(0,r.jsx)(B.Z.th,{className:"table-cell",children:"User UID"}),(0,r.jsx)(B.Z.th,{})]}),body:(0,r.jsxs)(r.Fragment,{children:[o&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e_,{}),(0,r.jsx)(e_,{}),(0,r.jsx)(e_,{}),(0,r.jsx)(e_,{})]}),m&&(0,r.jsx)(ee.Z,{error:m,subject:"Failed to retrieve users"}),d&&0===l.length&&(0,r.jsx)(B.Z.tr,{children:(0,r.jsx)(B.Z.td,{colSpan:8,className:"h-14 whitespace-nowrap border-t p-4 text-sm leading-5 text-gray-300",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3 opacity-75",children:[(0,r.jsx)($.Z,{size:16,strokeWidth:2}),(0,r.jsx)("p",{className:"text-foreground-light",children:i?'No users matched the search query "'.concat(i,'"'):"No users in your project"})]})})}),d&&l.length>0&&l.map(e=>(0,r.jsx)(eb,{user:e,permissions:{canRemoveUser:N,canRemoveMFAFactors:w,canSendMagicLink:v,canSendRecovery:g,canSendOtp:y},setSelectedUser:h,setUserSidePanelOpen:p},e.id)),(0,r.jsx)(B.Z.tr,{children:(0,r.jsx)(B.Z.td,{colSpan:8,children:(0,r.jsx)(ek,{total:n,page:s,setPage:t,isFetchingNextPage:u})})}),(0,r.jsx)(eS,{selectedUser:x,userSidePanelOpen:f,setUserSidePanelOpen:p})]})})},ez=()=>{var e,s;let t=(0,i.NL)(),{project:N}=(0,m.d2)(),{ref:w}=(0,d.UO)(),b=(0,u.cg)(),[Z,_]=(0,a.useState)(1),[k,C]=(0,a.useState)(""),[S,A]=(0,a.useState)(""),[z,E]=(0,a.useState)(),P=(0,j.Xo)(c.KA.TENANT_SQL_SELECT,"auth.users"),T=(0,j.N4)(),{data:U,isLoading:F,isSuccess:D,refetch:X,isRefetching:R,error:O,isPreviousData:L}=(0,p.xY)({projectRef:w,page:Z,keywords:S,filter:z,connectionString:null==N?void 0:N.connectionString},{keepPreviousData:!0,onSuccess(e){e.users.length<=0&&e.total>0&&(t.removeQueries(f.o.users(w,{page:Z,keywords:S,filter:z})),_(e=>e-1))}});return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"justify-between px-6 pt-6 pb-2 md:flex",children:[(0,r.jsxs)("div",{className:"relative flex space-x-4",children:[(0,r.jsx)(v.Z,{size:"small",value:k,onChange:e=>C(e.target.value),onKeyDown:e=>{13==e.keyCode&&A(k)},className:"min-w-[300px]",name:"email",id:"email",placeholder:"Search by email, phone number or UID",icon:(0,r.jsx)(n.Z,{size:14}),actions:[k&&(0,r.jsx)(g.z,{size:"tiny",type:"text",icon:(0,r.jsx)(l.Z,{}),onClick:()=>void(C(""),A(""),E(void 0))})]}),(0,r.jsxs)(y.Z,{size:"small",value:z,onChange:function(e){E(e)},name:"verified",id:"verified",className:"w-[200px]",children:[(0,r.jsx)(y.Z.Option,{label:"All Users",value:"",children:"All Users"}),(0,r.jsx)(y.Z.Option,{label:"Verified Users",value:"verified",children:"Verified Users"}),(0,r.jsx)(y.Z.Option,{label:"Un-Verified Users",value:"unverified",children:"Un-Verified Users"}),(0,r.jsx)(y.Z.Option,{label:"Anonymous Users",value:"anonymous",children:"Anonymous Users"})]})]}),(0,r.jsxs)("div",{className:"mt-4 flex items-center gap-2 md:mt-0",children:[b&&(0,r.jsx)(x.Z,{section:["user-management"]}),(0,r.jsx)(g.z,{size:"tiny",icon:(0,r.jsx)(o.Z,{}),type:"default",loading:R&&!L,onClick:()=>X(),children:"Reload"}),(0,r.jsx)(G,{projectKpsVersion:null==N?void 0:N.kpsVersion})]})]}),(0,r.jsx)("section",{className:"thin-scrollbars mt-4 overflow-visible px-6",children:(0,r.jsx)("div",{className:"section-block--body relative overflow-x-auto rounded",children:(0,r.jsx)("div",{className:"inline-block min-w-full align-middle",children:T&&!P?(0,r.jsx)("div",{className:"mt-8",children:(0,r.jsx)(h.Z,{isFullPage:!0,resourceText:"access your project's users"})}):(0,r.jsx)(eA,{page:Z,setPage:_,keywords:S,total:null!==(e=null==U?void 0:U.total)&&void 0!==e?e:0,users:null!==(s=null==U?void 0:U.users)&&void 0!==s?s:[],isLoading:F,isSuccess:D,isFetchingNextPage:L,error:O})})})})]})};var eE=t(94299),eP=t(68570),eT=t(47370),eU=t(70987),eF=t(59403),eD=t(31696);async function eX(e,s){let{projectRef:t,page:r=0,keywords:i="",filter:a}=e;if(!t)throw Error("Project ref is required");let n={limit:"20",offset:(20*r).toString(),keywords:i};a&&(n.verified=a);let{data:l,error:o}=await (0,eD.U2)("/platform/auth/{ref}/users",{params:{path:{ref:t},query:n},signal:s});return o&&(0,eD.S3)(o),l}let eR=function(e){let{projectRef:s,keywords:t,filter:r}=e,{enabled:i=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,eF.N)(f.o.usersInfinite(s,{keywords:t,filter:r}),e=>{let{signal:i,pageParam:a}=e;return eX({projectRef:s,keywords:t,filter:r,page:a},i)},{staleTime:0,enabled:i&&void 0!==s,getNextPageParam(e,s){let t=s.length;if(!(20*t>=e.total))return t},...a})};var eO=t(54383),eL=t(72683),eV=t(62949),eW=t(81384),eI=t(29059),eM=t(64568);let eY=[{id:"img",name:"",minWidth:65,width:65,resizable:!1},{id:"id",name:"UID",minWidth:void 0,width:280,resizable:!0},{id:"name",name:"Display name",minWidth:0,width:150,resizable:!1},{id:"email",name:"Email",minWidth:void 0,width:300,resizable:!0},{id:"provider",name:"Provider",minWidth:150,resizable:!0},{id:"provider_type",name:"Provider type",minWidth:150,resizable:!0},{id:"phone",name:"Phone",minWidth:void 0,resizable:!0},{id:"created_at",name:"Created at",minWidth:void 0,width:260,resizable:!0},{id:"last_sign_in_at",name:"Last sign in at",minWidth:void 0,width:260,resizable:!0}],eH=()=>{let{ref:e}=(0,d.UO)(),{project:s}=(0,m.d2)(),t=(0,a.useRef)(null),i=(0,u.cg)(),[h,f]=(0,a.useState)(""),[p,v]=(0,a.useState)("all"),[y,N]=(0,a.useState)(""),[b,Z]=(0,a.useState)(),[_,k]=(0,a.useState)(),[C,S]=(0,a.useState)(),[A,z]=(0,a.useState)(!1),[E,T]=(0,a.useState)(!1),[U,F]=(0,a.useState)(!1),D=(0,j.Xo)(c.KA.AUTH_EXECUTE,"send_magic_link"),X=(0,j.Xo)(c.KA.AUTH_EXECUTE,"send_recovery"),R=(0,j.Xo)(c.KA.AUTH_EXECUTE,"send_otp"),O=(0,j.Xo)(c.KA.TENANT_SQL_DELETE,"auth.users"),L=(0,j.Xo)(c.KA.TENANT_SQL_DELETE,"auth.mfa_factors"),{data:V,error:W,isLoading:I,isRefetching:M,isError:Y,isFetchingNextPage:H,refetch:Q,fetchNextPage:q}=eR({projectRef:e,keywords:y,filter:"all"===p?void 0:p},{keepPreviousData:!!y}),K=(0,a.useMemo)(()=>null==V?void 0:V.pages[0].total,[null==V?void 0:V.pages[0].total]),J=(0,a.useMemo)(()=>null==V?void 0:V.pages.flatMap(e=>e.users),[null==V?void 0:V.pages]),{mutate:$}=eh({onSuccess:(e,s)=>{P.Am.success("Sent password recovery to ".concat(s.user.email),{id:_})},onError:e=>{P.Am.error("Failed to send password recovery: ".concat(e.message),{id:_})}}),{mutate:B}=ep({onSuccess:(e,s)=>{P.Am.success("Sent magic link to ".concat(s.user.email))},onError:e=>{P.Am.error("Failed to send magic link: ".concat(e.message),{id:_})}}),{mutate:es}=ev({onSuccess:(e,s)=>{P.Am.success("Sent OTP to ".concat(s.user.phone))},onError:e=>{P.Am.error("Failed to send OTP: ".concat(e.message),{id:_})}}),{mutate:er}=em({onSuccess:()=>{P.Am.success("Successfully deleted ".concat(null==C?void 0:C.email)),T(!1)}}),{mutate:ei}=ed({onSuccess:()=>{P.Am.success("Successfully deleted the user's factors"),F(!1)}}),ea=eY.map(e=>{var s;return{key:e.id,name:e.name,resizable:e.resizable,sortable:!1,width:e.width,minWidth:null!==(s=e.minWidth)&&void 0!==s?s:120,renderHeaderCell:()=>{if("img"!==e.id)return(0,r.jsx)("div",{className:"flex items-center justify-between font-normal text-xs w-full",children:(0,r.jsx)("div",{className:"flex items-center gap-x-2",children:(0,r.jsx)("p",{className:"!text-foreground",children:e.name})})})},renderCell:s=>{let{row:t}=s,i=null==t?void 0:t[e.id],a=null==J?void 0:J.find(e=>e.id===t.id),n=null!==i&&["created_at","last_sign_in_at"].includes(e.id)?et()(i).format("ddd DD MMM YYYY HH:mm:ss [GMT]ZZ"):i,l=(null==a?void 0:a.email_confirmed_at)||(null==a?void 0:a.phone_confirmed_at);return"img"===e.id?(0,r.jsx)("div",{className:"flex items-center justify-center",children:(0,r.jsx)("div",{className:(0,eO.cn)("flex items-center justify-center w-6 h-6 rounded-full bg-center bg-cover bg-no-repeat",t.img?"border":"bg-selection"),style:{backgroundImage:t.img?"url('".concat(t.img,"')"):"none"},children:!t.img&&(0,r.jsx)(en.Z,{size:12})})}):(0,r.jsxs)(eL.xV,{modal:!1,children:[(0,r.jsx)(eL.W4,{asChild:!0,children:(0,r.jsxs)("div",{className:(0,eO.cn)("w-full flex items-center text-xs gap-x-2",e.id.includes("provider")?"capitalize":""),children:["provider"===e.id&&t.provider_icon&&(0,r.jsx)("img",{width:16,src:t.provider_icon,alt:"".concat(t.provider," auth icon")}),"last_sign_in_at"!==e.id||l?(0,r.jsx)("p",{children:null===n?"-":n}):(0,r.jsx)("p",{className:"text-foreground-lighter",children:"Waiting for verification"})]})}),(0,r.jsxs)(eL.h_,{onCloseAutoFocus:e=>e.stopPropagation(),children:[(0,r.jsxs)(eL.Zo,{className:"gap-x-2",onSelect:()=>{let e=(0,eM.Lw)(i);(0,eg.vQ)(e)},onFocusCapture:e=>e.stopPropagation(),children:[(0,r.jsx)(eE.Z,{size:14}),"Copy ","id"===e.id?e.name:e.name.toLowerCase()]}),(0,r.jsxs)(eL.Zo,{className:"gap-x-2",onSelect:()=>{S(a),z(!0)},onFocusCapture:e=>e.stopPropagation(),children:[(0,r.jsx)(en.Z,{size:14}),"View user info"]}),null!==t.email&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eL.uP,{}),(0,r.jsxs)(eL.Zo,{className:"gap-x-2",disabled:!X,onSelect:()=>{a&&eu(a)},onFocusCapture:e=>e.stopPropagation(),children:[(0,r.jsx)(w.Z,{size:14}),"Send password recovery"]}),(0,r.jsxs)(eL.Zo,{className:"gap-x-2",disabled:!D,onSelect:()=>{a&&ex(a)},onFocusCapture:e=>e.stopPropagation(),children:[(0,r.jsx)(w.Z,{size:14}),"Send magic link"]})]}),null!==t.phone&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eL.uP,{}),(0,r.jsxs)(eL.Zo,{className:"gap-x-2",disabled:!R,onSelect:()=>{a&&ef(a)},onFocusCapture:e=>e.stopPropagation(),children:[(0,r.jsx)(w.Z,{size:14}),"Send OTP"]})]}),(0,r.jsx)(eL.uP,{}),(0,r.jsxs)(eL.Zo,{className:"gap-x-2",disabled:!L,onSelect:()=>{S(a),F(!0)},onFocusCapture:e=>e.stopPropagation(),children:[(0,r.jsx)(el.Z,{size:14}),"Remove MFA factors"]}),(0,r.jsxs)(eL.Zo,{className:"gap-x-2",disabled:!O,onSelect:()=>{S(a),T(!0)},onFocusCapture:e=>e.stopPropagation(),children:[(0,r.jsx)(eo.Z,{size:14}),"Delete user"]})]})]})}}}),ec=()=>{f(""),N("")},eu=async s=>{if(!e)return console.error("Project ref is required");k(P.Am.loading("Sending password recovery to ".concat(s.email))),$({projectRef:e,user:s})};async function ex(s){if(!e)return console.error("Project ref is required");B({projectRef:e,user:s})}async function ef(s){if(!e)return console.error("Project ref is required");es({projectRef:e,user:s})}async function ej(){return(await (0,eg.Vs)(200),e)?C?void er({projectRef:e,user:C}):console.error("No user is selected"):console.error("Project ref is required")}async function eN(){return(await (0,eg.Vs)(200),e)?C?void ei({projectRef:e,userId:C.id}):console.error("No user is selected"):console.error("Project ref is required")}return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"h-full flex flex-col",children:[(0,r.jsx)(eU.p,{className:"py-4 px-6 !mb-0",title:"Users"}),(0,r.jsxs)("div",{className:"bg-surface-200 py-3 px-6 flex items-center justify-between border-t",children:[(0,r.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,r.jsx)(eI.I,{size:"tiny",className:"w-64",icon:(0,r.jsx)(n.Z,{size:14,className:"text-foreground-lighter"}),placeholder:"Search by email, phone number or UID",value:h,onChange:e=>f(e.target.value),onKeyDown:e=>{"Enter"===e.code&&h.length>0&&N(h)},actions:[h&&(0,r.jsx)(g.z,{size:"tiny",type:"text",icon:(0,r.jsx)(l.Z,{}),onClick:()=>ec()})]}),(0,r.jsxs)(eV.Ph,{value:p,onValueChange:e=>v(e),children:[(0,r.jsx)(eV.i4,{size:"tiny",className:"w-[150px]",children:(0,r.jsx)(eV.ki,{})}),(0,r.jsx)(eV.Bw,{children:(0,r.jsxs)(eV.DI,{children:[(0,r.jsx)(eV.Ql,{value:"all",children:"All users"}),(0,r.jsx)(eV.Ql,{value:"verified",children:"Verified users"}),(0,r.jsx)(eV.Ql,{value:"unverified",children:"Unverified users"}),(0,r.jsx)(eV.Ql,{value:"anonymous",children:"Anonymous users"})]})})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[i&&(0,r.jsx)(x.Z,{section:["user-management"]}),(0,r.jsx)(g.z,{size:"tiny",icon:(0,r.jsx)(o.Z,{}),type:"default",loading:M&&!H,onClick:()=>Q(),children:"Refresh"}),(0,r.jsx)(G,{projectKpsVersion:null==s?void 0:s.kpsVersion})]})]}),(0,r.jsx)("div",{className:"flex flex-col w-full h-full",children:(0,r.jsx)(eT.ZP,{ref:t,className:"flex-grow",rowHeight:44,headerRowHeight:36,columns:ea,rows:(0,ew.Bi)(null!=J?J:[]),rowClass:(e,s)=>["".concat(s===b?"bg-surface-300 dark:bg-surface-300":"bg-200"," cursor-pointer"),"[&>.rdg-cell]:border-box [&>.rdg-cell]:outline-none [&>.rdg-cell]:shadow-none","[&>.rdg-cell:first-child>div]:ml-4"].join(" "),onScroll:e=>{!I&&(0,ew.KG)(e)&&q()},renderers:{renderRow:(e,s)=>(0,a.createElement)(eT.X2,{...s,key:s.row.id,onClick:()=>{if("number"==typeof e&&e>=0){var s;Z(e),null===(s=t.current)||void 0===s||s.scrollToCell({idx:0,rowIdx:e})}}}),noRowsFallback:I?(0,r.jsx)("div",{className:"absolute top-14 px-6 w-full",children:(0,r.jsx)(eW.A,{})}):Y?(0,r.jsx)("div",{className:"absolute top-14 px-6 flex flex-col items-center justify-center w-full",children:(0,r.jsx)(ee.Z,{subject:"Failed to retrieve users",error:W})}):(0,r.jsxs)("div",{className:"absolute top-20 px-6 flex flex-col items-center justify-center w-full gap-y-2",children:[(0,r.jsx)(eP.Z,{className:"text-foreground-lighter",strokeWidth:1}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-foreground",children:"all"!==p||y.length>0?"No users found":"No users in your project"}),(0,r.jsx)("p",{className:"text-foreground-light",children:"all"!==p||y.length>0?"There are currently no users based on the filters applied":"There are currently no users who signed up to your project"})]})]})}})}),(0,r.jsxs)("div",{className:"flex min-h-9 h-9 overflow-hidden items-center px-6 w-full border-t text-xs text-foreground-light",children:["Total: ",K," users"]})]}),(0,r.jsx)(eS,{selectedUser:C,userSidePanelOpen:A,setUserSidePanelOpen:()=>{S(void 0),z(!1)}}),(0,r.jsx)(ey.Z,{visible:E,title:"Confirm to delete",confirmLabel:"Delete",onCancel:()=>T(!1),onConfirm:()=>{ej()},children:(0,r.jsxs)("p",{className:"text-sm text-foreground-light",children:["This is permanent! Are you sure you want to delete user ",null==C?void 0:C.email,"?"]})}),(0,r.jsx)(ey.Z,{visible:U,title:"Confirm to delete",confirmLabel:"Delete",onCancel:()=>F(!1),onConfirm:()=>{eN()},children:(0,r.jsx)("p",{className:"text-sm text-foreground-light",children:"This is permanent! Are you sure you want to delete the user's MFA factors?"})})]})};var eQ=t(41297);let eq=()=>(0,F.P)("userManagementV2")?(0,r.jsx)(eH,{}):(0,r.jsx)(ez,{});eq.getLayout=e=>(0,r.jsx)(eQ.Z,{title:"Auth",children:e});var eK=eq},30181:function(e,s,t){"use strict";t.d(s,{Z:function(){return r}});/**
 * @license lucide-react v0.436.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,t(46145).Z)("ShieldOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]])},29059:function(e,s,t){"use strict";t.d(s,{I:function(){return u}});var r=t(52322),i=t(94299),a=t(2784),n=t(54383),l=t(42070),o=t(32079),c=t(46318);function d(e){let{icon:s,className:t}=e;return(0,r.jsx)("div",{className:(0,n.cn)("absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-foreground-light",t),children:s})}let u=(0,a.forwardRef)((e,s)=>{let{copy:t,icon:u,reveal:m=!1,actions:x,onCopy:h,iconContainerClassName:f,containerClassName:p,...j}=e,[v,g]=(0,a.useState)("Copy"),[y,N]=(0,a.useState)(!0),w=(0,c.Z)("input"),b=[];return u&&b.push(w.with_icon),(0,r.jsxs)("div",{className:(0,n.cn)("relative",p),children:[(0,r.jsx)(l.I,{ref:s,...j,onCopy:h,value:m&&y?"**** **** **** ****":j.value,className:(0,n.cn)(...b,j.className)}),u&&(0,r.jsx)(d,{icon:u,className:f}),t||x?(0,r.jsxs)("div",{className:w.actions_container,children:[t&&!(m&&y)?(0,r.jsx)(o.z,{size:"tiny",type:"default",icon:(0,r.jsx)(i.Z,{size:16,className:"text-foreground-muted"}),onClick:()=>{var e,s;return e=j.value,void(null===(s=navigator.clipboard.writeText(e))||void 0===s||s.then(function(){g("Copied"),setTimeout(function(){g("Copy")},3e3),null==h||h()},function(){g("Failed to copy")}))},children:v}):null,m&&y?(0,r.jsx)(o.z,{size:"tiny",type:"default",onClick:function(){N(!1)},children:"Reveal"}):null,x&&x]}):null]})})},72683:function(e,s,t){"use strict";t.d(s,{W4:function(){return u},Zo:function(){return x},h_:function(){return m},uP:function(){return h},xV:function(){return d}});var r=t(52322),i=t(2784),a=t(7601),n=t(91179),l=t(76141),o=t(7968),c=t(54383);let d=a.fC,u=a.xz;a.ZA,a.Uv,a.Tr,a.Ee,i.forwardRef((e,s)=>{let{className:t,inset:i,children:l,...o}=e;return(0,r.jsxs)(a.fF,{ref:s,className:(0,c.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-xs outline-none focus:bg-selection focus:text-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",i&&"pl-8",t),...o,children:[l,(0,r.jsx)(n.Z,{className:"ml-auto h-4 w-4"})]})}).displayName=a.fF.displayName,i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,r.jsx)(a.tu,{ref:s,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-overlay p-1 text-foreground-light shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...i})}).displayName=a.tu.displayName;let m=i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,r.jsx)(a.Uv,{children:(0,r.jsx)(a.VY,{ref:s,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-overlay p-1 text-foreground-light shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...i})})});m.displayName=a.VY.displayName;let x=i.forwardRef((e,s)=>{let{className:t,inset:i,...n}=e;return(0,r.jsx)(a.ck,{ref:s,className:(0,c.cn)("relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-xs outline-none focus:bg-selection focus:text-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",i&&"pl-8",t),...n})});x.displayName=a.ck.displayName,i.forwardRef((e,s)=>{let{className:t,children:i,checked:n,...o}=e;return(0,r.jsxs)(a.oC,{ref:s,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-xs outline-none focus:bg-selection focus:text-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...o,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(a.wU,{children:(0,r.jsx)(l.Z,{className:"h-4 w-4"})})}),i]})}).displayName=a.oC.displayName,i.forwardRef((e,s)=>{let{className:t,children:i,...n}=e;return(0,r.jsxs)(a.Rk,{ref:s,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-xs outline-none focus:bg-selection focus:text-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(a.wU,{children:(0,r.jsx)(o.Z,{className:"h-2 w-2 fill-current"})})}),i]})}).displayName=a.Rk.displayName,i.forwardRef((e,s)=>{let{className:t,inset:i,...n}=e;return(0,r.jsx)(a.__,{ref:s,className:(0,c.cn)("px-2 py-1.5 text-xs text-foreground-light",i&&"pl-8",t),...n})}).displayName=a.__.displayName;let h=i.forwardRef((e,s)=>{let{className:t,...i}=e;return(0,r.jsx)(a.Z0,{ref:s,className:(0,c.cn)("-mx-1 my-1 h-px bg-border",t),...i})});h.displayName=a.Z0.displayName},62949:function(e,s,t){"use strict";t.d(s,{Bw:function(){return g},DI:function(){return x},Ph:function(){return m},Ql:function(){return N},U$:function(){return w},i4:function(){return p},ki:function(){return h},n5:function(){return y}});var r=t(52322),i=t(38947),a=t(78232),n=t(20670),l=t(76141),o=t(2784),c=t(54383),d=t(10929),u=t(75109);let m=i.fC,x=i.ZA,h=i.B4,f=(0,d.j)("",{variants:{size:{...u.Ld}},defaultVariants:{size:u.Rc}}),p=o.forwardRef((e,s)=>{let{className:t,children:n,size:l,...o}=e;return(0,r.jsxs)(i.xz,{ref:s,className:(0,c.cn)("flex w-full items-center justify-between rounded-md border border-strong hover:border-stronger bg-alternative dark:bg-muted hover:bg-selection text-xs ring-offset-background-control placeholder:text-foreground-muted focus:outline-none ring-border-control focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all duration-200","data-[state=open]:bg-selection data-[state=open]:border-stronger",f({size:l}),t),...o,children:[n,(0,r.jsx)(i.JO,{asChild:!0,children:(0,r.jsx)(a.Z,{className:"h-4 w-4 text-foreground-muted"})})]})});p.displayName=i.xz.displayName;let j=o.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(i.u_,{ref:s,className:(0,c.cn)("flex cursor-default items-center justify-center py-1 text-foreground-muted",t),...a,children:(0,r.jsx)(n.Z,{className:"h-4 w-4"})})});j.displayName=i.u_.displayName;let v=o.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,r.jsx)(i.$G,{ref:s,className:(0,c.cn)("flex cursor-default items-center justify-center py-1 text-foreground-muted",t),...n,children:(0,r.jsx)(a.Z,{className:"h-4 w-4"})})});v.displayName=i.$G.displayName;let g=o.forwardRef((e,s)=>{let{className:t,children:a,position:n="popper",...l}=e;return(0,r.jsx)(i.h_,{children:(0,r.jsxs)(i.VY,{ref:s,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-overlay text-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...l,children:[(0,r.jsx)(j,{}),(0,r.jsx)(i.l_,{className:(0,c.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,r.jsx)(v,{})]})})});g.displayName=i.VY.displayName;let y=o.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(i.__,{ref:s,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-xs text-foreground-lighter/75 uppercase tracking-wider font-mono",t),...a})});y.displayName=i.__.displayName;let N=o.forwardRef((e,s)=>{let{className:t,children:a,...n}=e;return(0,r.jsxs)(i.ck,{ref:s,className:(0,c.cn)("group","relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-overlay-hover text-foreground-light focus:text-foreground data-[state=checked]:text-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(i.wU,{className:"h-3.5 w-3.5 bg-foreground rounded-full flex justify-center items-center",children:(0,r.jsx)(l.Z,{className:"h-2 w-2 text-background-overlay",strokeWidth:6})})}),(0,r.jsx)(i.eT,{children:a})]})});N.displayName=i.ck.displayName;let w=o.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(i.Z0,{ref:s,className:(0,c.cn)("-mx-1 my-1 h-px bg-border-overlay",t),...a})});w.displayName=i.Z0.displayName}},function(e){e.O(0,[8421,8183,6334,5746,1357,2474,5590,6128,6875,7280,2569,5700,7370,6012,8507,9428,5029,4689,7851,2888,9774,179],function(){return e(e.s=27559)}),_N_E=e.O()}]);