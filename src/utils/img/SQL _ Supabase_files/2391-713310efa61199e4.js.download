"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2391],{3610:function(e,r,t){t.d(r,{l:function(){return E}});var s=t(52322),i=t(3440),n=t.n(i),o=t(89404),a=t(39097),l=t.n(a),c=t(56006),d=t(89777),u=t(64725),g=t(61660),h=t(9915),f=t(36492),p=t(31696),v=t(17436);async function j(e){let{data:r,error:t}=await (0,p.U2)("/platform/stripe/invoices/overdue",{signal:e});return t&&(0,p.S3)(t),r}let m=function(){let{enabled:e=!0,...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,f.a)(v.Y.overdueInvoices(),e=>{let{signal:r}=e;return j(r)},{enabled:e,...r})};var x=t(31310),y=t(96551),N=t(26198),w=t(43683),_=t(40654),b=t(99248),L=t(82955),C=t(54383),z=t(32079),S=t(40412),Z=t(60008),E=e=>{let{search:r,rewriteHref:t,filterStatus:i,resetFilterStatus:o}=e,{data:a,isLoading:l,isSuccess:c}=(0,x.tl)(),{data:u,isLoading:g,isSuccess:h,isError:f,error:p}=(0,N.Sy)(),{isLoading:v,isError:j,error:_}=(0,y.j)(),{data:L}=(0,w.q)(),{data:S}=m({enabled:b.Qy}),E=n()(u,"organization_id"),P=!!b.Qy&&v,k=void 0!==i&&2!==i.length,T=r.length>0&&h&&0===u.filter(e=>e.name.toLowerCase().includes(r.toLowerCase())||e.ref.includes(r.toLowerCase())).length,F=k&&h&&0===u.filter(e=>i.includes(e.status)).length;return l?(0,s.jsxs)("ul",{className:"mx-auto grid grid-cols-1 gap-4 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3",children:[(0,s.jsx)(Z.Z,{}),(0,s.jsx)(Z.Z,{})]}):T?(0,s.jsx)(d.Z,{searchString:r}):F?(0,s.jsxs)("div",{className:(0,C.cn)("bg-surface-100 border border-default px-6 py-4 rounded flex items-center justify-between"),children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-sm text-foreground",children:0===i.length?"No projects found":"No ".concat("INACTIVE"===i[0]?"paused":"active"," projects found")}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Your search for projects with the specified status did not return any results"})]}),void 0!==o&&(0,s.jsx)(z.z,{type:"default",onClick:()=>o(),children:"Reset filter"})]}):c&&a&&(null==a?void 0:a.length)>0?(0,s.jsx)(s.Fragment,{children:null==a?void 0:a.map(e=>(0,s.jsx)(I,{organization:e,projects:E[e.id],overdueInvoices:(null!=S?S:[]).filter(r=>r.organization_id===e.id),resourceWarnings:null!=L?L:[],rewriteHref:t,isLoadingPermissions:P,isErrorPermissions:j,permissionsError:_,isLoadingProjects:g,isErrorProjects:f,projectsError:p,search:r,filterStatus:i},e.slug))}):(0,s.jsx)(A,{slug:""})};let I=e=>{let{organization:r,projects:t,overdueInvoices:i,resourceWarnings:n,isLoadingPermissions:o,isErrorPermissions:a,permissionsError:d,isLoadingProjects:f,isErrorProjects:p,projectsError:v,rewriteHref:j,search:m,filterStatus:x}=e,y=!t||0===t.length,N=[...t||[]].sort((e,r)=>e.name.localeCompare(r.name)),w=m.length>0?N.filter(e=>e.name.toLowerCase().includes(m.toLowerCase())||e.ref.includes(m.toLowerCase())):N,_=void 0!==x?2===x.length?w:w.filter(e=>x.includes(e.status)):w,{data:b}=(0,h.T)({orgSlug:null==r?void 0:r.slug}),{data:C}=(0,g.q)({organizationId:null==r?void 0:r.id}),E=null==C?void 0:C.map(e=>{var r,t,s,i,n;return{id:String(e.id),added_by:{id:String(null===(r=e.user)||void 0===r?void 0:r.id),primary_email:null!==(i=null===(t=e.user)||void 0===t?void 0:t.primary_email)&&void 0!==i?i:"",username:null!==(n=null===(s=e.user)||void 0===s?void 0:s.username)&&void 0!==n?n:""},foreign_project_id:String(e.repository.id),supabase_project_ref:e.project.ref,organization_integration_id:"unused",inserted_at:e.inserted_at,updated_at:e.updated_at,metadata:{name:e.repository.name}}}),I=null==b?void 0:b.filter(e=>"Vercel"===e.integration.name).flatMap(e=>e.connections);return(m.length>0||void 0!==x&&2!==x.length)&&0===_.length?null:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex space-x-4 items-center",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("h4",{className:"text-lg flex items-center",children:r.name})," ",(0,s.jsx)(u.Z,{organization:r})]}),!!i.length&&(0,s.jsx)("div",{children:(0,s.jsx)(z.z,{asChild:!0,type:"danger",children:(0,s.jsx)(l(),{href:"/org/".concat(r.slug,"/invoices"),children:"Outstanding Invoices"})})}),(null==r?void 0:r.restriction_status)==="grace_period"&&(0,s.jsx)("div",{children:(0,s.jsx)(z.z,{asChild:!0,type:"warning",children:(0,s.jsx)(l(),{href:"/org/".concat(r.slug,"/billing"),children:"Grace Period"})})}),(null==r?void 0:r.restriction_status)==="grace_period_over"&&(0,s.jsx)("div",{children:(0,s.jsx)(z.z,{asChild:!0,type:"warning",children:(0,s.jsx)(l(),{href:"/org/".concat(r.slug,"/billing"),children:"Grace Period Over"})})}),(null==r?void 0:r.restriction_status)==="restricted"&&(0,s.jsx)("div",{children:(0,s.jsx)(z.z,{asChild:!0,type:"danger",children:(0,s.jsx)(l(),{href:"/org/".concat(r.slug,"/billing"),children:"Services Restricted"})})})]}),o||f?(0,s.jsxs)("ul",{className:"mx-auto grid grid-cols-1 gap-4 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3",children:[(0,s.jsx)(Z.Z,{}),(0,s.jsx)(Z.Z,{})]}):(0,s.jsx)("ul",{className:"mx-auto grid grid-cols-1 gap-4 sm:grid-cols-1 md:grid-cols-1 lg:grid-cols-2 xl:grid-cols-3",children:a?(0,s.jsx)("div",{className:"col-span-3",children:(0,s.jsx)(c.Z,{subject:"Failed to retrieve permissions for your account",error:d})}):p?(0,s.jsx)("div",{className:"col-span-3",children:(0,s.jsx)(c.Z,{subject:"Failed to retrieve projects under ".concat(name),error:v})}):y?(0,s.jsx)(A,{slug:r.slug}):null==_?void 0:_.map(e=>(0,s.jsx)(S.Z,{project:e,rewriteHref:j?j(e.ref):void 0,resourceWarnings:n.find(r=>r.project===e.ref),githubIntegration:null==E?void 0:E.find(r=>r.supabase_project_ref===e.ref),vercelIntegration:null==I?void 0:I.find(r=>r.supabase_project_ref===e.ref)},(0,L.pZ)(5)))})]},r.slug)},A=e=>{let{slug:r}=e,t=(0,_.N)("projects:create");return(0,s.jsxs)("div",{className:"col-span-4 space-y-4 rounded-lg border border-dashed p-6 text-center",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{children:"No projects"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Get started by creating a new project."})]}),t&&(0,s.jsx)(z.z,{asChild:!0,icon:(0,s.jsx)(o.Z,{}),children:(0,s.jsx)(l(),{href:"/new/".concat(r),children:"New Project"})})]})}},89777:function(e,r,t){var s=t(52322),i=t(54383),n=t(32079);r.Z=e=>{let{searchString:r,onResetFilter:t,className:o}=e;return(0,s.jsxs)("div",{className:(0,i.cn)("bg-surface-100 border border-default px-6 py-4 rounded flex items-center justify-between",o),children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-sm text-foreground",children:"No results found"}),(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:['Your search for "',r,'" did not return any results']})]}),void 0!==t&&(0,s.jsx)(n.z,{type:"default",onClick:()=>t(),children:"Reset filter"})]})}},17436:function(e,r,t){t.d(r,{Y:function(){return s}});let s={overdueInvoices:()=>["invoices","overdue"],invoice:e=>["invoice",e],list:(e,r)=>["invoices",e,r],count:e=>["invoices",e,"count"],projectInvoices:(e,r)=>["invoices",e,r],projectInvoicesCount:e=>["invoices",e,"count"],orgUpcomingPreview:e=>["invoices",e,"upcoming-preview"]}},70295:function(e,r,t){t.d(r,{S:function(){return o},V:function(){return a}});var s=t(36492),i=t(97295),n=t(71392);async function o(){let{error:e,data:r}=await i.I8.mfa.getAuthenticatorAssuranceLevel();if(e)throw e;return r}let a=function(){let{enabled:e=!0,...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.a)(n.c.aaLevel(),()=>o(),{staleTime:18e5,...r})}},99445:function(e,r,t){t.d(r,{Z:function(){return s}});let s={usage:e=>["projects",e,"usage"],orgUsage:(e,r,t,s)=>["organizations",e,"usage",r,t,s],resourceWarnings:()=>["projects","resource-warnings"]}},43683:function(e,r,t){t.d(r,{q:function(){return l}});var s=t(36492),i=t(99959),n=t(31696),o=t(99445);async function a(e){let{data:r,error:t}=await (0,n.U2)("/platform/projects-resource-warnings",{signal:e});return t&&(0,n.S3)(t),r}let l=function(){let{enabled:e=!0,...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.a)(o.Z.resourceWarnings(),e=>{let{signal:r}=e;return a(r)},{enabled:i.Qy&&e,staleTime:18e5,...r})}},3373:function(e,r,t){t.d(r,{Q:function(){return u}});var s=t(52322),i=t(5632),n=t(2784),o=t(56958),a=t(96551),l=t(70295),c=t(33750),d=t(99248);function u(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{useHighestAAL:!0};if(!d.Qy)return e;let t=t=>{let d=(0,i.useRouter)(),{isLoading:u,session:g}=(0,c.aC)(),{isLoading:h,data:f}=(0,l.V)({onError(e){o.Am.error("Failed to fetch authenticator assurance level: ".concat(e.message,". Try refreshing your browser, or reach out to us via a support ticket if the issue persists"))}});(0,a.j)({onError(e){o.Am.error("Failed to fetch permissions: ".concat(e.message,". Try refreshing your browser, or reach out to us via a support ticket if the issue persists"))}});let p=!!g,v=!u&&!h;return(0,n.useEffect)(()=>{let e=!r.useHighestAAL||(null==f?void 0:f.currentLevel)===(null==f?void 0:f.nextLevel);if(v&&(!p||!e)){let e=new URLSearchParams(location.search),r=location.pathname;r=r.replace("/dashboard",""),e.set("returnTo",r),d.push("/sign-in?".concat(e.toString()))}},[g,u,d,f,v,p]),(0,s.jsx)(e,{...t})};return t.displayName="withAuth(".concat(e.displayName,")"),"getLayout"in e&&"function"==typeof e.getLayout&&(t.getLayout=e.getLayout),t}}}]);